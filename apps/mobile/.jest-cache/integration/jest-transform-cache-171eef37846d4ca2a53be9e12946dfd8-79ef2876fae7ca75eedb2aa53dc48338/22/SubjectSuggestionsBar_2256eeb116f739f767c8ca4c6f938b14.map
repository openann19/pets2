{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_vectorIcons","Haptics","_AutoCropEngine","_unifiedTheme","_micro","_jsxRuntime","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","SubjectSuggestionsBar","exports","_ref","uri","_ref$ratios","ratios","onFocus","onApply","_useState","useState","_useState2","_slicedToArray2","loading","setLoading","_useState3","_useState4","sugs","setSugs","useEffect","mounted","_asyncToGenerator2","base","AutoCropEngine","suggestCrops","eyeWeight","padPct","thumbs","makeThumbnails","size","quality","_unused","jsxs","View","style","styles","wrap","children","jsx","ActivityIndicator","color","Theme","colors","primary","Text","meta","length","ScrollView","horizontal","showsHorizontalScrollIndicator","contentContainerStyle","row","map","s","card","BouncePressable","onPress","selectionAsync","focus","thumbBtn","accessibilityLabel","ratio","thumbUri","Image","source","thumbImg","resizeMode","justifyContent","alignItems","Ionicons","name","badge","badgeTxt","impactAsync","ImpactFeedbackStyle","Medium","crop","useBtn","useTxt","method","StyleSheet","create","paddingVertical","paddingHorizontal","gap","width","borderRadius","overflow","borderWidth","borderColor","height","backgroundColor","position","top","right","fontSize","fontWeight","marginTop","flexDirection","textAlign"],"sources":["SubjectSuggestionsBar.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { View, Text, StyleSheet, ScrollView, TouchableOpacity, ActivityIndicator, Image } from \"react-native\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport * as Haptics from \"expo-haptics\";\nimport { AutoCropEngine, type SuggestionType } from \"../../utils/AutoCropEngine\";\nimport { Theme } from \"../../theme/unified-theme\";\nimport { BouncePressable } from \"../micro\";\n\ntype Rect = { x: number; y: number; width: number; height: number };\n\ninterface Props {\n  uri: string;\n  ratios?: string[];                     // [\"1:1\",\"4:5\",\"9:16\",...]\n  onFocus?: (focus: Rect) => void;       // use cropper.focusTo(focus)\n  onApply?: (crop: Rect) => void;        // apply immediately\n}\n\nexport const SubjectSuggestionsBar: React.FC<Props> = ({ uri, ratios = [\"1:1\",\"4:5\",\"9:16\"], onFocus, onApply }) => {\n  const [loading, setLoading] = useState(true);\n  const [sugs, setSugs] = useState<SuggestionType[]>([]);\n\n  useEffect(() => {\n    let mounted = true;\n    (async () => {\n      setLoading(true);\n      try {\n        const base = await AutoCropEngine.suggestCrops(uri, ratios, { eyeWeight: 0.6, padPct: 0.16 });\n        const thumbs = await AutoCropEngine.makeThumbnails(uri, base, { size: 220, quality: 0.9 });\n        if (mounted) setSugs(thumbs);\n      } catch {\n        if (mounted) setSugs([]);\n      } finally {\n        if (mounted) setLoading(false);\n      }\n    })();\n    return () => { mounted = false; };\n  }, [uri, ratios]);\n\n  if (loading) {\n    return (\n      <View style={styles.wrap}>\n        <ActivityIndicator size=\"small\" color={Theme.colors.primary[500]} />\n        <Text style={styles.meta}>Finding the best frames…</Text>\n      </View>\n    );\n  }\n\n  if (!sugs.length) {\n    return (\n      <View style={styles.wrap}>\n        <Text style={styles.meta}>No suggestions—try manual crop.</Text>\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.wrap}>\n      <ScrollView horizontal showsHorizontalScrollIndicator={false} contentContainerStyle={styles.row}>\n        {sugs.map((s) => (\n          <View key={s.ratio} style={styles.card}>\n            <BouncePressable\n              onPress={() => { Haptics.selectionAsync(); onFocus?.(s.focus); }}\n              style={styles.thumbBtn}\n              accessibilityLabel={`Preview ${s.ratio} crop`}\n            >\n              {s.thumbUri ? (\n                <Image source={{ uri: s.thumbUri }} style={styles.thumbImg} resizeMode=\"cover\" />\n              ) : (\n                <View style={[styles.thumbImg, { justifyContent: \"center\", alignItems:\"center\"}]}>\n                  <Ionicons name=\"image\" size={24} color=\"#fff\" />\n                </View>\n              )}\n              <View style={styles.badge}>\n                <Text style={styles.badgeTxt}>{s.ratio}</Text>\n              </View>\n            </BouncePressable>\n\n            <BouncePressable\n              onPress={() => { Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium); onApply?.(s.crop); }}\n              style={styles.useBtn}\n              accessibilityLabel={`Apply ${s.ratio} crop`}\n            >\n              <Ionicons name=\"flash\" size={14} color=\"#fff\" />\n              <Text style={styles.useTxt}>Use</Text>\n            </BouncePressable>\n\n            <Text style={styles.meta}>\n              {s.method === \"eyes\" ? \"Eye-focus\" : s.method === \"face\" ? \"Face\" : \"Smart\"} • {s.ratio}\n            </Text>\n          </View>\n        ))}\n      </ScrollView>\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  wrap: { paddingVertical: 12, paddingHorizontal: 16 },\n  row: { gap: 12 },\n  card: { width: 140, alignItems: \"center\" },\n  thumbBtn: { borderRadius: 12, overflow: \"hidden\", borderWidth: 1, borderColor: \"rgba(255,255,255,0.15)\" },\n  thumbImg: { width: 140, height: 140, backgroundColor: \"rgba(255,255,255,0.06)\" },\n  badge: { position: \"absolute\", top: 8, right: 8, backgroundColor: \"rgba(0,0,0,0.55)\", paddingVertical: 4, paddingHorizontal: 8, borderRadius: 10 },\n  badgeTxt: { color: \"#fff\", fontSize: 12, fontWeight: \"700\" },\n  useBtn: { marginTop: 8, flexDirection: \"row\", alignItems: \"center\", gap: 6, paddingHorizontal: 10, paddingVertical: 6, backgroundColor: Theme.colors.primary[500], borderRadius: 10 },\n  useTxt: { color: \"#fff\", fontSize: 12, fontWeight: \"800\" },\n  meta: { marginTop: 6, color: \"rgba(255,255,255,0.7)\", fontSize: 12, textAlign: \"center\" },\n});\n"],"mappings":"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","ignoreList":[]}