e273e7aeb67fb5926b3ddb0a1022635c
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _reactNative = require("@testing-library/react-native");
function _getJestObj() {
  var _require4 = require("@jest/globals"),
    jest = _require4.jest;
  _getJestObj = function _getJestObj() {
    return jest;
  };
  return jest;
}
describe("Hooks Integration - Profile Management Flow", function () {
  _getJestObj().mock("../../../stores/useAuthStore", function () {
    return {
      useAuthStore: function useAuthStore() {
        return {
          user: {
            _id: "user123",
            firstName: "John",
            lastName: "Doe"
          },
          updateUser: jest.fn()
        };
      }
    };
  });
  _getJestObj().mock("../../../services/api", function () {
    return {
      matchesAPI: {
        getMyPets: jest.fn(),
        updateProfile: jest.fn()
      }
    };
  });
  _getJestObj().mock("../../../services/logger", function () {
    return {
      logger: {
        info: jest.fn(),
        error: jest.fn()
      }
    };
  });
  _getJestObj().mock("@react-native-async-storage/async-storage", function () {
    return {
      getItem: jest.fn(),
      setItem: jest.fn(),
      removeItem: jest.fn()
    };
  });
  var _require = require("../useProfileData"),
    useProfileData = _require.useProfileData;
  var _require2 = require("../useProfileUpdate"),
    useProfileUpdate = _require2.useProfileUpdate;
  var AsyncStorage = require("@react-native-async-storage/async-storage");
  var _require3 = require("../../../services/api"),
    matchesAPI = _require3.matchesAPI;
  var mockAsyncStorage = AsyncStorage;
  var mockMatchesAPI = matchesAPI;
  beforeEach(function () {
    jest.clearAllMocks();
    mockMatchesAPI.getMyPets.mockResolvedValue({
      data: [{
        _id: "pet1",
        name: "Buddy",
        species: "dog"
      }]
    });
    mockMatchesAPI.updateProfile.mockResolvedValue({
      _id: "user123",
      firstName: "John",
      lastName: "Updated",
      bio: "Updated bio"
    });
    mockAsyncStorage.getItem.mockResolvedValue(null);
    mockAsyncStorage.setItem.mockResolvedValue();
  });
  it("should demonstrate complete profile management workflow", (0, _asyncToGenerator2.default)(function* () {
    var _renderHook = (0, _reactNative.renderHook)(function () {
        return useProfileData();
      }),
      profileDataResult = _renderHook.result;
    var _renderHook2 = (0, _reactNative.renderHook)(function () {
        return useProfileUpdate();
      }),
      profileUpdateResult = _renderHook2.result;
    yield (0, _reactNative.waitFor)(function () {
      expect(profileDataResult.current.isLoading).toBe(false);
    });
    expect(profileDataResult.current.user.firstName).toBe("John");
    expect(profileDataResult.current.pets).toHaveLength(1);
    expect(profileDataResult.current.pets[0].name).toBe("Buddy");
    var updateData = {
      firstName: "Johnny",
      bio: "Love pets!"
    };
    var updateSuccess = yield (0, _reactNative.act)((0, _asyncToGenerator2.default)(function* () {
      return yield profileUpdateResult.current.updateProfile(updateData);
    }));
    expect(updateSuccess).toBe(true);
    expect(mockMatchesAPI.updateProfile).toHaveBeenCalledWith(updateData);
    (0, _reactNative.act)(function () {
      profileDataResult.current.refreshProfile();
    });
    yield (0, _reactNative.waitFor)(function () {
      expect(profileDataResult.current.isLoading).toBe(false);
    });
    expect(mockMatchesAPI.getMyPets).toHaveBeenCalledTimes(2);
  }));
  it("should handle error states across hooks", (0, _asyncToGenerator2.default)(function* () {
    mockMatchesAPI.getMyPets.mockRejectedValueOnce(new Error("Network error"));
    var _renderHook3 = (0, _reactNative.renderHook)(function () {
        return useProfileData();
      }),
      profileDataResult = _renderHook3.result;
    yield (0, _reactNative.waitFor)(function () {
      expect(profileDataResult.current.isLoading).toBe(false);
    });
    expect(profileDataResult.current.error).toBe("Network error");
    expect(profileDataResult.current.pets).toEqual([]);
    mockMatchesAPI.getMyPets.mockResolvedValueOnce({
      data: [{
        _id: "pet1",
        name: "Buddy",
        species: "dog"
      }]
    });
    (0, _reactNative.act)(function () {
      profileDataResult.current.refreshProfile();
    });
    yield (0, _reactNative.waitFor)(function () {
      expect(profileDataResult.current.isLoading).toBe(false);
    });
    expect(profileDataResult.current.error).toBe(null);
    expect(profileDataResult.current.pets).toHaveLength(1);
  }));
  it("should demonstrate hook composition benefits", function () {
    var _renderHook4 = (0, _reactNative.renderHook)(function () {
        return useProfileData();
      }),
      profileDataResult = _renderHook4.result;
    var _renderHook5 = (0, _reactNative.renderHook)(function () {
        return useProfileUpdate();
      }),
      profileUpdateResult = _renderHook5.result;
    expect(typeof profileDataResult.current.refreshProfile).toBe("function");
    expect(typeof profileUpdateResult.current.updateProfile).toBe("function");
    expect(profileDataResult.current.user).toBeDefined();
    expect(profileUpdateResult.current.isUpdating).toBe(false);
    expect(profileDataResult.current).not.toBe(profileUpdateResult.current);
  });
  it("should handle concurrent operations", (0, _asyncToGenerator2.default)(function* () {
    var _renderHook6 = (0, _reactNative.renderHook)(function () {
        return useProfileData();
      }),
      profileDataResult = _renderHook6.result;
    var _renderHook7 = (0, _reactNative.renderHook)(function () {
        return useProfileUpdate();
      }),
      profileUpdateResult = _renderHook7.result;
    yield (0, _reactNative.waitFor)(function () {
      expect(profileDataResult.current.isLoading).toBe(false);
    });
    var updatePromise = (0, _reactNative.act)((0, _asyncToGenerator2.default)(function* () {
      return yield profileUpdateResult.current.updateProfile({
        bio: "New bio"
      });
    }));
    (0, _reactNative.act)(function () {
      profileDataResult.current.refreshProfile();
    });
    var updateResult = yield updatePromise;
    yield (0, _reactNative.waitFor)(function () {
      expect(profileDataResult.current.isLoading).toBe(false);
    });
    expect(updateResult).toBe(true);
    expect(mockMatchesAPI.updateProfile).toHaveBeenCalledTimes(1);
    expect(mockMatchesAPI.getMyPets).toHaveBeenCalledTimes(2);
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3ROYXRpdmUiLCJyZXF1aXJlIiwiX2dldEplc3RPYmoiLCJfcmVxdWlyZTQiLCJqZXN0IiwiZGVzY3JpYmUiLCJtb2NrIiwidXNlQXV0aFN0b3JlIiwidXNlciIsIl9pZCIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwidXBkYXRlVXNlciIsImZuIiwibWF0Y2hlc0FQSSIsImdldE15UGV0cyIsInVwZGF0ZVByb2ZpbGUiLCJsb2dnZXIiLCJpbmZvIiwiZXJyb3IiLCJnZXRJdGVtIiwic2V0SXRlbSIsInJlbW92ZUl0ZW0iLCJfcmVxdWlyZSIsInVzZVByb2ZpbGVEYXRhIiwiX3JlcXVpcmUyIiwidXNlUHJvZmlsZVVwZGF0ZSIsIkFzeW5jU3RvcmFnZSIsIl9yZXF1aXJlMyIsIm1vY2tBc3luY1N0b3JhZ2UiLCJtb2NrTWF0Y2hlc0FQSSIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJkYXRhIiwibmFtZSIsInNwZWNpZXMiLCJiaW8iLCJpdCIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImRlZmF1bHQiLCJfcmVuZGVySG9vayIsInJlbmRlckhvb2siLCJwcm9maWxlRGF0YVJlc3VsdCIsInJlc3VsdCIsIl9yZW5kZXJIb29rMiIsInByb2ZpbGVVcGRhdGVSZXN1bHQiLCJ3YWl0Rm9yIiwiZXhwZWN0IiwiY3VycmVudCIsImlzTG9hZGluZyIsInRvQmUiLCJwZXRzIiwidG9IYXZlTGVuZ3RoIiwidXBkYXRlRGF0YSIsInVwZGF0ZVN1Y2Nlc3MiLCJhY3QiLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsInJlZnJlc2hQcm9maWxlIiwidG9IYXZlQmVlbkNhbGxlZFRpbWVzIiwibW9ja1JlamVjdGVkVmFsdWVPbmNlIiwiRXJyb3IiLCJfcmVuZGVySG9vazMiLCJ0b0VxdWFsIiwibW9ja1Jlc29sdmVkVmFsdWVPbmNlIiwiX3JlbmRlckhvb2s0IiwiX3JlbmRlckhvb2s1IiwidG9CZURlZmluZWQiLCJpc1VwZGF0aW5nIiwibm90IiwiX3JlbmRlckhvb2s2IiwiX3JlbmRlckhvb2s3IiwidXBkYXRlUHJvbWlzZSIsInVwZGF0ZVJlc3VsdCJdLCJzb3VyY2VzIjpbInByb2ZpbGUtaG9va3MuaW50ZWdyYXRpb24udGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBqZXN0LWVudmlyb25tZW50IGpzZG9tXG4gKi9cbmltcG9ydCB7IHJlbmRlckhvb2ssIGFjdCwgd2FpdEZvciB9IGZyb20gXCJAdGVzdGluZy1saWJyYXJ5L3JlYWN0LW5hdGl2ZVwiO1xuXG4vLyBJbnRlZ3JhdGlvbiB0ZXN0IHNob3dpbmcgaG9vayBjb21wb3NpdGlvblxuZGVzY3JpYmUoXCJIb29rcyBJbnRlZ3JhdGlvbiAtIFByb2ZpbGUgTWFuYWdlbWVudCBGbG93XCIsICgpID0+IHtcbiAgLy8gTW9jayBhbGwgZGVwZW5kZW5jaWVzXG4gIGplc3QubW9jayhcIi4uLy4uLy4uL3N0b3Jlcy91c2VBdXRoU3RvcmVcIiwgKCkgPT4gKHtcbiAgICB1c2VBdXRoU3RvcmU6ICgpID0+ICh7XG4gICAgICB1c2VyOiB7IF9pZDogXCJ1c2VyMTIzXCIsIGZpcnN0TmFtZTogXCJKb2huXCIsIGxhc3ROYW1lOiBcIkRvZVwiIH0sXG4gICAgICB1cGRhdGVVc2VyOiBqZXN0LmZuKCksXG4gICAgfSksXG4gIH0pKTtcblxuICBqZXN0Lm1vY2soXCIuLi8uLi8uLi9zZXJ2aWNlcy9hcGlcIiwgKCkgPT4gKHtcbiAgICBtYXRjaGVzQVBJOiB7XG4gICAgICBnZXRNeVBldHM6IGplc3QuZm4oKSxcbiAgICAgIHVwZGF0ZVByb2ZpbGU6IGplc3QuZm4oKSxcbiAgICB9LFxuICB9KSk7XG5cbiAgamVzdC5tb2NrKFwiLi4vLi4vLi4vc2VydmljZXMvbG9nZ2VyXCIsICgpID0+ICh7XG4gICAgbG9nZ2VyOiB7XG4gICAgICBpbmZvOiBqZXN0LmZuKCksXG4gICAgICBlcnJvcjogamVzdC5mbigpLFxuICAgIH0sXG4gIH0pKTtcblxuICBqZXN0Lm1vY2soXCJAcmVhY3QtbmF0aXZlLWFzeW5jLXN0b3JhZ2UvYXN5bmMtc3RvcmFnZVwiLCAoKSA9PiAoe1xuICAgIGdldEl0ZW06IGplc3QuZm4oKSxcbiAgICBzZXRJdGVtOiBqZXN0LmZuKCksXG4gICAgcmVtb3ZlSXRlbTogamVzdC5mbigpLFxuICB9KSk7XG5cbiAgY29uc3QgeyB1c2VQcm9maWxlRGF0YSB9ID0gcmVxdWlyZShcIi4uL3VzZVByb2ZpbGVEYXRhXCIpO1xuICBjb25zdCB7IHVzZVByb2ZpbGVVcGRhdGUgfSA9IHJlcXVpcmUoXCIuLi91c2VQcm9maWxlVXBkYXRlXCIpO1xuICBjb25zdCBBc3luY1N0b3JhZ2UgPSByZXF1aXJlKFwiQHJlYWN0LW5hdGl2ZS1hc3luYy1zdG9yYWdlL2FzeW5jLXN0b3JhZ2VcIik7XG4gIGNvbnN0IHsgbWF0Y2hlc0FQSSB9ID0gcmVxdWlyZShcIi4uLy4uLy4uL3NlcnZpY2VzL2FwaVwiKTtcblxuICBjb25zdCBtb2NrQXN5bmNTdG9yYWdlID0gQXN5bmNTdG9yYWdlO1xuICBjb25zdCBtb2NrTWF0Y2hlc0FQSSA9IG1hdGNoZXNBUEk7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG5cbiAgICAvLyBTZXR1cCBtb2Nrc1xuICAgIG1vY2tNYXRjaGVzQVBJLmdldE15UGV0cy5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICBkYXRhOiBbeyBfaWQ6IFwicGV0MVwiLCBuYW1lOiBcIkJ1ZGR5XCIsIHNwZWNpZXM6IFwiZG9nXCIgfV0sXG4gICAgfSk7XG5cbiAgICBtb2NrTWF0Y2hlc0FQSS51cGRhdGVQcm9maWxlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgIF9pZDogXCJ1c2VyMTIzXCIsXG4gICAgICBmaXJzdE5hbWU6IFwiSm9oblwiLFxuICAgICAgbGFzdE5hbWU6IFwiVXBkYXRlZFwiLFxuICAgICAgYmlvOiBcIlVwZGF0ZWQgYmlvXCIsXG4gICAgfSk7XG5cbiAgICBtb2NrQXN5bmNTdG9yYWdlLmdldEl0ZW0ubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG4gICAgbW9ja0FzeW5jU3RvcmFnZS5zZXRJdGVtLm1vY2tSZXNvbHZlZFZhbHVlKCk7XG4gIH0pO1xuXG4gIGl0KFwic2hvdWxkIGRlbW9uc3RyYXRlIGNvbXBsZXRlIHByb2ZpbGUgbWFuYWdlbWVudCB3b3JrZmxvd1wiLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gUmVuZGVyIG11bHRpcGxlIGhvb2tzIHRvZ2V0aGVyIHRvIHNpbXVsYXRlIHJlYWwgdXNhZ2VcbiAgICBjb25zdCB7IHJlc3VsdDogcHJvZmlsZURhdGFSZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlUHJvZmlsZURhdGEoKSk7XG4gICAgY29uc3QgeyByZXN1bHQ6IHByb2ZpbGVVcGRhdGVSZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT5cbiAgICAgIHVzZVByb2ZpbGVVcGRhdGUoKSxcbiAgICApO1xuXG4gICAgLy8gMS4gSW5pdGlhbCBwcm9maWxlIGRhdGEgbG9hZHNcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChwcm9maWxlRGF0YVJlc3VsdC5jdXJyZW50LmlzTG9hZGluZykudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBleHBlY3QocHJvZmlsZURhdGFSZXN1bHQuY3VycmVudC51c2VyLmZpcnN0TmFtZSkudG9CZShcIkpvaG5cIik7XG4gICAgZXhwZWN0KHByb2ZpbGVEYXRhUmVzdWx0LmN1cnJlbnQucGV0cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgIGV4cGVjdChwcm9maWxlRGF0YVJlc3VsdC5jdXJyZW50LnBldHNbMF0ubmFtZSkudG9CZShcIkJ1ZGR5XCIpO1xuXG4gICAgLy8gMi4gVXNlciB1cGRhdGVzIHByb2ZpbGVcbiAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgZmlyc3ROYW1lOiBcIkpvaG5ueVwiLFxuICAgICAgYmlvOiBcIkxvdmUgcGV0cyFcIixcbiAgICB9O1xuXG4gICAgY29uc3QgdXBkYXRlU3VjY2VzcyA9IGF3YWl0IGFjdChhc3luYyAoKSA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgcHJvZmlsZVVwZGF0ZVJlc3VsdC5jdXJyZW50LnVwZGF0ZVByb2ZpbGUodXBkYXRlRGF0YSk7XG4gICAgfSk7XG5cbiAgICBleHBlY3QodXBkYXRlU3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICBleHBlY3QobW9ja01hdGNoZXNBUEkudXBkYXRlUHJvZmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgodXBkYXRlRGF0YSk7XG5cbiAgICAvLyAzLiBQcm9maWxlIGRhdGEgcmVmcmVzaGVzIHRvIHNob3cgdXBkYXRlc1xuICAgIGFjdCgoKSA9PiB7XG4gICAgICBwcm9maWxlRGF0YVJlc3VsdC5jdXJyZW50LnJlZnJlc2hQcm9maWxlKCk7XG4gICAgfSk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChwcm9maWxlRGF0YVJlc3VsdC5jdXJyZW50LmlzTG9hZGluZykudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICAvLyBWZXJpZnkgdGhlIHVwZGF0ZSB3YXMgcHJvY2Vzc2VkXG4gICAgZXhwZWN0KG1vY2tNYXRjaGVzQVBJLmdldE15UGV0cykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpOyAvLyBJbml0aWFsICsgcmVmcmVzaFxuICB9KTtcblxuICBpdChcInNob3VsZCBoYW5kbGUgZXJyb3Igc3RhdGVzIGFjcm9zcyBob29rc1wiLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gU2V0dXAgZXJyb3Igc2NlbmFyaW9cbiAgICBtb2NrTWF0Y2hlc0FQSS5nZXRNeVBldHMubW9ja1JlamVjdGVkVmFsdWVPbmNlKG5ldyBFcnJvcihcIk5ldHdvcmsgZXJyb3JcIikpO1xuXG4gICAgY29uc3QgeyByZXN1bHQ6IHByb2ZpbGVEYXRhUmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZVByb2ZpbGVEYXRhKCkpO1xuXG4gICAgLy8gUHJvZmlsZSBkYXRhIGZhaWxzIHRvIGxvYWRcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChwcm9maWxlRGF0YVJlc3VsdC5jdXJyZW50LmlzTG9hZGluZykudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBleHBlY3QocHJvZmlsZURhdGFSZXN1bHQuY3VycmVudC5lcnJvcikudG9CZShcIk5ldHdvcmsgZXJyb3JcIik7XG4gICAgZXhwZWN0KHByb2ZpbGVEYXRhUmVzdWx0LmN1cnJlbnQucGV0cykudG9FcXVhbChbXSk7XG5cbiAgICAvLyBSZWNvdmVyeTogZml4IHRoZSBBUEkgYW5kIHJlZnJlc2hcbiAgICBtb2NrTWF0Y2hlc0FQSS5nZXRNeVBldHMubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgIGRhdGE6IFt7IF9pZDogXCJwZXQxXCIsIG5hbWU6IFwiQnVkZHlcIiwgc3BlY2llczogXCJkb2dcIiB9XSxcbiAgICB9KTtcblxuICAgIGFjdCgoKSA9PiB7XG4gICAgICBwcm9maWxlRGF0YVJlc3VsdC5jdXJyZW50LnJlZnJlc2hQcm9maWxlKCk7XG4gICAgfSk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChwcm9maWxlRGF0YVJlc3VsdC5jdXJyZW50LmlzTG9hZGluZykudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBleHBlY3QocHJvZmlsZURhdGFSZXN1bHQuY3VycmVudC5lcnJvcikudG9CZShudWxsKTtcbiAgICBleHBlY3QocHJvZmlsZURhdGFSZXN1bHQuY3VycmVudC5wZXRzKS50b0hhdmVMZW5ndGgoMSk7XG4gIH0pO1xuXG4gIGl0KFwic2hvdWxkIGRlbW9uc3RyYXRlIGhvb2sgY29tcG9zaXRpb24gYmVuZWZpdHNcIiwgKCkgPT4ge1xuICAgIC8vIFRoaXMgdGVzdCBzaG93cyBob3cgaG9va3MgY29tcG9zZSB0b2dldGhlclxuICAgIGNvbnN0IHsgcmVzdWx0OiBwcm9maWxlRGF0YVJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VQcm9maWxlRGF0YSgpKTtcbiAgICBjb25zdCB7IHJlc3VsdDogcHJvZmlsZVVwZGF0ZVJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PlxuICAgICAgdXNlUHJvZmlsZVVwZGF0ZSgpLFxuICAgICk7XG5cbiAgICAvLyBFYWNoIGhvb2sgbWFpbnRhaW5zIGl0cyBvd24gc3RhdGVcbiAgICBleHBlY3QodHlwZW9mIHByb2ZpbGVEYXRhUmVzdWx0LmN1cnJlbnQucmVmcmVzaFByb2ZpbGUpLnRvQmUoXCJmdW5jdGlvblwiKTtcbiAgICBleHBlY3QodHlwZW9mIHByb2ZpbGVVcGRhdGVSZXN1bHQuY3VycmVudC51cGRhdGVQcm9maWxlKS50b0JlKFwiZnVuY3Rpb25cIik7XG5cbiAgICAvLyBIb29rcyBjYW4gYmUgdXNlZCBpbmRlcGVuZGVudGx5IG9yIHRvZ2V0aGVyXG4gICAgZXhwZWN0KHByb2ZpbGVEYXRhUmVzdWx0LmN1cnJlbnQudXNlcikudG9CZURlZmluZWQoKTtcbiAgICBleHBlY3QocHJvZmlsZVVwZGF0ZVJlc3VsdC5jdXJyZW50LmlzVXBkYXRpbmcpLnRvQmUoZmFsc2UpO1xuXG4gICAgLy8gU3RhdGUgaXMgcHJvcGVybHkgaXNvbGF0ZWQgYmV0d2VlbiBob29rc1xuICAgIGV4cGVjdChwcm9maWxlRGF0YVJlc3VsdC5jdXJyZW50KS5ub3QudG9CZShwcm9maWxlVXBkYXRlUmVzdWx0LmN1cnJlbnQpO1xuICB9KTtcblxuICBpdChcInNob3VsZCBoYW5kbGUgY29uY3VycmVudCBvcGVyYXRpb25zXCIsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB7IHJlc3VsdDogcHJvZmlsZURhdGFSZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlUHJvZmlsZURhdGEoKSk7XG4gICAgY29uc3QgeyByZXN1bHQ6IHByb2ZpbGVVcGRhdGVSZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT5cbiAgICAgIHVzZVByb2ZpbGVVcGRhdGUoKSxcbiAgICApO1xuXG4gICAgLy8gV2FpdCBmb3IgaW5pdGlhbCBkYXRhIGxvYWRcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChwcm9maWxlRGF0YVJlc3VsdC5jdXJyZW50LmlzTG9hZGluZykudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICAvLyBTdGFydCBib3RoIG9wZXJhdGlvbnMgY29uY3VycmVudGx5XG4gICAgY29uc3QgdXBkYXRlUHJvbWlzZSA9IGFjdChhc3luYyAoKSA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgcHJvZmlsZVVwZGF0ZVJlc3VsdC5jdXJyZW50LnVwZGF0ZVByb2ZpbGUoe1xuICAgICAgICBiaW86IFwiTmV3IGJpb1wiLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBhY3QoKCkgPT4ge1xuICAgICAgcHJvZmlsZURhdGFSZXN1bHQuY3VycmVudC5yZWZyZXNoUHJvZmlsZSgpO1xuICAgIH0pO1xuXG4gICAgLy8gQm90aCBvcGVyYXRpb25zIHNob3VsZCBjb21wbGV0ZSBzdWNjZXNzZnVsbHlcbiAgICBjb25zdCB1cGRhdGVSZXN1bHQgPSBhd2FpdCB1cGRhdGVQcm9taXNlO1xuXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3QocHJvZmlsZURhdGFSZXN1bHQuY3VycmVudC5pc0xvYWRpbmcpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgZXhwZWN0KHVwZGF0ZVJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QobW9ja01hdGNoZXNBUEkudXBkYXRlUHJvZmlsZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIGV4cGVjdChtb2NrTWF0Y2hlc0FQSS5nZXRNeVBldHMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcbiAgfSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6Ijs7OztBQUdBLElBQUFBLFlBQUEsR0FBQUMsT0FBQTtBQUF5RSxTQUFBQyxZQUFBO0VBQUEsSUFBQUMsU0FBQSxHQUFBRixPQUFBO0lBQUFHLElBQUEsR0FBQUQsU0FBQSxDQUFBQyxJQUFBO0VBQUFGLFdBQUEsWUFB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