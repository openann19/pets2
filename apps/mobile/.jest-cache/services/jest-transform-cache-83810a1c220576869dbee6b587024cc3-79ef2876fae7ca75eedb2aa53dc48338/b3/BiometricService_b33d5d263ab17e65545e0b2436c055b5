ab6731723c5abe64f41ba4e6f80e4e83
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.biometricService = void 0;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var LocalAuthentication = _interopRequireWildcard(require("expo-local-authentication"));
var SecureStore = _interopRequireWildcard(require("expo-secure-store"));
var _core = require("@pawfectmatch/core");
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function _interopRequireWildcard(e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (var _t2 in e) "default" !== _t2 && {}.hasOwnProperty.call(e, _t2) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, _t2)) && (i.get || i.set) ? o(f, _t2, i) : f[_t2] = e[_t2]); return f; })(e, t); }
var BiometricService = function () {
  function BiometricService() {
    (0, _classCallCheck2.default)(this, BiometricService);
  }
  return (0, _createClass2.default)(BiometricService, [{
    key: "checkBiometricSupport",
    value: (function () {
      var _checkBiometricSupport = (0, _asyncToGenerator2.default)(function* () {
        try {
          var hasHardware = yield LocalAuthentication.hasHardwareAsync();
          var isEnrolled = yield LocalAuthentication.isEnrolledAsync();
          var supportedTypes = yield LocalAuthentication.supportedAuthenticationTypesAsync();
          var capabilities = {
            hasHardware: hasHardware,
            isEnrolled: isEnrolled,
            supportedTypes: supportedTypes
          };
          _core.logger.info("Biometric capabilities checked", {
            hasHardware: hasHardware,
            isEnrolled: isEnrolled,
            supportedTypes: supportedTypes.length
          });
          return capabilities;
        } catch (error) {
          _core.logger.error("Failed to check biometric support", {
            error: error
          });
          return {
            hasHardware: false,
            isEnrolled: false,
            supportedTypes: []
          };
        }
      });
      function checkBiometricSupport() {
        return _checkBiometricSupport.apply(this, arguments);
      }
      return checkBiometricSupport;
    }())
  }, {
    key: "authenticate",
    value: (function () {
      var _authenticate = (0, _asyncToGenerator2.default)(function* (reason) {
        try {
          var capabilities = yield this.checkBiometricSupport();
          if (!capabilities.hasHardware) {
            return {
              success: false,
              error: "Biometric authentication not supported on this device"
            };
          }
          if (!capabilities.isEnrolled) {
            return {
              success: false,
              error: "No biometric authentication methods enrolled"
            };
          }
          var result = yield LocalAuthentication.authenticateAsync({
            promptMessage: reason !== undefined && reason !== "" ? reason : "Authenticate to access PawfectMatch",
            fallbackLabel: "Use PIN",
            cancelLabel: "Cancel",
            disableDeviceFallback: false
          });
          var biometricType = this.getBiometricType(capabilities.supportedTypes);
          if (result.success) {
            _core.logger.info("Biometric authentication successful", {
              biometricType: biometricType
            });
            return {
              success: true,
              biometricType: biometricType
            };
          } else {
            var error = result.error !== "" ? result.error : "Authentication failed";
            _core.logger.warn("Biometric authentication failed", {
              error: error,
              biometricType: biometricType
            });
            return {
              success: false,
              error: error,
              biometricType: biometricType
            };
          }
        } catch (error) {
          _core.logger.error("Biometric authentication error", {
            error: error
          });
          return {
            success: false,
            error: error instanceof Error ? error.message : "Unknown error occurred"
          };
        }
      });
      function authenticate(_x) {
        return _authenticate.apply(this, arguments);
      }
      return authenticate;
    }())
  }, {
    key: "enableBiometric",
    value: (function () {
      var _enableBiometric = (0, _asyncToGenerator2.default)(function* () {
        try {
          var authResult = yield this.authenticate("Enable biometric authentication");
          if (!authResult.success) {
            return false;
          }
          yield SecureStore.setItemAsync(BiometricService.BIOMETRIC_ENABLED_KEY, "true");
          yield SecureStore.setItemAsync(BiometricService.BIOMETRIC_TYPE_KEY, authResult.biometricType !== undefined ? authResult.biometricType : "unknown");
          _core.logger.info("Biometric authentication enabled", {
            type: authResult.biometricType
          });
          return true;
        } catch (error) {
          _core.logger.error("Failed to enable biometric authentication", {
            error: error
          });
          return false;
        }
      });
      function enableBiometric() {
        return _enableBiometric.apply(this, arguments);
      }
      return enableBiometric;
    }())
  }, {
    key: "disableBiometric",
    value: (function () {
      var _disableBiometric = (0, _asyncToGenerator2.default)(function* () {
        try {
          yield SecureStore.deleteItemAsync(BiometricService.BIOMETRIC_ENABLED_KEY);
          yield SecureStore.deleteItemAsync(BiometricService.BIOMETRIC_TYPE_KEY);
          _core.logger.info("Biometric authentication disabled");
        } catch (error) {
          _core.logger.error("Failed to disable biometric authentication", {
            error: error
          });
        }
      });
      function disableBiometric() {
        return _disableBiometric.apply(this, arguments);
      }
      return disableBiometric;
    }())
  }, {
    key: "isBiometricEnabled",
    value: (function () {
      var _isBiometricEnabled = (0, _asyncToGenerator2.default)(function* () {
        try {
          var enabled = yield SecureStore.getItemAsync(BiometricService.BIOMETRIC_ENABLED_KEY);
          return enabled === "true";
        } catch (error) {
          _core.logger.error("Failed to check biometric status", {
            error: error
          });
          return false;
        }
      });
      function isBiometricEnabled() {
        return _isBiometricEnabled.apply(this, arguments);
      }
      return isBiometricEnabled;
    }())
  }, {
    key: "getBiometricType",
    value: function getBiometricType(supportedTypes) {
      if (supportedTypes.includes(LocalAuthentication.AuthenticationType.FACIAL_RECOGNITION)) {
        return "facial";
      }
      if (supportedTypes.includes(LocalAuthentication.AuthenticationType.FINGERPRINT)) {
        return "fingerprint";
      }
      if (supportedTypes.includes(LocalAuthentication.AuthenticationType.IRIS)) {
        return "iris";
      }
      return "unknown";
    }
  }, {
    key: "getBiometricTypeName",
    value: function getBiometricTypeName(type) {
      switch (type) {
        case "facial":
          return "Face ID";
        case "fingerprint":
          return "Touch ID";
        case "iris":
          return "Iris Scan";
        default:
          return "Biometric Authentication";
      }
    }
  }, {
    key: "encryptWithBiometric",
    value: (function () {
      var _encryptWithBiometric = (0, _asyncToGenerator2.default)(function* (data, key) {
        try {
          var authResult = yield this.authenticate("Encrypt sensitive data");
          if (!authResult.success) {
            throw new Error("Biometric authentication required for encryption");
          }
          yield SecureStore.setItemAsync(key, data, {
            requireAuthentication: true,
            authenticationPrompt: "Authenticate to access encrypted data",
            showPrompt: true
          });
          _core.logger.info("Data encrypted securely with biometric authentication", {
            key: key,
            biometricType: authResult.biometricType
          });
        } catch (error) {
          _core.logger.error("Failed to encrypt data with biometric protection", {
            error: error
          });
          throw error;
        }
      });
      function encryptWithBiometric(_x2, _x3) {
        return _encryptWithBiometric.apply(this, arguments);
      }
      return encryptWithBiometric;
    }())
  }, {
    key: "decryptWithBiometric",
    value: (function () {
      var _decryptWithBiometric = (0, _asyncToGenerator2.default)(function* (key) {
        try {
          var authResult = yield this.authenticate("Decrypt sensitive data");
          if (!authResult.success) {
            throw new Error("Biometric authentication required");
          }
          var decryptedData = yield SecureStore.getItemAsync(key, {
            requireAuthentication: true,
            authenticationPrompt: "Authenticate to decrypt sensitive data",
            showPrompt: true
          });
          _core.logger.info("Data decrypted successfully with biometric authentication", {
            key: key,
            biometricType: authResult.biometricType
          });
          return decryptedData;
        } catch (error) {
          _core.logger.error("Failed to decrypt biometric data", {
            error: error
          });
          throw error;
        }
      });
      function decryptWithBiometric(_x4) {
        return _decryptWithBiometric.apply(this, arguments);
      }
      return decryptWithBiometric;
    }())
  }, {
    key: "removeBiometricData",
    value: (function () {
      var _removeBiometricData = (0, _asyncToGenerator2.default)(function* (key) {
        try {
          yield SecureStore.deleteItemAsync(key);
          _core.logger.info("Biometric-protected data removed", {
            key: key
          });
        } catch (error) {
          _core.logger.error("Failed to remove biometric data", {
            error: error
          });
          throw error;
        }
      });
      function removeBiometricData(_x5) {
        return _removeBiometricData.apply(this, arguments);
      }
      return removeBiometricData;
    }())
  }]);
}();
BiometricService.BIOMETRIC_ENABLED_KEY = "biometric_enabled";
BiometricService.BIOMETRIC_TYPE_KEY = "biometric_type";
var biometricService = exports.biometricService = new BiometricService();
var _default = exports.default = biometricService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJMb2NhbEF1dGhlbnRpY2F0aW9uIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJyZXF1aXJlIiwiU2VjdXJlU3RvcmUiLCJfY29yZSIsImUiLCJ0IiwiV2Vha01hcCIsInIiLCJuIiwiX19lc01vZHVsZSIsIm8iLCJpIiwiZiIsIl9fcHJvdG9fXyIsImRlZmF1bHQiLCJoYXMiLCJnZXQiLCJzZXQiLCJfdDIiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsIkJpb21ldHJpY1NlcnZpY2UiLCJfY2xhc3NDYWxsQ2hlY2syIiwiX2NyZWF0ZUNsYXNzMiIsImtleSIsInZhbHVlIiwiX2NoZWNrQmlvbWV0cmljU3VwcG9ydCIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImhhc0hhcmR3YXJlIiwiaGFzSGFyZHdhcmVBc3luYyIsImlzRW5yb2xsZWQiLCJpc0Vucm9sbGVkQXN5bmMiLCJzdXBwb3J0ZWRUeXBlcyIsInN1cHBvcnRlZEF1dGhlbnRpY2F0aW9uVHlwZXNBc3luYyIsImNhcGFiaWxpdGllcyIsImxvZ2dlciIsImluZm8iLCJsZW5ndGgiLCJlcnJvciIsImNoZWNrQmlvbWV0cmljU3VwcG9ydCIsImFwcGx5IiwiYXJndW1lbnRzIiwiX2F1dGhlbnRpY2F0ZSIsInJlYXNvbiIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJhdXRoZW50aWNhdGVBc3luYyIsInByb21wdE1lc3NhZ2UiLCJ1bmRlZmluZWQiLCJmYWxsYmFja0xhYmVsIiwiY2FuY2VsTGFiZWwiLCJkaXNhYmxlRGV2aWNlRmFsbGJhY2siLCJiaW9tZXRyaWNUeXBlIiwiZ2V0QmlvbWV0cmljVHlwZSIsIndhcm4iLCJFcnJvciIsIm1lc3NhZ2UiLCJhdXRoZW50aWNhdGUiLCJfeCIsIl9lbmFibGVCaW9tZXRyaWMiLCJhdXRoUmVzdWx0Iiwic2V0SXRlbUFzeW5jIiwiQklPTUVUUklDX0VOQUJMRURfS0VZIiwiQklPTUVUUklDX1RZUEVfS0VZIiwidHlwZSIsImVuYWJsZUJpb21ldHJpYyIsIl9kaXNhYmxlQmlvbWV0cmljIiwiZGVsZXRlSXRlbUFzeW5jIiwiZGlzYWJsZUJpb21ldHJpYyIsIl9pc0Jpb21ldHJpY0VuYWJsZWQiLCJlbmFibGVkIiwiZ2V0SXRlbUFzeW5jIiwiaXNCaW9tZXRyaWNFbmFibGVkIiwiaW5jbHVkZXMiLCJBdXRoZW50aWNhdGlvblR5cGUiLCJGQUNJQUxfUkVDT0dOSVRJT04iLCJGSU5HRVJQUklOVCIsIklSSVMiLCJnZXRCaW9tZXRyaWNUeXBlTmFtZSIsIl9lbmNyeXB0V2l0aEJpb21ldHJpYyIsImRhdGEiLCJyZXF1aXJlQXV0aGVudGljYXRpb24iLCJhdXRoZW50aWNhdGlvblByb21wdCIsInNob3dQcm9tcHQiLCJlbmNyeXB0V2l0aEJpb21ldHJpYyIsIl94MiIsIl94MyIsIl9kZWNyeXB0V2l0aEJpb21ldHJpYyIsImRlY3J5cHRlZERhdGEiLCJkZWNyeXB0V2l0aEJpb21ldHJpYyIsIl94NCIsIl9yZW1vdmVCaW9tZXRyaWNEYXRhIiwicmVtb3ZlQmlvbWV0cmljRGF0YSIsIl94NSIsImJpb21ldHJpY1NlcnZpY2UiLCJleHBvcnRzIiwiX2RlZmF1bHQiXSwic291cmNlcyI6WyJCaW9tZXRyaWNTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQmlvbWV0cmljIEF1dGhlbnRpY2F0aW9uIFNlcnZpY2UgZm9yIFBhd2ZlY3RNYXRjaCBNb2JpbGUgQXBwXG4gKiBIYW5kbGVzIGJpb21ldHJpYyBhdXRoZW50aWNhdGlvbiAoRmFjZUlELCBUb3VjaElELCBGaW5nZXJwcmludClcbiAqL1xuaW1wb3J0ICogYXMgTG9jYWxBdXRoZW50aWNhdGlvbiBmcm9tIFwiZXhwby1sb2NhbC1hdXRoZW50aWNhdGlvblwiO1xuaW1wb3J0ICogYXMgU2VjdXJlU3RvcmUgZnJvbSBcImV4cG8tc2VjdXJlLXN0b3JlXCI7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tIFwiQHBhd2ZlY3RtYXRjaC9jb3JlXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmlvbWV0cmljQXV0aFJlc3VsdCB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIGVycm9yPzogc3RyaW5nO1xuICBiaW9tZXRyaWNUeXBlPzogXCJmaW5nZXJwcmludFwiIHwgXCJmYWNpYWxcIiB8IFwiaXJpc1wiIHwgXCJ1bmtub3duXCI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmlvbWV0cmljQ2FwYWJpbGl0aWVzIHtcbiAgaGFzSGFyZHdhcmU6IGJvb2xlYW47XG4gIGlzRW5yb2xsZWQ6IGJvb2xlYW47XG4gIHN1cHBvcnRlZFR5cGVzOiBMb2NhbEF1dGhlbnRpY2F0aW9uLkF1dGhlbnRpY2F0aW9uVHlwZVtdO1xufVxuXG5jbGFzcyBCaW9tZXRyaWNTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgQklPTUVUUklDX0VOQUJMRURfS0VZID0gXCJiaW9tZXRyaWNfZW5hYmxlZFwiO1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBCSU9NRVRSSUNfVFlQRV9LRVkgPSBcImJpb21ldHJpY190eXBlXCI7XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGRldmljZSBzdXBwb3J0cyBiaW9tZXRyaWMgYXV0aGVudGljYXRpb25cbiAgICovXG4gIGFzeW5jIGNoZWNrQmlvbWV0cmljU3VwcG9ydCgpOiBQcm9taXNlPEJpb21ldHJpY0NhcGFiaWxpdGllcz4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBoYXNIYXJkd2FyZSA9IGF3YWl0IExvY2FsQXV0aGVudGljYXRpb24uaGFzSGFyZHdhcmVBc3luYygpO1xuICAgICAgY29uc3QgaXNFbnJvbGxlZCA9IGF3YWl0IExvY2FsQXV0aGVudGljYXRpb24uaXNFbnJvbGxlZEFzeW5jKCk7XG4gICAgICBjb25zdCBzdXBwb3J0ZWRUeXBlcyA9XG4gICAgICAgIGF3YWl0IExvY2FsQXV0aGVudGljYXRpb24uc3VwcG9ydGVkQXV0aGVudGljYXRpb25UeXBlc0FzeW5jKCk7XG5cbiAgICAgIGNvbnN0IGNhcGFiaWxpdGllczogQmlvbWV0cmljQ2FwYWJpbGl0aWVzID0ge1xuICAgICAgICBoYXNIYXJkd2FyZSxcbiAgICAgICAgaXNFbnJvbGxlZCxcbiAgICAgICAgc3VwcG9ydGVkVHlwZXMsXG4gICAgICB9O1xuXG4gICAgICBsb2dnZXIuaW5mbyhcIkJpb21ldHJpYyBjYXBhYmlsaXRpZXMgY2hlY2tlZFwiLCB7XG4gICAgICAgIGhhc0hhcmR3YXJlLFxuICAgICAgICBpc0Vucm9sbGVkLFxuICAgICAgICBzdXBwb3J0ZWRUeXBlczogc3VwcG9ydGVkVHlwZXMubGVuZ3RoLFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBjYXBhYmlsaXRpZXM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBjaGVjayBiaW9tZXRyaWMgc3VwcG9ydFwiLCB7IGVycm9yIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaGFzSGFyZHdhcmU6IGZhbHNlLFxuICAgICAgICBpc0Vucm9sbGVkOiBmYWxzZSxcbiAgICAgICAgc3VwcG9ydGVkVHlwZXM6IFtdLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQXV0aGVudGljYXRlIHVzaW5nIGJpb21ldHJpY3NcbiAgICovXG4gIGFzeW5jIGF1dGhlbnRpY2F0ZShyZWFzb24/OiBzdHJpbmcpOiBQcm9taXNlPEJpb21ldHJpY0F1dGhSZXN1bHQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY2FwYWJpbGl0aWVzID0gYXdhaXQgdGhpcy5jaGVja0Jpb21ldHJpY1N1cHBvcnQoKTtcblxuICAgICAgaWYgKCFjYXBhYmlsaXRpZXMuaGFzSGFyZHdhcmUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogXCJCaW9tZXRyaWMgYXV0aGVudGljYXRpb24gbm90IHN1cHBvcnRlZCBvbiB0aGlzIGRldmljZVwiLFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICBpZiAoIWNhcGFiaWxpdGllcy5pc0Vucm9sbGVkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IFwiTm8gYmlvbWV0cmljIGF1dGhlbnRpY2F0aW9uIG1ldGhvZHMgZW5yb2xsZWRcIixcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgTG9jYWxBdXRoZW50aWNhdGlvbi5hdXRoZW50aWNhdGVBc3luYyh7XG4gICAgICAgIHByb21wdE1lc3NhZ2U6XG4gICAgICAgICAgcmVhc29uICE9PSB1bmRlZmluZWQgJiYgcmVhc29uICE9PSBcIlwiXG4gICAgICAgICAgICA/IHJlYXNvblxuICAgICAgICAgICAgOiBcIkF1dGhlbnRpY2F0ZSB0byBhY2Nlc3MgUGF3ZmVjdE1hdGNoXCIsXG4gICAgICAgIGZhbGxiYWNrTGFiZWw6IFwiVXNlIFBJTlwiLFxuICAgICAgICBjYW5jZWxMYWJlbDogXCJDYW5jZWxcIixcbiAgICAgICAgZGlzYWJsZURldmljZUZhbGxiYWNrOiBmYWxzZSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBiaW9tZXRyaWNUeXBlID0gdGhpcy5nZXRCaW9tZXRyaWNUeXBlKGNhcGFiaWxpdGllcy5zdXBwb3J0ZWRUeXBlcyk7XG5cbiAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICBsb2dnZXIuaW5mbyhcIkJpb21ldHJpYyBhdXRoZW50aWNhdGlvbiBzdWNjZXNzZnVsXCIsIHsgYmlvbWV0cmljVHlwZSB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGJpb21ldHJpY1R5cGUsXG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBlcnJvciA9XG4gICAgICAgICAgcmVzdWx0LmVycm9yICE9PSBcIlwiID8gcmVzdWx0LmVycm9yIDogXCJBdXRoZW50aWNhdGlvbiBmYWlsZWRcIjtcbiAgICAgICAgbG9nZ2VyLndhcm4oXCJCaW9tZXRyaWMgYXV0aGVudGljYXRpb24gZmFpbGVkXCIsIHtcbiAgICAgICAgICBlcnJvcixcbiAgICAgICAgICBiaW9tZXRyaWNUeXBlLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcixcbiAgICAgICAgICBiaW9tZXRyaWNUeXBlLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXCJCaW9tZXRyaWMgYXV0aGVudGljYXRpb24gZXJyb3JcIiwgeyBlcnJvciB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjpcbiAgICAgICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFwiVW5rbm93biBlcnJvciBvY2N1cnJlZFwiLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRW5hYmxlIGJpb21ldHJpYyBhdXRoZW50aWNhdGlvbiBmb3IgdGhlIGFwcFxuICAgKi9cbiAgYXN5bmMgZW5hYmxlQmlvbWV0cmljKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBGaXJzdCBhdXRoZW50aWNhdGUgdG8gdmVyaWZ5IGJpb21ldHJpY3Mgd29ya1xuICAgICAgY29uc3QgYXV0aFJlc3VsdCA9IGF3YWl0IHRoaXMuYXV0aGVudGljYXRlKFxuICAgICAgICBcIkVuYWJsZSBiaW9tZXRyaWMgYXV0aGVudGljYXRpb25cIixcbiAgICAgICk7XG5cbiAgICAgIGlmICghYXV0aFJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gU3RvcmUgdGhhdCBiaW9tZXRyaWMgaXMgZW5hYmxlZFxuICAgICAgYXdhaXQgU2VjdXJlU3RvcmUuc2V0SXRlbUFzeW5jKFxuICAgICAgICBCaW9tZXRyaWNTZXJ2aWNlLkJJT01FVFJJQ19FTkFCTEVEX0tFWSxcbiAgICAgICAgXCJ0cnVlXCIsXG4gICAgICApO1xuICAgICAgYXdhaXQgU2VjdXJlU3RvcmUuc2V0SXRlbUFzeW5jKFxuICAgICAgICBCaW9tZXRyaWNTZXJ2aWNlLkJJT01FVFJJQ19UWVBFX0tFWSxcbiAgICAgICAgYXV0aFJlc3VsdC5iaW9tZXRyaWNUeXBlICE9PSB1bmRlZmluZWRcbiAgICAgICAgICA/IGF1dGhSZXN1bHQuYmlvbWV0cmljVHlwZVxuICAgICAgICAgIDogXCJ1bmtub3duXCIsXG4gICAgICApO1xuXG4gICAgICBsb2dnZXIuaW5mbyhcIkJpb21ldHJpYyBhdXRoZW50aWNhdGlvbiBlbmFibGVkXCIsIHtcbiAgICAgICAgdHlwZTogYXV0aFJlc3VsdC5iaW9tZXRyaWNUeXBlLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGVuYWJsZSBiaW9tZXRyaWMgYXV0aGVudGljYXRpb25cIiwgeyBlcnJvciB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGlzYWJsZSBiaW9tZXRyaWMgYXV0aGVudGljYXRpb24gZm9yIHRoZSBhcHBcbiAgICovXG4gIGFzeW5jIGRpc2FibGVCaW9tZXRyaWMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IFNlY3VyZVN0b3JlLmRlbGV0ZUl0ZW1Bc3luYyhCaW9tZXRyaWNTZXJ2aWNlLkJJT01FVFJJQ19FTkFCTEVEX0tFWSk7XG4gICAgICBhd2FpdCBTZWN1cmVTdG9yZS5kZWxldGVJdGVtQXN5bmMoQmlvbWV0cmljU2VydmljZS5CSU9NRVRSSUNfVFlQRV9LRVkpO1xuICAgICAgbG9nZ2VyLmluZm8oXCJCaW9tZXRyaWMgYXV0aGVudGljYXRpb24gZGlzYWJsZWRcIik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBkaXNhYmxlIGJpb21ldHJpYyBhdXRoZW50aWNhdGlvblwiLCB7IGVycm9yIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBiaW9tZXRyaWMgYXV0aGVudGljYXRpb24gaXMgZW5hYmxlZCBmb3IgdGhlIGFwcFxuICAgKi9cbiAgYXN5bmMgaXNCaW9tZXRyaWNFbmFibGVkKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBlbmFibGVkID0gYXdhaXQgU2VjdXJlU3RvcmUuZ2V0SXRlbUFzeW5jKFxuICAgICAgICBCaW9tZXRyaWNTZXJ2aWNlLkJJT01FVFJJQ19FTkFCTEVEX0tFWSxcbiAgICAgICk7XG4gICAgICByZXR1cm4gZW5hYmxlZCA9PT0gXCJ0cnVlXCI7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBjaGVjayBiaW9tZXRyaWMgc3RhdHVzXCIsIHsgZXJyb3IgfSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgdHlwZSBvZiBiaW9tZXRyaWMgYXV0aGVudGljYXRpb24gYXZhaWxhYmxlXG4gICAqL1xuICBwcml2YXRlIGdldEJpb21ldHJpY1R5cGUoXG4gICAgc3VwcG9ydGVkVHlwZXM6IExvY2FsQXV0aGVudGljYXRpb24uQXV0aGVudGljYXRpb25UeXBlW10sXG4gICk6IFwiZmluZ2VycHJpbnRcIiB8IFwiZmFjaWFsXCIgfCBcImlyaXNcIiB8IFwidW5rbm93blwiIHtcbiAgICBpZiAoXG4gICAgICBzdXBwb3J0ZWRUeXBlcy5pbmNsdWRlcyhcbiAgICAgICAgTG9jYWxBdXRoZW50aWNhdGlvbi5BdXRoZW50aWNhdGlvblR5cGUuRkFDSUFMX1JFQ09HTklUSU9OLFxuICAgICAgKVxuICAgICkge1xuICAgICAgcmV0dXJuIFwiZmFjaWFsXCI7XG4gICAgfVxuICAgIGlmIChcbiAgICAgIHN1cHBvcnRlZFR5cGVzLmluY2x1ZGVzKFxuICAgICAgICBMb2NhbEF1dGhlbnRpY2F0aW9uLkF1dGhlbnRpY2F0aW9uVHlwZS5GSU5HRVJQUklOVCxcbiAgICAgIClcbiAgICApIHtcbiAgICAgIHJldHVybiBcImZpbmdlcnByaW50XCI7XG4gICAgfVxuICAgIGlmIChzdXBwb3J0ZWRUeXBlcy5pbmNsdWRlcyhMb2NhbEF1dGhlbnRpY2F0aW9uLkF1dGhlbnRpY2F0aW9uVHlwZS5JUklTKSkge1xuICAgICAgcmV0dXJuIFwiaXJpc1wiO1xuICAgIH1cbiAgICByZXR1cm4gXCJ1bmtub3duXCI7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHVzZXItZnJpZW5kbHkgYmlvbWV0cmljIHR5cGUgbmFtZVxuICAgKi9cbiAgZ2V0QmlvbWV0cmljVHlwZU5hbWUodHlwZT86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlIFwiZmFjaWFsXCI6XG4gICAgICAgIHJldHVybiBcIkZhY2UgSURcIjtcbiAgICAgIGNhc2UgXCJmaW5nZXJwcmludFwiOlxuICAgICAgICByZXR1cm4gXCJUb3VjaCBJRFwiO1xuICAgICAgY2FzZSBcImlyaXNcIjpcbiAgICAgICAgcmV0dXJuIFwiSXJpcyBTY2FuXCI7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gXCJCaW9tZXRyaWMgQXV0aGVudGljYXRpb25cIjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRW5jcnlwdCBzZW5zaXRpdmUgZGF0YSB3aXRoIGJpb21ldHJpYyBwcm90ZWN0aW9uXG4gICAqIFVzZXMgU2VjdXJlU3RvcmUgd2l0aCBiaW9tZXRyaWMgYXV0aGVudGljYXRpb24gZm9yIHByb2R1Y3Rpb24tZ3JhZGUgZW5jcnlwdGlvblxuICAgKi9cbiAgYXN5bmMgZW5jcnlwdFdpdGhCaW9tZXRyaWMoZGF0YTogc3RyaW5nLCBrZXk6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBBdXRoZW50aWNhdGUgZmlyc3RcbiAgICAgIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCB0aGlzLmF1dGhlbnRpY2F0ZShcIkVuY3J5cHQgc2Vuc2l0aXZlIGRhdGFcIik7XG4gICAgICBpZiAoIWF1dGhSZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJCaW9tZXRyaWMgYXV0aGVudGljYXRpb24gcmVxdWlyZWQgZm9yIGVuY3J5cHRpb25cIik7XG4gICAgICB9XG5cbiAgICAgIC8vIFN0b3JlIHNlY3VyZWx5IGluIGtleWNoYWluIHdpdGggYmlvbWV0cmljIHByb3RlY3Rpb25cbiAgICAgIGF3YWl0IFNlY3VyZVN0b3JlLnNldEl0ZW1Bc3luYyhrZXksIGRhdGEsIHtcbiAgICAgICAgcmVxdWlyZUF1dGhlbnRpY2F0aW9uOiB0cnVlLFxuICAgICAgICBhdXRoZW50aWNhdGlvblByb21wdDogXCJBdXRoZW50aWNhdGUgdG8gYWNjZXNzIGVuY3J5cHRlZCBkYXRhXCIsXG4gICAgICAgIHNob3dQcm9tcHQ6IHRydWUsXG4gICAgICB9KTtcblxuICAgICAgbG9nZ2VyLmluZm8oXCJEYXRhIGVuY3J5cHRlZCBzZWN1cmVseSB3aXRoIGJpb21ldHJpYyBhdXRoZW50aWNhdGlvblwiLCB7XG4gICAgICAgIGtleSxcbiAgICAgICAgYmlvbWV0cmljVHlwZTogYXV0aFJlc3VsdC5iaW9tZXRyaWNUeXBlLFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBlbmNyeXB0IGRhdGEgd2l0aCBiaW9tZXRyaWMgcHJvdGVjdGlvblwiLCB7IGVycm9yIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERlY3J5cHQgZGF0YSBwcm90ZWN0ZWQgYnkgYmlvbWV0cmljc1xuICAgKi9cbiAgYXN5bmMgZGVjcnlwdFdpdGhCaW9tZXRyaWMoa2V5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgLy8gRmlyc3QgYXV0aGVudGljYXRlXG4gICAgICBjb25zdCBhdXRoUmVzdWx0ID0gYXdhaXQgdGhpcy5hdXRoZW50aWNhdGUoXCJEZWNyeXB0IHNlbnNpdGl2ZSBkYXRhXCIpO1xuICAgICAgaWYgKCFhdXRoUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQmlvbWV0cmljIGF1dGhlbnRpY2F0aW9uIHJlcXVpcmVkXCIpO1xuICAgICAgfVxuXG4gICAgICAvLyBSZXRyaWV2ZSBmcm9tIHNlY3VyZSBzdG9yZSAodHJpZ2dlcnMgYmlvbWV0cmljIHByb21wdClcbiAgICAgIGNvbnN0IGRlY3J5cHRlZERhdGEgPSBhd2FpdCBTZWN1cmVTdG9yZS5nZXRJdGVtQXN5bmMoa2V5LCB7XG4gICAgICAgIHJlcXVpcmVBdXRoZW50aWNhdGlvbjogdHJ1ZSxcbiAgICAgICAgYXV0aGVudGljYXRpb25Qcm9tcHQ6IFwiQXV0aGVudGljYXRlIHRvIGRlY3J5cHQgc2Vuc2l0aXZlIGRhdGFcIixcbiAgICAgICAgc2hvd1Byb21wdDogdHJ1ZSxcbiAgICAgIH0pO1xuXG4gICAgICBsb2dnZXIuaW5mbyhcIkRhdGEgZGVjcnlwdGVkIHN1Y2Nlc3NmdWxseSB3aXRoIGJpb21ldHJpYyBhdXRoZW50aWNhdGlvblwiLCB7XG4gICAgICAgIGtleSxcbiAgICAgICAgYmlvbWV0cmljVHlwZTogYXV0aFJlc3VsdC5iaW9tZXRyaWNUeXBlLFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBkZWNyeXB0ZWREYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZGVjcnlwdCBiaW9tZXRyaWMgZGF0YVwiLCB7IGVycm9yIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBlbmNyeXB0ZWQgZGF0YSBmcm9tIGJpb21ldHJpYy1wcm90ZWN0ZWQgc3RvcmFnZVxuICAgKi9cbiAgYXN5bmMgcmVtb3ZlQmlvbWV0cmljRGF0YShrZXk6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBTZWN1cmVTdG9yZS5kZWxldGVJdGVtQXN5bmMoa2V5KTtcbiAgICAgIGxvZ2dlci5pbmZvKFwiQmlvbWV0cmljLXByb3RlY3RlZCBkYXRhIHJlbW92ZWRcIiwgeyBrZXkgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byByZW1vdmUgYmlvbWV0cmljIGRhdGFcIiwgeyBlcnJvciB9KTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxufVxuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgYmlvbWV0cmljU2VydmljZSA9IG5ldyBCaW9tZXRyaWNTZXJ2aWNlKCk7XG5leHBvcnQgZGVmYXVsdCBiaW9tZXRyaWNTZXJ2aWNlO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBSUEsSUFBQUEsbUJBQUEsR0FBQUMsdUJBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFdBQUEsR0FBQUYsdUJBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUYsT0FBQTtBQUE0QyxTQUFBRCx3QkFBQUksQ0FBQSxFQUFBQyxDQUFBLDZCQUFBQyxPQUFBLE1BQUFDLENBQUEsT0FBQUQsT0FBQSxJQUFBRSxDQUFBLE9BQUFGLE9BQUEsWUFBQU4sdUJBQUEsWUFBQUEsd0JBQUFJLENBQUEsRUFBQUMsQ0FBQSxTQUFBQSxDQUFBLElBQUFELENBQUEsSUFBQUEsQ0FBQSxDQUFBSyxVQUFBLFNBQUFMLENBQUEsTUFBQU0sQ0FBQSxFQUFBQyxDQUFBLEVBQUFDLENBQUEsS0FBQUMsU0FB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