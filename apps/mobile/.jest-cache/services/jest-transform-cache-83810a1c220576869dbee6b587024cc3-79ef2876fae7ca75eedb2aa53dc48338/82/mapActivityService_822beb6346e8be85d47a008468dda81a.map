{"version":3,"names":["Location","_interopRequireWildcard","require","cov_1zwj6vmqze","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","type","locations","undefined","s","f","b","_coverageSchema","coverage","actualCoverage","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty2","default","getOwnPropertyDescriptors","defineProperties","defineProperty","WeakMap","n","__esModule","i","__proto__","has","get","set","_t2","hasOwnProperty","call","startActivity","_x","_startActivity","_asyncToGenerator2","params","location","getCurrentPositionAsync","accuracy","Accuracy","Balanced","_ref","Promise","resolve","then","request","response","method","body","latitude","coords","longitude","endActivity","_x2","_endActivity","activityId","_ref2","getNearbyPins","_x3","_x4","_x5","_getNearbyPins","maxDistance","_ref3","likePin","_x6","_likePin","pinId","_ref4","commentOnPin","_x7","_x8","_commentOnPin","text","_ref5"],"sources":["mapActivityService.ts"],"sourcesContent":["import { api } from './api';\nimport * as Location from 'expo-location';\n\nexport interface CreateActivityParams {\n  petId: string;\n  activity: string;\n  message?: string;\n  shareToMap?: boolean;\n  radiusMeters?: number;\n}\n\nexport interface MapPin {\n  _id: string;\n  userId: string;\n  petId: string;\n  activity: string;\n  message?: string;\n  location: {\n    type: string;\n    coordinates: [number, number]; // [longitude, latitude]\n  };\n  radiusMeters: number;\n  shareToMap: boolean;\n  active: boolean;\n  likes: Array<{\n    userId: string;\n    likedAt: string;\n  }>;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface MapSearchParams {\n  latitude: number;\n  longitude: number;\n  maxDistance?: number;\n}\n\nexport async function startActivity(params: CreateActivityParams): Promise<MapPin> {\n  const location = await Location.getCurrentPositionAsync({\n    accuracy: Location.Accuracy.Balanced,\n  });\n\n  const { request } = await import('./api');\n  const response = await request<MapPin>('/map/activity/start', {\n    method: 'POST',\n    body: {\n      ...params,\n      location: { \n        latitude: location.coords.latitude, \n        longitude: location.coords.longitude \n      },\n    },\n  });\n\n  return response;\n}\n\nexport async function endActivity(activityId: string): Promise<void> {\n  const { request } = await import('./api');\n  await request('/map/activity/end', {\n    method: 'POST',\n    body: { activityId },\n  });\n}\n\nexport async function getNearbyPins(\n  latitude: number,\n  longitude: number,\n  maxDistance?: number\n): Promise<MapPin[]> {\n  const { request } = await import('./api');\n  const params: Record<string, number> = { latitude, longitude };\n  if (maxDistance) params.maxDistance = maxDistance;\n\n  const response = await request<MapPin[]>('/map/pins', {\n    method: 'GET',\n    params: params as Record<string, string | number | boolean | null | undefined>,\n  });\n  return response;\n}\n\nexport async function likePin(pinId: string): Promise<{ likes: number }> {\n  const { request } = await import('./api');\n  const response = await request<{ likes: number }>(`/map/pins/${pinId}/like`, {\n    method: 'POST',\n  });\n  return response;\n}\n\nexport async function commentOnPin(pinId: string, text: string): Promise<{ comments: number }> {\n  const { request } = await import('./api');\n  const response = await request<{ comments: number }>(`/map/pins/${pinId}/comment`, {\n    method: 'POST',\n    body: { text },\n  });\n  return response;\n}\n\n"],"mappings":"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","ignoreList":[]}