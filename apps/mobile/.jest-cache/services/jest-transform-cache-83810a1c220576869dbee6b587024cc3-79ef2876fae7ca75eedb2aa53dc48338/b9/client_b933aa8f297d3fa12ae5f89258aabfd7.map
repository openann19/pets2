{"version":3,"names":["_interopRequireDefault","require","_slicedToArray2","_asyncToGenerator2","_classCallCheck2","_createClass2","Object","defineProperty","exports","value","apiClient","axios_1","environment_1","ApiClient","_process$env$NEXT_PUB","default","client","create","baseURL","process","env","timeout","headers","setupInterceptors","key","interceptors","request","use","config","storage","getLocalStorage","token","getItem","trim","length","_config$headers","bearerToken","isAxiosHeaders","AxiosHeaders","set","error","Promise","reject","Error","extractErrorMessage","response","console","isAxiosErrorLike","_error$response","_error$response2","_statusCode$toString","status","removeItem","redirectTo","statusCode","toString","_get","url","get","data","_x","_x2","apply","arguments","_post","post","_x3","_x4","_x5","_put","put","_x6","_x7","_x8","_patch","patch","_x9","_x0","_x1","_delete2","delete","_x10","_x11","_uploadFile","formData","FormData","append","file","additionalData","entries","forEach","_ref","_ref2","String","axiosConfig","onProgress","onUploadProgress","progressEvent","total","progress","Math","round","loaded","uploadFile","_x12","_x13","fallback","_error$response$data$","_error$response3","_error$response3$data","message"],"sources":["client.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.apiClient = void 0;\nconst axios_1 = require(\"axios\");\nconst environment_1 = require(\"../utils/environment\");\nclass ApiClient {\n    client;\n    constructor() {\n        this.client = axios_1.default.create({\n            baseURL: process.env['NEXT_PUBLIC_API_URL'] ?? 'http://localhost:5000/api',\n            timeout: 10000,\n            headers: {\n                'Content-Type': 'application/json',\n            },\n        });\n        this.setupInterceptors();\n    }\n    setupInterceptors() {\n        // Request interceptor to add auth token\n        this.client.interceptors.request.use((config) => {\n            const storage = (0, environment_1.getLocalStorage)();\n            const token = storage?.getItem('accessToken');\n            if (typeof token === 'string' && token.trim().length > 0) {\n                const bearerToken = `Bearer ${token.trim()}`;\n                const headers = isAxiosHeaders(config.headers)\n                    ? config.headers\n                    : new axios_1.AxiosHeaders(config.headers ?? {});\n                headers.set('Authorization', bearerToken);\n                config.headers = headers;\n            }\n            return config;\n        }, (error) => Promise.reject(new Error(extractErrorMessage(error, 'Request interceptor failed'))));\n        // Response interceptor for error handling\n        this.client.interceptors.response.use((response) => response, (error) => {\n            console.error('Response interceptor error:', extractErrorMessage(error, 'Unknown error'));\n            if (isAxiosErrorLike(error)) {\n                if (error.response?.status === 401) {\n                    const storage = (0, environment_1.getLocalStorage)();\n                    storage?.removeItem('accessToken');\n                    storage?.removeItem('refreshToken');\n                    (0, environment_1.redirectTo)('/login');\n                }\n                const statusCode = error.response?.status;\n                return Promise.reject(new Error(`API request failed: ${statusCode?.toString() ?? 'Unknown error'}`));\n            }\n            return Promise.reject(new Error(extractErrorMessage(error, 'Response interceptor failed')));\n        });\n    }\n    // Generic request methods with proper error handling\n    async get(url, config) {\n        try {\n            const response = await this.client.get(url, config);\n            return response.data;\n        }\n        catch (error) {\n            throw new Error(extractErrorMessage(error, 'Request failed'));\n        }\n    }\n    async post(url, data, config) {\n        try {\n            const response = await this.client.post(url, data, config);\n            return response.data;\n        }\n        catch (error) {\n            throw new Error(extractErrorMessage(error, 'Request failed'));\n        }\n    }\n    async put(url, data, config) {\n        try {\n            const response = await this.client.put(url, data, config);\n            return response.data;\n        }\n        catch (error) {\n            throw new Error(extractErrorMessage(error, 'Request failed'));\n        }\n    }\n    async patch(url, data, config) {\n        try {\n            const response = await this.client.patch(url, data, config);\n            return response.data;\n        }\n        catch (error) {\n            throw new Error(extractErrorMessage(error, 'Request failed'));\n        }\n    }\n    async delete(url, config) {\n        try {\n            const response = await this.client.delete(url, config);\n            return response.data;\n        }\n        catch (error) {\n            throw new Error(extractErrorMessage(error, 'Request failed'));\n        }\n    }\n    // File upload helper with proper typing\n    async uploadFile(url, config) {\n        try {\n            const formData = new FormData();\n            formData.append('file', config.file);\n            if (config.additionalData != null) {\n                Object.entries(config.additionalData).forEach(([key, value]) => {\n                    formData.append(key, String(value));\n                });\n            }\n            const axiosConfig = {\n                headers: {\n                    'Content-Type': 'multipart/form-data',\n                },\n            };\n            if (config.onProgress != null) {\n                axiosConfig.onUploadProgress = (progressEvent) => {\n                    if (progressEvent.total != null && progressEvent.total > 0) {\n                        const progress = Math.round((progressEvent.loaded * 100) / progressEvent.total);\n                        config.onProgress(progress);\n                    }\n                };\n            }\n            const response = await this.client.post(url, formData, axiosConfig);\n            return response.data;\n        }\n        catch (error) {\n            throw new Error(extractErrorMessage(error, 'Upload failed'));\n        }\n    }\n}\n// Create and export singleton instance\nexports.apiClient = new ApiClient();\nexports.default = exports.apiClient;\nconst isAxiosErrorLike = (error) => {\n    return typeof error === 'object' && error !== null && 'response' in error;\n};\nconst isAxiosHeaders = (headers) => {\n    return (typeof headers === 'object' &&\n        headers !== null &&\n        'set' in headers &&\n        typeof headers.set === 'function');\n};\nconst extractErrorMessage = (error, fallback) => {\n    if (isAxiosErrorLike(error)) {\n        const message = error.response?.data?.message ?? error.message;\n        if (typeof message === 'string' && message.trim().length > 0) {\n            return message;\n        }\n    }\n    if (error instanceof Error && error.message.trim().length > 0) {\n        return error.message;\n    }\n    if (typeof error === 'string' && error.trim().length > 0) {\n        return error.trim();\n    }\n    return fallback;\n};\n"],"mappings":"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","ignoreList":[]}