{"version":3,"names":["_interopRequireDefault","require","_defineProperty2","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","default","getOwnPropertyDescriptors","defineProperties","defineProperty","exports","value","toCorePet","toCorePets","toLegacyPet","legacy","_sizeMap$legacy$size$","_speciesMap$legacy$sp","now","Date","toISOString","coordinates","location","Array","isArray","_legacy$location$long","_legacy$location$lati","longitude","latitude","_legacy$location$lon","_legacy$location$lat","lon","lat","sizeMap","size","toLowerCase","speciesMap","species","photos","map","photo","index","url","isPrimary","caption","corePet","_id","id","owner","ownerId","name","breed","age","isNaN","gender","weight","videos","description","personalityTags","temperament","intent","availability","isAvailable","healthInfo","vaccinated","spayedNeutered","microchipped","type","featured","isFeatured","boostCount","analytics","views","likes","matches","messages","isActive","isVerified","status","listedAt","createdAt","updatedAt","legacyPets","pet","p"],"sources":["pet.js"],"sourcesContent":["\"use strict\";\n// Removed empty import statement\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.toCorePet = toCorePet;\nexports.toCorePets = toCorePets;\nexports.toLegacyPet = toLegacyPet;\nfunction toCorePet(legacy) {\n    const now = new Date().toISOString();\n    // Handle various location formats\n    let coordinates = [0, 0];\n    if (legacy.location != null) {\n        if ('coordinates' in legacy.location && Array.isArray(legacy.location.coordinates)) {\n            coordinates = legacy.location.coordinates;\n        }\n        else if ('latitude' in legacy.location && 'longitude' in legacy.location) {\n            coordinates = [legacy.location.longitude ?? 0, legacy.location.latitude ?? 0];\n        }\n        else if ('lon' in legacy.location && 'lat' in legacy.location) {\n            coordinates = [legacy.location.lon ?? 0, legacy.location.lat ?? 0];\n        }\n    }\n    // Normalize size\n    const sizeMap = {\n        'small': 'small',\n        'medium': 'medium',\n        'large': 'large',\n        'tiny': 'tiny',\n        'extra-large': 'extra-large',\n        'xl': 'extra-large',\n    };\n    const size = legacy.size != null && legacy.size.length > 0 ? (sizeMap[legacy.size.toLowerCase()] ?? 'medium') : 'medium';\n    // Normalize species\n    const speciesMap = {\n        'dog': 'dog',\n        'cat': 'cat',\n        'bird': 'bird',\n        'rabbit': 'rabbit',\n    };\n    const species = legacy.species != null && legacy.species.length > 0 ? (speciesMap[legacy.species.toLowerCase()] ?? 'other') : 'dog';\n    // Convert photos\n    const photos = (legacy.photos != null ? legacy.photos : []).map((photo, index) => ({\n        url: typeof photo === 'string' ? photo : photo.url,\n        isPrimary: typeof photo === 'object' ? (photo.isPrimary != null ? photo.isPrimary : index === 0) : index === 0,\n        caption: '',\n    }));\n    const corePet = {\n        _id: legacy.id,\n        id: legacy.id,\n        owner: legacy.ownerId != null ? legacy.ownerId : '',\n        name: legacy.name.length > 0 ? legacy.name : 'Unknown',\n        species,\n        breed: legacy.breed.length > 0 ? legacy.breed : 'Mixed',\n        age: !isNaN(legacy.age) ? legacy.age : 0,\n        gender: legacy.gender != null ? legacy.gender : 'male',\n        size,\n        ...(legacy.weight != null && !isNaN(legacy.weight) && { weight: legacy.weight }),\n        photos,\n        videos: [],\n        description: legacy.description != null && legacy.description.length > 0 ? legacy.description : '',\n        personalityTags: legacy.temperament != null ? legacy.temperament : [],\n        intent: 'all',\n        availability: {\n            isAvailable: true,\n        },\n        healthInfo: {\n            vaccinated: false,\n            spayedNeutered: false,\n            microchipped: false,\n        },\n        location: {\n            type: 'Point',\n            coordinates,\n        },\n        featured: {\n            isFeatured: false,\n            boostCount: 0,\n        },\n        analytics: {\n            views: 0,\n            likes: 0,\n            matches: 0,\n            messages: 0,\n        },\n        isActive: true,\n        isVerified: false,\n        status: 'active',\n        listedAt: now,\n        createdAt: now,\n        updatedAt: now,\n    };\n    return corePet;\n}\n/**\n * Convert array of legacy pets to core Pet types\n */\nfunction toCorePets(legacyPets) {\n    return legacyPets.map(toCorePet);\n}\n/**\n * Convert core Pet to legacy format (for API requests)\n */\nfunction toLegacyPet(pet) {\n    const legacy = {\n        id: pet._id,\n        name: pet.name,\n        breed: pet.breed,\n        age: pet.age,\n    };\n    if (typeof pet.owner === 'string') {\n        legacy.ownerId = pet.owner;\n    }\n    else if (typeof pet.owner === 'object' && '_id' in pet.owner) {\n        legacy.ownerId = pet.owner._id;\n    }\n    legacy.species = pet.species;\n    legacy.gender = pet.gender;\n    legacy.size = pet.size;\n    if (pet.weight != null)\n        legacy.weight = pet.weight;\n    if (pet.description != null)\n        legacy.description = pet.description;\n    legacy.temperament = pet.personalityTags;\n    if (pet.photos.length > 0) {\n        legacy.photos = pet.photos.map(p => ({ url: p.url, isPrimary: p.isPrimary }));\n    }\n    legacy.location = {\n        longitude: pet.location.coordinates[0],\n        latitude: pet.location.coordinates[1],\n    };\n    return legacy;\n}\n"],"mappings":"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","ignoreList":[]}