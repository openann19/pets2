453a25f61cbb48419a9976e43379fa2c
"use strict";
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.RequestRetryStrategy = void 0;
var logger_1 = require("../utils/logger");
var DEFAULT_CONFIG = {
  maxRetries: 3,
  baseDelay: 1000,
  maxDelay: 30000,
  strategy: 'exponential',
  jitter: true,
  retryBudget: 10000,
  retryableStatusCodes: [408, 429, 500, 502, 503, 504],
  retryableErrors: ['ECONNRESET', 'ETIMEDOUT', 'ENOTFOUND']
};
var RequestRetryStrategy = function () {
  function RequestRetryStrategy() {
    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    (0, _classCallCheck2.default)(this, RequestRetryStrategy);
    this.networkCondition = 'excellent';
    this.config = _objectSpread(_objectSpread({}, DEFAULT_CONFIG), config);
  }
  return (0, _createClass2.default)(RequestRetryStrategy, [{
    key: "execute",
    value: (function () {
      var _execute = (0, _asyncToGenerator2.default)(function* (fn, errorHandler) {
        var lastError;
        var startTime = Date.now();
        for (var attempt = 0; attempt <= this.config.maxRetries; attempt++) {
          try {
            var result = yield fn();
            if (attempt > 0) {
              logger_1.logger.info('Request succeeded after retry', {
                attempt: attempt,
                attempts: attempt + 1
              });
            }
            return result;
          } catch (error) {
            lastError = error;
            var elapsedTime = Date.now() - startTime;
            if (!this.isRetryable(error, attempt)) {
              logger_1.logger.debug('Error not retryable', {
                error: error,
                attempt: attempt
              });
              throw error;
            }
            if (this.config.retryBudget && elapsedTime >= this.config.retryBudget) {
              logger_1.logger.warn('Retry budget exceeded', {
                elapsedTime: elapsedTime,
                budget: this.config.retryBudget
              });
              throw error;
            }
            if (errorHandler) {
              var retryContext = {
                attempt: attempt,
                totalAttempts: attempt + 1,
                delay: this.calculateDelay(attempt),
                elapsedTime: elapsedTime,
                reason: this.getErrorReason(error)
              };
              if (!errorHandler(error, retryContext)) {
                throw error;
              }
            }
            if (attempt < this.config.maxRetries) {
              var delay = this.calculateDelay(attempt);
              logger_1.logger.debug('Retrying request', {
                attempt: attempt + 1,
                maxRetries: this.config.maxRetries,
                delay: delay
              });
              yield this.sleep(delay);
            }
          }
        }
        logger_1.logger.error('Request failed after all retries', {
          attempts: this.config.maxRetries + 1,
          lastError: lastError
        });
        throw lastError;
      });
      function execute(_x, _x2) {
        return _execute.apply(this, arguments);
      }
      return execute;
    }())
  }, {
    key: "isRetryable",
    value: function isRetryable(error, attempt) {
      var _this$config$retryabl;
      if (attempt >= this.config.maxRetries) {
        return false;
      }
      var errorMessage = error instanceof Error ? error.message : String(error);
      if ((_this$config$retryabl = this.config.retryableErrors) != null && _this$config$retryabl.some(function (code) {
        return errorMessage.includes(code);
      })) {
        return true;
      }
      if (this.isHttpError(error)) {
        var _this$config$retryabl2, _this$config$retryabl3;
        var statusCode = this.getHttpStatusCode(error);
        return (_this$config$retryabl2 = (_this$config$retryabl3 = this.config.retryableStatusCodes) == null ? void 0 : _this$config$retryabl3.includes(statusCode)) != null ? _this$config$retryabl2 : false;
      }
      return this.isNetworkError(error);
    }
  }, {
    key: "calculateDelay",
    value: function calculateDelay(attempt) {
      var delay;
      switch (this.config.strategy) {
        case 'exponential':
          delay = Math.min(this.config.baseDelay * Math.pow(2, attempt), this.config.maxDelay);
          break;
        case 'linear':
          delay = Math.min(this.config.baseDelay * (attempt + 1), this.config.maxDelay);
          break;
        case 'fixed':
          delay = this.config.baseDelay;
          break;
        case 'none':
        default:
          return 0;
      }
      if (this.config.jitter) {
        var jitterAmount = delay * 0.1;
        delay += Math.random() * jitterAmount * 2 - jitterAmount;
      }
      delay = this.adjustForNetworkCondition(delay);
      return Math.max(0, Math.floor(delay));
    }
  }, {
    key: "adjustForNetworkCondition",
    value: function adjustForNetworkCondition(delay) {
      var multipliers = {
        excellent: 1.0,
        good: 1.2,
        fair: 1.5,
        poor: 2.0
      };
      return delay * multipliers[this.networkCondition];
    }
  }, {
    key: "updateNetworkCondition",
    value: function updateNetworkCondition(condition) {
      this.networkCondition = condition;
    }
  }, {
    key: "generateIdempotencyKey",
    value: function generateIdempotencyKey(endpoint, data) {
      var dataHash = data ? this.hashData(data) : '';
      return `${endpoint}_${Date.now()}_${dataHash}`;
    }
  }, {
    key: "hashData",
    value: function hashData(data) {
      try {
        var json = JSON.stringify(data);
        var hash = 0;
        for (var i = 0; i < json.length; i++) {
          var char = json.charCodeAt(i);
          hash = (hash << 5) - hash + char;
          hash = hash & hash;
        }
        return Math.abs(hash).toString(36);
      } catch (_unused) {
        return Math.random().toString(36).substring(2, 11);
      }
    }
  }, {
    key: "sleep",
    value: function sleep(ms) {
      return new Promise(function (resolve) {
        return setTimeout(resolve, ms);
      });
    }
  }, {
    key: "isNetworkError",
    value: function isNetworkError(error) {
      if (error instanceof Error) {
        return error.message.includes('network') || error.message.includes('timeout') || error.message.includes('ECONNREFUSED') || error.message.includes('ETIMEDOUT');
      }
      return false;
    }
  }, {
    key: "isHttpError",
    value: function isHttpError(error) {
      return typeof error === 'object' && error !== null && 'status' in error;
    }
  }, {
    key: "getHttpStatusCode",
    value: function getHttpStatusCode(error) {
      if (this.isHttpError(error)) {
        return error.status;
      }
      return 0;
    }
  }, {
    key: "getErrorReason",
    value: function getErrorReason(error) {
      if (error instanceof Error) {
        return error.message;
      }
      return String(error);
    }
  }]);
}();
exports.RequestRetryStrategy = RequestRetryStrategy;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9hc3luY1RvR2VuZXJhdG9yMiIsIl9kZWZpbmVQcm9wZXJ0eTIiLCJfY2xhc3NDYWxsQ2hlY2syIiwiX2NyZWF0ZUNsYXNzMiIsIm93bktleXMiLCJlIiwiciIsInQiLCJPYmplY3QiLCJrZXlzIiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwibyIsImZpbHRlciIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJwdXNoIiwiYXBwbHkiLCJfb2JqZWN0U3ByZWFkIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiZm9yRWFjaCIsImRlZmF1bHQiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZGVmaW5lUHJvcGVydGllcyIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiUmVxdWVzdFJldHJ5U3RyYXRlZ3kiLCJsb2dnZXJfMSIsIkRFRkFVTFRfQ09ORklHIiwibWF4UmV0cmllcyIsImJhc2VEZWxheSIsIm1heERlbGF5Iiwic3RyYXRlZ3kiLCJqaXR0ZXIiLCJyZXRyeUJ1ZGdldCIsInJldHJ5YWJsZVN0YXR1c0NvZGVzIiwicmV0cnlhYmxlRXJyb3JzIiwiY29uZmlnIiwidW5kZWZpbmVkIiwibmV0d29ya0NvbmRpdGlvbiIsImtleSIsIl9leGVjdXRlIiwiZm4iLCJlcnJvckhhbmRsZXIiLCJsYXN0RXJyb3IiLCJzdGFydFRpbWUiLCJEYXRlIiwibm93IiwiYXR0ZW1wdCIsInJlc3VsdCIsImxvZ2dlciIsImluZm8iLCJhdHRlbXB0cyIsImVycm9yIiwiZWxhcHNlZFRpbWUiLCJpc1JldHJ5YWJsZSIsImRlYnVnIiwid2FybiIsImJ1ZGdldCIsInJldHJ5Q29udGV4dCIsInRvdGFsQXR0ZW1wdHMiLCJkZWxheSIsImNhbGN1bGF0ZURlbGF5IiwicmVhc29uIiwiZ2V0RXJyb3JSZWFzb24iLCJzbGVlcCIsImV4ZWN1dGUiLCJfeCIsIl94MiIsIl90aGlzJGNvbmZpZyRyZXRyeWFibCIsImVycm9yTWVzc2FnZSIsIkVycm9yIiwibWVzc2FnZSIsIlN0cmluZyIsInNvbWUiLCJjb2RlIiwiaW5jbHVkZXMiLCJpc0h0dHBFcnJvciIsIl90aGlzJGNvbmZpZyRyZXRyeWFibDIiLCJfdGhpcyRjb25maWckcmV0cnlhYmwzIiwic3RhdHVzQ29kZSIsImdldEh0dHBTdGF0dXNDb2RlIiwiaXNOZXR3b3JrRXJyb3IiLCJNYXRoIiwibWluIiwicG93Iiwiaml0dGVyQW1vdW50IiwicmFuZG9tIiwiYWRqdXN0Rm9yTmV0d29ya0NvbmRpdGlvbiIsIm1heCIsImZsb29yIiwibXVsdGlwbGllcnMiLCJleGNlbGxlbnQiLCJnb29kIiwiZmFpciIsInBvb3IiLCJ1cGRhdGVOZXR3b3JrQ29uZGl0aW9uIiwiY29uZGl0aW9uIiwiZ2VuZXJhdGVJZGVtcG90ZW5jeUtleSIsImVuZHBvaW50IiwiZGF0YSIsImRhdGFIYXNoIiwiaGFzaERhdGEiLCJqc29uIiwiSlNPTiIsInN0cmluZ2lmeSIsImhhc2giLCJpIiwiY2hhciIsImNoYXJDb2RlQXQiLCJhYnMiLCJ0b1N0cmluZyIsIl91bnVzZWQiLCJzdWJzdHJpbmciLCJtcyIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsInN0YXR1cyJdLCJzb3VyY2VzIjpbIlJlcXVlc3RSZXRyeVN0cmF0ZWd5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBBZHZhbmNlZCBSZXF1ZXN0IFJldHJ5IFN0cmF0ZWd5XG4gKiBJbXBsZW1lbnRzIGV4cG9uZW50aWFsIGJhY2tvZmYgd2l0aCBqaXR0ZXIsIHJldHJ5IGJ1ZGdldHMsIGFuZCBuZXR3b3JrIGF3YXJlbmVzc1xuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLlJlcXVlc3RSZXRyeVN0cmF0ZWd5ID0gdm9pZCAwO1xuY29uc3QgbG9nZ2VyXzEgPSByZXF1aXJlKFwiLi4vdXRpbHMvbG9nZ2VyXCIpO1xuY29uc3QgREVGQVVMVF9DT05GSUcgPSB7XG4gICAgbWF4UmV0cmllczogMyxcbiAgICBiYXNlRGVsYXk6IDEwMDAsXG4gICAgbWF4RGVsYXk6IDMwMDAwLFxuICAgIHN0cmF0ZWd5OiAnZXhwb25lbnRpYWwnLFxuICAgIGppdHRlcjogdHJ1ZSxcbiAgICByZXRyeUJ1ZGdldDogMTAwMDAsXG4gICAgcmV0cnlhYmxlU3RhdHVzQ29kZXM6IFs0MDgsIDQyOSwgNTAwLCA1MDIsIDUwMywgNTA0XSxcbiAgICByZXRyeWFibGVFcnJvcnM6IFsnRUNPTk5SRVNFVCcsICdFVElNRURPVVQnLCAnRU5PVEZPVU5EJ10sXG59O1xuY2xhc3MgUmVxdWVzdFJldHJ5U3RyYXRlZ3kge1xuICAgIGNvbmZpZztcbiAgICBuZXR3b3JrQ29uZGl0aW9uID0gJ2V4Y2VsbGVudCc7XG4gICAgY29uc3RydWN0b3IoY29uZmlnID0ge30pIHtcbiAgICAgICAgdGhpcy5jb25maWcgPSB7IC4uLkRFRkFVTFRfQ09ORklHLCAuLi5jb25maWcgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSBmdW5jdGlvbiB3aXRoIHJldHJ5IGxvZ2ljXG4gICAgICovXG4gICAgYXN5bmMgZXhlY3V0ZShmbiwgZXJyb3JIYW5kbGVyKSB7XG4gICAgICAgIGxldCBsYXN0RXJyb3I7XG4gICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICAgIGZvciAobGV0IGF0dGVtcHQgPSAwOyBhdHRlbXB0IDw9IHRoaXMuY29uZmlnLm1heFJldHJpZXM7IGF0dGVtcHQrKykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmbigpO1xuICAgICAgICAgICAgICAgIGlmIChhdHRlbXB0ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXJfMS5sb2dnZXIuaW5mbygnUmVxdWVzdCBzdWNjZWVkZWQgYWZ0ZXIgcmV0cnknLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRlbXB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgYXR0ZW1wdHM6IGF0dGVtcHQgKyAxLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGxhc3RFcnJvciA9IGVycm9yO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVsYXBzZWRUaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBlcnJvciBpcyByZXRyeWFibGVcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNSZXRyeWFibGUoZXJyb3IsIGF0dGVtcHQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlcl8xLmxvZ2dlci5kZWJ1ZygnRXJyb3Igbm90IHJldHJ5YWJsZScsIHsgZXJyb3IsIGF0dGVtcHQgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBDaGVjayByZXRyeSBidWRnZXRcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb25maWcucmV0cnlCdWRnZXQgJiYgZWxhcHNlZFRpbWUgPj0gdGhpcy5jb25maWcucmV0cnlCdWRnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyXzEubG9nZ2VyLndhcm4oJ1JldHJ5IGJ1ZGdldCBleGNlZWRlZCcsIHsgZWxhcHNlZFRpbWUsIGJ1ZGdldDogdGhpcy5jb25maWcucmV0cnlCdWRnZXQgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB3ZSBzaG91bGQgcmV0cnkgYmFzZWQgb24gY3VzdG9tIGhhbmRsZXJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3JIYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldHJ5Q29udGV4dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dGVtcHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dGVtcHRzOiBhdHRlbXB0ICsgMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGF5OiB0aGlzLmNhbGN1bGF0ZURlbGF5KGF0dGVtcHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWxhcHNlZFRpbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZWFzb246IHRoaXMuZ2V0RXJyb3JSZWFzb24oZXJyb3IpLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9ySGFuZGxlcihlcnJvciwgcmV0cnlDb250ZXh0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgZGVsYXkgb24gbGFzdCBhdHRlbXB0XG4gICAgICAgICAgICAgICAgaWYgKGF0dGVtcHQgPCB0aGlzLmNvbmZpZy5tYXhSZXRyaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlbGF5ID0gdGhpcy5jYWxjdWxhdGVEZWxheShhdHRlbXB0KTtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyXzEubG9nZ2VyLmRlYnVnKCdSZXRyeWluZyByZXF1ZXN0Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0ZW1wdDogYXR0ZW1wdCArIDEsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhSZXRyaWVzOiB0aGlzLmNvbmZpZy5tYXhSZXRyaWVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsYXksXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNsZWVwKGRlbGF5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gQWxsIHJldHJpZXMgZmFpbGVkXG4gICAgICAgIGxvZ2dlcl8xLmxvZ2dlci5lcnJvcignUmVxdWVzdCBmYWlsZWQgYWZ0ZXIgYWxsIHJldHJpZXMnLCB7XG4gICAgICAgICAgICBhdHRlbXB0czogdGhpcy5jb25maWcubWF4UmV0cmllcyArIDEsXG4gICAgICAgICAgICBsYXN0RXJyb3IsXG4gICAgICAgIH0pO1xuICAgICAgICB0aHJvdyBsYXN0RXJyb3I7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGVycm9yIGlzIHJldHJ5YWJsZVxuICAgICAqL1xuICAgIGlzUmV0cnlhYmxlKGVycm9yLCBhdHRlbXB0KSB7XG4gICAgICAgIGlmIChhdHRlbXB0ID49IHRoaXMuY29uZmlnLm1heFJldHJpZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBDaGVjayBpZiBlcnJvciBpcyBpbiByZXRyeWFibGUgZXJyb3JzIGxpc3RcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuICAgICAgICBpZiAodGhpcy5jb25maWcucmV0cnlhYmxlRXJyb3JzPy5zb21lKGNvZGUgPT4gZXJyb3JNZXNzYWdlLmluY2x1ZGVzKGNvZGUpKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2hlY2sgSFRUUCBzdGF0dXMgY29kZXNcbiAgICAgICAgaWYgKHRoaXMuaXNIdHRwRXJyb3IoZXJyb3IpKSB7XG4gICAgICAgICAgICBjb25zdCBzdGF0dXNDb2RlID0gdGhpcy5nZXRIdHRwU3RhdHVzQ29kZShlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb25maWcucmV0cnlhYmxlU3RhdHVzQ29kZXM/LmluY2x1ZGVzKHN0YXR1c0NvZGUpID8/IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIC8vIERlZmF1bHQgdG8gcmV0cnlhYmxlIGZvciBuZXR3b3JrIGVycm9yc1xuICAgICAgICByZXR1cm4gdGhpcy5pc05ldHdvcmtFcnJvcihlcnJvcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGN1bGF0ZSBkZWxheSBiYXNlZCBvbiBzdHJhdGVneVxuICAgICAqL1xuICAgIGNhbGN1bGF0ZURlbGF5KGF0dGVtcHQpIHtcbiAgICAgICAgbGV0IGRlbGF5O1xuICAgICAgICBzd2l0Y2ggKHRoaXMuY29uZmlnLnN0cmF0ZWd5KSB7XG4gICAgICAgICAgICBjYXNlICdleHBvbmVudGlhbCc6XG4gICAgICAgICAgICAgICAgZGVsYXkgPSBNYXRoLm1pbih0aGlzLmNvbmZpZy5iYXNlRGVsYXkgKiBNYXRoLnBvdygyLCBhdHRlbXB0KSwgdGhpcy5jb25maWcubWF4RGVsYXkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbGluZWFyJzpcbiAgICAgICAgICAgICAgICBkZWxheSA9IE1hdGgubWluKHRoaXMuY29uZmlnLmJhc2VEZWxheSAqIChhdHRlbXB0ICsgMSksIHRoaXMuY29uZmlnLm1heERlbGF5KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2ZpeGVkJzpcbiAgICAgICAgICAgICAgICBkZWxheSA9IHRoaXMuY29uZmlnLmJhc2VEZWxheTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ25vbmUnOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICAvLyBBcHBseSBqaXR0ZXJcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmppdHRlcikge1xuICAgICAgICAgICAgY29uc3Qgaml0dGVyQW1vdW50ID0gZGVsYXkgKiAwLjE7IC8vIDEwJSBqaXR0ZXJcbiAgICAgICAgICAgIGRlbGF5ICs9IE1hdGgucmFuZG9tKCkgKiBqaXR0ZXJBbW91bnQgKiAyIC0gaml0dGVyQW1vdW50O1xuICAgICAgICB9XG4gICAgICAgIC8vIEFkanVzdCBiYXNlZCBvbiBuZXR3b3JrIGNvbmRpdGlvblxuICAgICAgICBkZWxheSA9IHRoaXMuYWRqdXN0Rm9yTmV0d29ya0NvbmRpdGlvbihkZWxheSk7XG4gICAgICAgIHJldHVybiBNYXRoLm1heCgwLCBNYXRoLmZsb29yKGRlbGF5KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkanVzdCBkZWxheSBiYXNlZCBvbiBuZXR3b3JrIGNvbmRpdGlvblxuICAgICAqL1xuICAgIGFkanVzdEZvck5ldHdvcmtDb25kaXRpb24oZGVsYXkpIHtcbiAgICAgICAgY29uc3QgbXVsdGlwbGllcnMgPSB7XG4gICAgICAgICAgICBleGNlbGxlbnQ6IDEuMCxcbiAgICAgICAgICAgIGdvb2Q6IDEuMixcbiAgICAgICAgICAgIGZhaXI6IDEuNSxcbiAgICAgICAgICAgIHBvb3I6IDIuMCxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGRlbGF5ICogbXVsdGlwbGllcnNbdGhpcy5uZXR3b3JrQ29uZGl0aW9uXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlIG5ldHdvcmsgY29uZGl0aW9uXG4gICAgICovXG4gICAgdXBkYXRlTmV0d29ya0NvbmRpdGlvbihjb25kaXRpb24pIHtcbiAgICAgICAgdGhpcy5uZXR3b3JrQ29uZGl0aW9uID0gY29uZGl0aW9uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZSBpZGVtcG90ZW5jeSBrZXlcbiAgICAgKi9cbiAgICBnZW5lcmF0ZUlkZW1wb3RlbmN5S2V5KGVuZHBvaW50LCBkYXRhKSB7XG4gICAgICAgIGNvbnN0IGRhdGFIYXNoID0gZGF0YSA/IHRoaXMuaGFzaERhdGEoZGF0YSkgOiAnJztcbiAgICAgICAgcmV0dXJuIGAke2VuZHBvaW50fV8ke0RhdGUubm93KCl9XyR7ZGF0YUhhc2h9YDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSGFzaCBkYXRhIGZvciBpZGVtcG90ZW5jeSBrZXlcbiAgICAgKi9cbiAgICBoYXNoRGF0YShkYXRhKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBqc29uID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG4gICAgICAgICAgICAvLyBTaW1wbGUgaGFzaCBmdW5jdGlvblxuICAgICAgICAgICAgbGV0IGhhc2ggPSAwO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBqc29uLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2hhciA9IGpzb24uY2hhckNvZGVBdChpKTtcbiAgICAgICAgICAgICAgICBoYXNoID0gKChoYXNoIDw8IDUpIC0gaGFzaCkgKyBjaGFyO1xuICAgICAgICAgICAgICAgIGhhc2ggPSBoYXNoICYgaGFzaDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBNYXRoLmFicyhoYXNoKS50b1N0cmluZygzNik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCAxMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2xlZXAgZm9yIHNwZWNpZmllZCBtaWxsaXNlY29uZHNcbiAgICAgKi9cbiAgICBzbGVlcChtcykge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGVycm9yIGlzIG5ldHdvcmsgZXJyb3JcbiAgICAgKi9cbiAgICBpc05ldHdvcmtFcnJvcihlcnJvcikge1xuICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ25ldHdvcmsnKSB8fFxuICAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ3RpbWVvdXQnKSB8fFxuICAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0VDT05OUkVGVVNFRCcpIHx8XG4gICAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnRVRJTUVET1VUJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBlcnJvciBpcyBIVFRQIGVycm9yXG4gICAgICovXG4gICAgaXNIdHRwRXJyb3IoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBlcnJvciA9PT0gJ29iamVjdCcgJiYgZXJyb3IgIT09IG51bGwgJiYgJ3N0YXR1cycgaW4gZXJyb3I7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBIVFRQIHN0YXR1cyBjb2RlIGZyb20gZXJyb3JcbiAgICAgKi9cbiAgICBnZXRIdHRwU3RhdHVzQ29kZShlcnJvcikge1xuICAgICAgICBpZiAodGhpcy5pc0h0dHBFcnJvcihlcnJvcikpIHtcbiAgICAgICAgICAgIHJldHVybiBlcnJvci5zdGF0dXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCByZWFzb24gZm9yIGVycm9yXG4gICAgICovXG4gICAgZ2V0RXJyb3JSZWFzb24oZXJyb3IpIHtcbiAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBlcnJvci5tZXNzYWdlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBTdHJpbmcoZXJyb3IpO1xuICAgIH1cbn1cbmV4cG9ydHMu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