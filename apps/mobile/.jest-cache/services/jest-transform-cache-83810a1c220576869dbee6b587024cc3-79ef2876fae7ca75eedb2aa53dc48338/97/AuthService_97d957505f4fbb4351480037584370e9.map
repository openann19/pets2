{"version":3,"names":["SecureStore","_interopRequireWildcard","require","LocalAuthentication","Keychain","_core","_api","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","_t2","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_callSuper","_getPrototypeOf2","_possibleConstructorReturn2","_isNativeReflectConstruct","Reflect","construct","constructor","apply","Boolean","prototype","valueOf","ownKeys","keys","getOwnPropertySymbols","filter","enumerable","push","_objectSpread","arguments","length","forEach","_defineProperty2","getOwnPropertyDescriptors","defineProperties","AuthService","_classCallCheck2","sessionCheckInterval","useKeychain","startSessionMonitoring","_createClass2","key","value","_this","clearInterval","setInterval","checkSessionValidity","_checkSessionValidity","_asyncToGenerator2","isAuthenticated","stopSessionMonitoring","sessionStart","getSessionStartTime","lastActivity","getLastActivityTime","now","Date","SESSION_TIMEOUT","logger","info","logout","ACTIVITY_TIMEOUT","updateLastActivityTime","error","_getSessionStartTime","startTime","secureGetItemAsync","SESSION_START_KEY","parseInt","_getLastActivityTime","LAST_ACTIVITY_KEY","_updateLastActivityTime","secureSetItemAsync","toString","_recordUserActivity","recordUserActivity","_rotateTokens","refreshToken","getRefreshToken","response","api","request","method","body","JSON","stringify","storeAuthData","rotateTokens","_isBiometricAvailable","hasHardware","hasHardwareAsync","isEnrolled","isEnrolledAsync","supportedTypes","supportedAuthenticationTypesAsync","available","types","isBiometricAvailable","_enableBiometricAuthentication","_yield$this$isBiometr","AuthError","biometricAuth","authenticateAsync","promptMessage","fallbackLabel","cancelLabel","disableDeviceFallback","success","BIOMETRIC_ENABLED_KEY","currentUser","getCurrentUser","biometricCredentials","email","biometricToken","Math","random","BIOMETRIC_CREDENTIALS_KEY","enableBiometricAuthentication","_disableBiometricAuthentication","secureDeleteItemAsync","disableBiometricAuthentication","_isBiometricEnabled","enabled","isBiometricEnabled","_loginWithBiometrics","isEnabled","_yield$this$isBiometr2","storedCredentials","credentials","parse","userId","user","id","loginWithBiometrics","_login","login","_x","_register","data","password","confirmPassword","registerData","name","register","_x2","_logout","warn","clearAuthData","_refreshToken","_forgotPassword","forgotPassword","_x3","_resetPassword","resetData","token","resetPassword","_x4","_getCurrentUser","userData","USER_KEY","_getAccessToken","ACCESS_TOKEN_KEY","getAccessToken","_isAuthenticated","_updateUser","updatedUser","updateUser","_x5","_secureSetItemAsync","includes","result","setGenericPassword","service","accessControl","ACCESS_CONTROL","BIOMETRY_ANY_OR_DEVICE_PASSCODE","accessible","ACCESSIBLE","WHEN_UNLOCKED_THIS_DEVICE_ONLY","Error","setItemAsync","keychainAccessible","AFTER_FIRST_UNLOCK_THIS_DEVICE_ONLY","keychainError","_x6","_x7","_secureGetItemAsync","refKey","storageLocation","getItemAsync","getGenericPassword","_x8","_secureDeleteItemAsync","resetGenericPassword","deleteItemAsync","_x9","_storeAuthData","Promise","all","accessToken","REFRESH_TOKEN_KEY","_x0","_clearAuthData","_getRefreshToken","SERVICE_NAME","exports","_Error","message","originalError","_this2","_inherits2","_wrapNativeSuper2","authService","_default"],"sources":["AuthService.ts"],"sourcesContent":["/**\n * Authentication Service for PawfectMatch Mobile App\n * Handles user authentication, token management, and secure storage\n * Uses react-native-keychain for production-grade security\n */\nimport * as SecureStore from \"expo-secure-store\";\nimport * as LocalAuthentication from \"expo-local-authentication\";\nimport * as Keychain from \"react-native-keychain\";\nimport { logger } from \"@pawfectmatch/core\";\nimport { api } from \"./api\";\n\n// Types for authentication\nexport interface LoginCredentials {\n  email: string;\n  password: string;\n}\n\nexport interface AuthResponse {\n  user: {\n    id: string;\n    email: string;\n    name: string;\n    profileComplete: boolean;\n    subscriptionStatus: string;\n    createdAt: string;\n  };\n  accessToken: string;\n  refreshToken: string;\n  expiresIn: number;\n}\n\nexport interface RegisterData {\n  email: string;\n  password: string;\n  name: string;\n  confirmPassword: string;\n}\n\nexport interface ResetPasswordData {\n  token: string;\n  password: string;\n  confirmPassword: string;\n}\n\nexport interface User {\n  id: string;\n  email: string;\n  name: string;\n  profileComplete: boolean;\n  subscriptionStatus: string;\n  createdAt: string;\n}\n\nexport interface BiometricCredentials {\n  email: string;\n  biometricToken: string;\n}\n\nclass AuthService {\n  private static readonly ACCESS_TOKEN_KEY = \"auth_access_token\";\n  private static readonly REFRESH_TOKEN_KEY = \"auth_refresh_token\";\n  private static readonly USER_KEY = \"auth_user\";\n  private static readonly BIOMETRIC_ENABLED_KEY = \"biometric_enabled\";\n  private static readonly BIOMETRIC_CREDENTIALS_KEY = \"biometric_credentials\";\n  private static readonly SESSION_START_KEY = \"session_start_time\";\n  private static readonly LAST_ACTIVITY_KEY = \"last_activity_time\";\n  private static readonly SERVICE_NAME = \"com.pawfectmatch.mobile\";\n\n  // Session configuration\n  private static readonly SESSION_TIMEOUT = 24 * 60 * 60 * 1000; // 24 hours\n  private static readonly ACTIVITY_TIMEOUT = 30 * 60 * 1000; // 30 minutes of inactivity\n  private sessionCheckInterval: ReturnType<typeof setInterval> | null = null;\n  private useKeychain: boolean = true; // Use Keychain by default for production security\n\n  constructor() {\n    this.startSessionMonitoring();\n  }\n\n  // ===== Session Management =====\n\n  /**\n   * Start session monitoring for auto-logout\n   */\n  private startSessionMonitoring(): void {\n    // Clear any existing interval\n    if (this.sessionCheckInterval) {\n      clearInterval(this.sessionCheckInterval);\n    }\n\n    // Check session every minute\n    this.sessionCheckInterval = setInterval(() => {\n      void this.checkSessionValidity();\n    }, 60000); // Check every minute\n  }\n\n  /**\n   * Check if current session is still valid\n   */\n  private async checkSessionValidity(): Promise<void> {\n    try {\n      const isAuthenticated = await this.isAuthenticated();\n      if (!isAuthenticated) {\n        this.stopSessionMonitoring();\n        return;\n      }\n\n      const sessionStart = await this.getSessionStartTime();\n      const lastActivity = await this.getLastActivityTime();\n      const now = Date.now();\n\n      // Check session timeout (24 hours)\n      if (sessionStart && now - sessionStart > AuthService.SESSION_TIMEOUT) {\n        logger.info(\"Session expired due to timeout\");\n        await this.logout();\n        return;\n      }\n\n      // Check activity timeout (30 minutes)\n      if (lastActivity && now - lastActivity > AuthService.ACTIVITY_TIMEOUT) {\n        logger.info(\"Session expired due to inactivity\");\n        await this.logout();\n        return;\n      }\n\n      // Update last activity time\n      await this.updateLastActivityTime();\n    } catch (error) {\n      logger.error(\"Session validity check failed\", { error });\n    }\n  }\n\n  /**\n   * Stop session monitoring\n   */\n  private stopSessionMonitoring(): void {\n    if (this.sessionCheckInterval) {\n      clearInterval(this.sessionCheckInterval);\n      this.sessionCheckInterval = null;\n    }\n  }\n\n  /**\n   * Get session start time\n   */\n  private async getSessionStartTime(): Promise<number | null> {\n    try {\n      const startTime = await this.secureGetItemAsync(\n        AuthService.SESSION_START_KEY,\n      );\n      return startTime ? parseInt(startTime) : null;\n    } catch (error) {\n      logger.error(\"Failed to get session start time\", { error });\n      return null;\n    }\n  }\n\n  /**\n   * Get last activity time\n   */\n  private async getLastActivityTime(): Promise<number | null> {\n    try {\n      const lastActivity = await this.secureGetItemAsync(\n        AuthService.LAST_ACTIVITY_KEY,\n      );\n      return lastActivity ? parseInt(lastActivity) : null;\n    } catch (error) {\n      logger.error(\"Failed to get last activity time\", { error });\n      return null;\n    }\n  }\n\n  /**\n   * Update last activity time\n   */\n  private async updateLastActivityTime(): Promise<void> {\n    try {\n      await this.secureSetItemAsync(\n        AuthService.LAST_ACTIVITY_KEY,\n        Date.now().toString(),\n      );\n    } catch (error) {\n      logger.error(\"Failed to update last activity time\", { error });\n    }\n  }\n\n  /**\n   * Record user activity to prevent auto-logout\n   */\n  async recordUserActivity(): Promise<void> {\n    await this.updateLastActivityTime();\n  }\n\n  /**\n   * Force refresh token rotation\n   */\n  async rotateTokens(): Promise<boolean> {\n    try {\n      const refreshToken = await this.getRefreshToken();\n      if (!refreshToken) {\n        return false;\n      }\n\n      // Call refresh endpoint to get new tokens\n      const response = await api.request<AuthResponse>(\"/auth/refresh-token\", {\n        method: \"POST\",\n        body: JSON.stringify({ refreshToken }),\n      });\n\n      // Store new tokens\n      await this.storeAuthData(response);\n\n      // Update session start time for new session\n      await this.secureSetItemAsync(\n        AuthService.SESSION_START_KEY,\n        Date.now().toString(),\n      );\n\n      logger.info(\"Tokens rotated successfully\");\n      return true;\n    } catch (error) {\n      logger.error(\"Token rotation failed\", { error });\n      // If rotation fails, logout user\n      await this.logout();\n      return false;\n    }\n  }\n\n  /**\n   * Check if biometric authentication is available on device\n   */\n  async isBiometricAvailable(): Promise<{\n    available: boolean;\n    types: LocalAuthentication.AuthenticationType[];\n  }> {\n    try {\n      const hasHardware = await LocalAuthentication.hasHardwareAsync();\n      const isEnrolled = await LocalAuthentication.isEnrolledAsync();\n      const supportedTypes =\n        await LocalAuthentication.supportedAuthenticationTypesAsync();\n\n      return {\n        available: hasHardware && isEnrolled,\n        types: supportedTypes,\n      };\n    } catch (error) {\n      logger.error(\"Failed to check biometric availability\", { error });\n      return { available: false, types: [] };\n    }\n  }\n\n  /**\n   * Enable biometric authentication for current user\n   */\n  async enableBiometricAuthentication(): Promise<boolean> {\n    try {\n      const { available } = await this.isBiometricAvailable();\n      if (!available) {\n        throw new AuthError(\n          \"Biometric authentication is not available on this device\",\n        );\n      }\n\n      // Authenticate user with biometrics to enable feature\n      const biometricAuth = await LocalAuthentication.authenticateAsync({\n        promptMessage: \"Authenticate to enable biometric login\",\n        fallbackLabel: \"Use PIN\",\n        cancelLabel: \"Cancel\",\n        disableDeviceFallback: false,\n      });\n\n      if (!biometricAuth.success) {\n        throw new AuthError(\"Biometric authentication failed\");\n      }\n\n      // Store biometric preference\n      await this.secureSetItemAsync(AuthService.BIOMETRIC_ENABLED_KEY, \"true\");\n\n      // Get current user credentials for biometric storage\n      const currentUser = await this.getCurrentUser();\n      if (currentUser) {\n        const biometricCredentials: BiometricCredentials = {\n          email: currentUser.email,\n          biometricToken: Date.now().toString() + Math.random().toString(36),\n        };\n\n        await this.secureSetItemAsync(\n          AuthService.BIOMETRIC_CREDENTIALS_KEY,\n          JSON.stringify(biometricCredentials),\n        );\n      }\n\n      logger.info(\"Biometric authentication enabled\");\n      return true;\n    } catch (error) {\n      logger.error(\"Failed to enable biometric authentication\", { error });\n      throw new AuthError(\"Failed to enable biometric authentication\", error);\n    }\n  }\n\n  /**\n   * Disable biometric authentication\n   */\n  async disableBiometricAuthentication(): Promise<void> {\n    try {\n      await this.secureDeleteItemAsync(AuthService.BIOMETRIC_ENABLED_KEY);\n      await this.secureDeleteItemAsync(AuthService.BIOMETRIC_CREDENTIALS_KEY);\n      logger.info(\"Biometric authentication disabled\");\n    } catch (error) {\n      logger.error(\"Failed to disable biometric authentication\", { error });\n      throw new AuthError(\"Failed to disable biometric authentication\", error);\n    }\n  }\n\n  /**\n   * Check if biometric authentication is enabled\n   */\n  async isBiometricEnabled(): Promise<boolean> {\n    try {\n      const enabled = await this.secureGetItemAsync(\n        AuthService.BIOMETRIC_ENABLED_KEY,\n      );\n      return enabled === \"true\";\n    } catch (error) {\n      logger.error(\"Failed to check biometric status\", { error });\n      return false;\n    }\n  }\n\n  /**\n   * Login with biometrics (if enabled)\n   */\n  async loginWithBiometrics(): Promise<AuthResponse> {\n    try {\n      const isEnabled = await this.isBiometricEnabled();\n      if (!isEnabled) {\n        throw new AuthError(\"Biometric authentication is not enabled\");\n      }\n\n      const { available } = await this.isBiometricAvailable();\n      if (!available) {\n        throw new AuthError(\"Biometric authentication is not available\");\n      }\n\n      // Perform biometric authentication\n      const biometricAuth = await LocalAuthentication.authenticateAsync({\n        promptMessage: \"Authenticate to login\",\n        fallbackLabel: \"Use PIN\",\n        cancelLabel: \"Cancel\",\n        disableDeviceFallback: false,\n      });\n\n      if (!biometricAuth.success) {\n        throw new AuthError(\"Biometric authentication failed\");\n      }\n\n      // Get stored biometric credentials\n      const storedCredentials = await this.secureGetItemAsync(\n        AuthService.BIOMETRIC_CREDENTIALS_KEY,\n      );\n      if (!storedCredentials) {\n        throw new AuthError(\"No biometric credentials found\");\n      }\n\n      const credentials = JSON.parse(storedCredentials) as BiometricCredentials;\n\n      // Perform login with stored email and a special biometric flag\n      const response = await api.request<AuthResponse>(\n        \"/auth/biometric-login\",\n        {\n          method: \"POST\",\n          body: JSON.stringify({\n            email: credentials.email,\n            biometricToken: credentials.biometricToken,\n          }),\n        },\n      );\n\n      // Store authentication data securely\n      await this.storeAuthData(response);\n\n      logger.info(\"User logged in with biometrics\", {\n        userId: response.user.id,\n      });\n      return response;\n    } catch (error) {\n      logger.error(\"Biometric login failed\", { error });\n      throw new AuthError(\n        \"Biometric login failed. Please use email and password.\",\n        error,\n      );\n    }\n  }\n\n  /**\n   * Login user with email and password\n   */\n  async login(credentials: LoginCredentials): Promise<AuthResponse> {\n    try {\n      const response = await api.request<AuthResponse>(\"/auth/login\", {\n        method: \"POST\",\n        body: JSON.stringify(credentials),\n      });\n\n      // Store authentication data securely\n      await this.storeAuthData(response);\n\n      logger.info(\"User logged in successfully\", { userId: response.user.id });\n      return response;\n    } catch (error) {\n      logger.error(\"Login failed\", { error, email: credentials.email });\n      throw new AuthError(\n        \"Login failed. Please check your credentials and try again.\",\n        error,\n      );\n    }\n  }\n\n  /**\n   * Register new user account\n   */\n  async register(data: RegisterData): Promise<AuthResponse> {\n    try {\n      // Validate password confirmation\n      if (data.password !== data.confirmPassword) {\n        throw new AuthError(\"Passwords do not match\");\n      }\n\n      const registerData = {\n        email: data.email,\n        password: data.password,\n        name: data.name,\n      };\n      const response = await api.request<AuthResponse>(\"/auth/register\", {\n        method: \"POST\",\n        body: JSON.stringify(registerData),\n      });\n\n      // Store authentication data securely\n      await this.storeAuthData(response);\n\n      logger.info(\"User registered successfully\", { userId: response.user.id });\n      return response;\n    } catch (error) {\n      logger.error(\"Registration failed\", { error, email: data.email });\n      throw new AuthError(\"Registration failed. Please try again.\", error);\n    }\n  }\n\n  /**\n   * Logout user and clear stored data\n   */\n  async logout(): Promise<void> {\n    try {\n      const refreshToken = await this.getRefreshToken();\n      if (refreshToken) {\n        // Notify server about logout (optional)\n        try {\n          await api.request(\"/auth/logout\", {\n            method: \"POST\",\n            body: JSON.stringify({ refreshToken }),\n          });\n        } catch (error) {\n          // Ignore server logout errors\n          logger.warn(\"Server logout failed, continuing with local logout\", {\n            error,\n          });\n        }\n      }\n\n      // Clear all stored auth data\n      await this.clearAuthData();\n      logger.info(\"User logged out successfully\");\n    } catch (error) {\n      logger.error(\"Logout failed\", { error });\n      // Even if logout fails, clear local data\n      await this.clearAuthData();\n    }\n  }\n\n  /**\n   * Refresh access token using refresh token\n   */\n  async refreshToken(): Promise<AuthResponse | null> {\n    try {\n      const refreshToken = await this.getRefreshToken();\n      if (!refreshToken) {\n        return null;\n      }\n\n      const response = await api.request<AuthResponse>(\"/auth/refresh\", {\n        method: \"POST\",\n        body: JSON.stringify({ refreshToken }),\n      });\n\n      // Store new tokens\n      await this.storeAuthData(response);\n      return response;\n    } catch (error) {\n      logger.error(\"Token refresh failed\", { error });\n      // Clear invalid tokens\n      await this.clearAuthData();\n      return null;\n    }\n  }\n\n  /**\n   * Request password reset\n   */\n  async forgotPassword(\n    email: string,\n  ): Promise<{ success: boolean; message: string }> {\n    try {\n      const response = await api.request<{ success: boolean; message: string }>(\n        \"/auth/forgot-password\",\n        {\n          method: \"POST\",\n          body: JSON.stringify({ email }),\n        },\n      );\n\n      logger.info(\"Password reset requested\", { email });\n      return response;\n    } catch (error) {\n      logger.error(\"Forgot password failed\", { error, email });\n      throw new AuthError(\n        \"Failed to send password reset email. Please try again.\",\n        error,\n      );\n    }\n  }\n\n  /**\n   * Reset password with token\n   */\n  async resetPassword(\n    data: ResetPasswordData,\n  ): Promise<{ success: boolean; message: string }> {\n    try {\n      if (data.password !== data.confirmPassword) {\n        throw new AuthError(\"Passwords do not match\");\n      }\n\n      const resetData = {\n        token: data.token,\n        password: data.password,\n      };\n      const response = await api.request<{ success: boolean; message: string }>(\n        \"/auth/reset-password\",\n        {\n          method: \"POST\",\n          body: JSON.stringify(resetData),\n        },\n      );\n\n      logger.info(\"Password reset successful\");\n      return response;\n    } catch (error) {\n      logger.error(\"Password reset failed\", { error });\n      throw new AuthError(\"Failed to reset password. Please try again.\", error);\n    }\n  }\n\n  /**\n   * Get current authenticated user\n   */\n  async getCurrentUser(): Promise<User | null> {\n    try {\n      const userData = await this.secureGetItemAsync(AuthService.USER_KEY);\n      return userData ? (JSON.parse(userData) as User) : null;\n    } catch (error) {\n      logger.error(\"Failed to get current user\", { error });\n      return null;\n    }\n  }\n\n  /**\n   * Get stored access token\n   */\n  async getAccessToken(): Promise<string | null> {\n    try {\n      return await this.secureGetItemAsync(AuthService.ACCESS_TOKEN_KEY);\n    } catch (error) {\n      logger.error(\"Failed to get access token\", { error });\n      return null;\n    }\n  }\n\n  /**\n   * Check if user is authenticated\n   */\n  async isAuthenticated(): Promise<boolean> {\n    try {\n      const token = await this.getAccessToken();\n      const user = await this.getCurrentUser();\n      return !!(token && user);\n    } catch (error) {\n      logger.error(\"Authentication check failed\", { error });\n      return false;\n    }\n  }\n\n  /**\n   * Update user profile data\n   */\n  async updateUser(userData: Partial<User>): Promise<void> {\n    try {\n      const currentUser = await this.getCurrentUser();\n      if (!currentUser) {\n        throw new AuthError(\"No authenticated user found\");\n      }\n\n      const updatedUser = { ...currentUser, ...userData };\n      await this.secureSetItemAsync(\n        AuthService.USER_KEY,\n        JSON.stringify(updatedUser),\n      );\n      logger.info(\"User data updated\", { userId: updatedUser.id });\n    } catch (error) {\n      logger.error(\"Failed to update user data\", { error });\n      throw new AuthError(\"Failed to update user data\", error);\n    }\n  }\n\n  // Secure storage methods - Keychain for sensitive data, SecureStore for session data\n  // Fallback to SecureStore if Keychain fails for robustness\n  private async secureSetItemAsync(key: string, value: string): Promise<void> {\n    try {\n      // Use Keychain for sensitive authentication data\n      if (key.includes('token') || key.includes('user')) {\n        try {\n          const result = await Keychain.setGenericPassword('pawfectmatch', value, {\n            service: 'pawfectmatch-auth',\n            accessControl: Keychain.ACCESS_CONTROL.BIOMETRY_ANY_OR_DEVICE_PASSCODE,\n            accessible: Keychain.ACCESSIBLE.WHEN_UNLOCKED_THIS_DEVICE_ONLY,\n          });\n          if (result === false) {\n            throw new Error('Failed to store in Keychain');\n          }\n          // Store a reference key in SecureStore for retrieval\n          await SecureStore.setItemAsync(`${key}_ref`, 'keychain', {\n            keychainAccessible: SecureStore.AFTER_FIRST_UNLOCK_THIS_DEVICE_ONLY,\n          });\n          // Successfully stored in Keychain\n          return;\n        } catch (keychainError) {\n          // Fallback to SecureStore if Keychain fails\n          logger.warn(`Keychain failed, falling back to SecureStore for ${key}`, { error: keychainError });\n          await SecureStore.setItemAsync(key, value, {\n            keychainAccessible: SecureStore.AFTER_FIRST_UNLOCK_THIS_DEVICE_ONLY,\n          });\n          // Store a reference indicating fallback to SecureStore\n          await SecureStore.setItemAsync(`${key}_ref`, 'securestore', {\n            keychainAccessible: SecureStore.AFTER_FIRST_UNLOCK_THIS_DEVICE_ONLY,\n          });\n        }\n      } else {\n        // Use SecureStore for less sensitive session data\n        await SecureStore.setItemAsync(key, value, {\n          keychainAccessible: SecureStore.AFTER_FIRST_UNLOCK_THIS_DEVICE_ONLY,\n        });\n      }\n    } catch (error) {\n      logger.error(`Failed to securely store ${key}`, { error });\n      throw new AuthError(`Failed to securely store authentication data`, error);\n    }\n  }\n\n  private async secureGetItemAsync(key: string): Promise<string | null> {\n    try {\n      // Check if data is stored in Keychain or SecureStore (fallback)\n      const refKey = `${key}_ref`;\n      const storageLocation = await SecureStore.getItemAsync(refKey);\n\n      if (storageLocation === 'keychain') {\n        try {\n          const credentials = await Keychain.getGenericPassword({\n            service: 'pawfectmatch-auth',\n          });\n          if (credentials) {\n            // Return the password (which contains our stored value)\n            return credentials.password;\n          }\n          return null;\n        } catch (keychainError) {\n          // If Keychain retrieval fails, try SecureStore fallback\n          logger.warn(`Keychain retrieval failed, trying SecureStore fallback for ${key}`, { error: keychainError });\n          return await SecureStore.getItemAsync(key);\n        }\n      } else if (storageLocation === 'securestore') {\n        // Data was stored in SecureStore due to Keychain failure\n        return await SecureStore.getItemAsync(key);\n      } else {\n        // No reference found, try SecureStore directly (for non-sensitive keys)\n        return await SecureStore.getItemAsync(key);\n      }\n    } catch (error) {\n      logger.error(`Failed to securely retrieve ${key}`, { error });\n      return null;\n    }\n  }\n\n  private async secureDeleteItemAsync(key: string): Promise<void> {\n    try {\n      // Check if data is stored in Keychain or SecureStore (fallback)\n      const refKey = `${key}_ref`;\n      const storageLocation = await SecureStore.getItemAsync(refKey);\n\n      if (storageLocation === 'keychain') {\n        try {\n          // Reset Keychain credentials\n          await Keychain.resetGenericPassword({\n            service: 'pawfectmatch-auth',\n          });\n        } catch (keychainError) {\n          logger.warn(`Keychain deletion failed, continuing with cleanup`, { error: keychainError });\n        }\n        // Remove the reference\n        await SecureStore.deleteItemAsync(refKey);\n      } else if (storageLocation === 'securestore') {\n        // Data was stored in SecureStore\n        await SecureStore.deleteItemAsync(key);\n        // Remove the reference\n        await SecureStore.deleteItemAsync(refKey);\n      } else {\n        // Try to delete from SecureStore (for non-sensitive keys or cleanup)\n        try {\n          await SecureStore.deleteItemAsync(key);\n        } catch (error) {\n          // Silently ignore deletion errors\n        }\n      }\n    } catch (error) {\n      logger.error(`Failed to securely delete ${key}`, { error });\n      // Don't throw here as this is cleanup\n    }\n  }\n\n  // Private helper methods\n\n  private async storeAuthData(response: AuthResponse): Promise<void> {\n    try {\n      await Promise.all([\n        this.secureSetItemAsync(\n          AuthService.ACCESS_TOKEN_KEY,\n          response.accessToken,\n        ),\n        this.secureSetItemAsync(\n          AuthService.REFRESH_TOKEN_KEY,\n          response.refreshToken,\n        ),\n        this.secureSetItemAsync(\n          AuthService.USER_KEY,\n          JSON.stringify(response.user),\n        ),\n        this.secureSetItemAsync(\n          AuthService.SESSION_START_KEY,\n          Date.now().toString(),\n        ),\n        this.secureSetItemAsync(\n          AuthService.LAST_ACTIVITY_KEY,\n          Date.now().toString(),\n        ),\n      ]);\n\n      // Start session monitoring\n      this.startSessionMonitoring();\n    } catch (error) {\n      logger.error(\"Failed to store auth data\", { error });\n      throw new AuthError(\"Failed to save authentication data\", error);\n    }\n  }\n\n  private async clearAuthData(): Promise<void> {\n    try {\n      await Promise.all([\n        this.secureDeleteItemAsync(AuthService.ACCESS_TOKEN_KEY),\n        this.secureDeleteItemAsync(AuthService.REFRESH_TOKEN_KEY),\n        this.secureDeleteItemAsync(AuthService.USER_KEY),\n        this.secureDeleteItemAsync(AuthService.SESSION_START_KEY),\n        this.secureDeleteItemAsync(AuthService.LAST_ACTIVITY_KEY),\n      ]);\n\n      // Stop session monitoring\n      this.stopSessionMonitoring();\n    } catch (error) {\n      logger.error(\"Failed to clear auth data\", { error });\n      // Don't throw here as this is cleanup\n    }\n  }\n\n  private async getRefreshToken(): Promise<string | null> {\n    try {\n      return await this.secureGetItemAsync(AuthService.REFRESH_TOKEN_KEY);\n    } catch (error) {\n      logger.error(\"Failed to get refresh token\", { error });\n      return null;\n    }\n  }\n}\n\n// Custom error class for authentication errors\nexport class AuthError extends Error {\n  constructor(\n    message: string,\n    public originalError?: unknown,\n  ) {\n    super(message);\n    this.name = \"AuthError\";\n  }\n}\n\n// Export singleton instance\nexport const authService = new AuthService();\nexport default authService;\n"],"mappings":"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","ignoreList":[]}