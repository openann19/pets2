{"version":3,"names":["Location","_interopRequireWildcard","require","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty2","default","getOwnPropertyDescriptors","defineProperties","defineProperty","WeakMap","n","__esModule","i","f","__proto__","has","get","set","_t","hasOwnProperty","call","startActivity","_x","_startActivity","_asyncToGenerator2","params","location","getCurrentPositionAsync","accuracy","Accuracy","Balanced","_yield$import","Promise","resolve","then","request","response","method","body","latitude","coords","longitude","endActivity","_x2","_endActivity","activityId","_yield$import2","getNearbyPins","_x3","_x4","_x5","_getNearbyPins","maxDistance","_yield$import3","likePin","_x6","_likePin","pinId","_yield$import4","commentOnPin","_x7","_x8","_commentOnPin","text","_yield$import5"],"sources":["mapActivityService.ts"],"sourcesContent":["import { api } from './api';\nimport * as Location from 'expo-location';\n\nexport interface CreateActivityParams {\n  petId: string;\n  activity: string;\n  message?: string;\n  shareToMap?: boolean;\n  radiusMeters?: number;\n}\n\nexport interface MapPin {\n  _id: string;\n  userId: string;\n  petId: string;\n  activity: string;\n  message?: string;\n  location: {\n    type: string;\n    coordinates: [number, number]; // [longitude, latitude]\n  };\n  radiusMeters: number;\n  shareToMap: boolean;\n  active: boolean;\n  likes: Array<{\n    userId: string;\n    likedAt: string;\n  }>;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface MapSearchParams {\n  latitude: number;\n  longitude: number;\n  maxDistance?: number;\n}\n\nexport async function startActivity(params: CreateActivityParams): Promise<MapPin> {\n  const location = await Location.getCurrentPositionAsync({\n    accuracy: Location.Accuracy.Balanced,\n  });\n\n  const { request } = await import('./api');\n  const response = await request<MapPin>('/map/activity/start', {\n    method: 'POST',\n    body: {\n      ...params,\n      location: { \n        latitude: location.coords.latitude, \n        longitude: location.coords.longitude \n      },\n    },\n  });\n\n  return response;\n}\n\nexport async function endActivity(activityId: string): Promise<void> {\n  const { request } = await import('./api');\n  await request('/map/activity/end', {\n    method: 'POST',\n    body: { activityId },\n  });\n}\n\nexport async function getNearbyPins(\n  latitude: number,\n  longitude: number,\n  maxDistance?: number\n): Promise<MapPin[]> {\n  const { request } = await import('./api');\n  const params: Record<string, number> = { latitude, longitude };\n  if (maxDistance) params.maxDistance = maxDistance;\n\n  const response = await request<MapPin[]>('/map/pins', {\n    method: 'GET',\n    params: params as Record<string, string | number | boolean | null | undefined>,\n  });\n  return response;\n}\n\nexport async function likePin(pinId: string): Promise<{ likes: number }> {\n  const { request } = await import('./api');\n  const response = await request<{ likes: number }>(`/map/pins/${pinId}/like`, {\n    method: 'POST',\n  });\n  return response;\n}\n\nexport async function commentOnPin(pinId: string, text: string): Promise<{ comments: number }> {\n  const { request } = await import('./api');\n  const response = await request<{ comments: number }>(`/map/pins/${pinId}/comment`, {\n    method: 'POST',\n    body: { text },\n  });\n  return response;\n}\n\n"],"mappings":"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","ignoreList":[]}