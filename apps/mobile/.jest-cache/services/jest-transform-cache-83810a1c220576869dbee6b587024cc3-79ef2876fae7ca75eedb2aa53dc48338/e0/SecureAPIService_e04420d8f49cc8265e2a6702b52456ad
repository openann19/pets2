ae1eea9a9c30b6c6db1e2b951ecbbb23
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.secureAPI = exports.default = exports.SecureAPIError = void 0;
var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));
var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));
var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));
var _wrapNativeSuper2 = _interopRequireDefault(require("@babel/runtime/helpers/wrapNativeSuper"));
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _reactNativeSslPinning = require("react-native-ssl-pinning");
var _logger = require("../services/logger");
var _excluded = ["timeout", "retries", "retryDelay"];
var _process$env$EXPO_PUB;
function _callSuper(t, o, e) { return o = (0, _getPrototypeOf2.default)(o), (0, _possibleConstructorReturn2.default)(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], (0, _getPrototypeOf2.default)(t).constructor) : o.apply(t, e)); }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
var BASE_URL = (_process$env$EXPO_PUB = process.env["EXPO_PUBLIC_API_URL"]) != null ? _process$env$EXPO_PUB : __DEV__ ? "http://localhost:3001/api" : "https://api.pawfectmatch.com/api";
var SSL_CERTIFICATES = {
  "api.pawfectmatch.com": [{
    algorithm: "sha256",
    value: "PLACEHOLDER_CERTIFICATE_FINGERPRINT_SHA256"
  }, {
    algorithm: "sha1",
    value: "PLACEHOLDER_CERTIFICATE_FINGERPRINT_SHA1"
  }],
  localhost: undefined
};
var SecureAPIService = function () {
  function SecureAPIService() {
    (0, _classCallCheck2.default)(this, SecureAPIService);
    this.authToken = null;
  }
  return (0, _createClass2.default)(SecureAPIService, [{
    key: "setAuthToken",
    value: function setAuthToken(token) {
      this.authToken = token;
    }
  }, {
    key: "clearAuthToken",
    value: function clearAuthToken() {
      this.authToken = null;
    }
  }, {
    key: "getSSLConfig",
    value: function getSSLConfig(domain) {
      var certs = SSL_CERTIFICATES[domain];
      if (certs === undefined || certs.length === 0) {
        if (__DEV__) {
          return {
            sslPinning: {
              certs: "public"
            }
          };
        }
        throw new Error(`No SSL certificates configured for domain: ${domain}`);
      }
      return {
        sslPinning: {
          certs: certs
        }
      };
    }
  }, {
    key: "request",
    value: (function () {
      var _request = (0, _asyncToGenerator2.default)(function* (endpoint) {
        var _fetchOptions$method, _lastError, _lastError$message, _lastError2, _lastError3;
        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        var url = `${BASE_URL}${endpoint}`;
        var domain = new URL(url).hostname;
        var _options$timeout = options.timeout,
          timeout = _options$timeout === void 0 ? 30000 : _options$timeout,
          _options$retries = options.retries,
          retries = _options$retries === void 0 ? 3 : _options$retries,
          _options$retryDelay = options.retryDelay,
          retryDelay = _options$retryDelay === void 0 ? 1000 : _options$retryDelay,
          fetchOptions = (0, _objectWithoutProperties2.default)(options, _excluded);
        var headers = _objectSpread({
          "Content-Type": "application/json"
        }, fetchOptions.headers);
        if (this.authToken !== null) {
          headers["Authorization"] = `Bearer ${this.authToken}`;
        }
        var sslConfig = this.getSSLConfig(domain);
        var requestConfig = _objectSpread({
          method: (_fetchOptions$method = fetchOptions.method) != null ? _fetchOptions$method : "GET",
          headers: headers,
          body: fetchOptions.body ? String(fetchOptions.body) : undefined,
          timeoutInterval: timeout
        }, sslConfig);
        var lastError = null;
        var _loop = function* _loop(attempt) {
            try {
              _logger.logger.debug(`Secure API request attempt ${String(attempt + 1)}/${String(retries)}`, {
                url: url,
                method: requestConfig.method
              });
              var response = yield (0, _reactNativeSslPinning.fetch)(url, _objectSpread(_objectSpread({}, requestConfig), {}, {
                method: requestConfig.method
              }));
              var status = response.status;
              var ok = status >= 200 && status < 300;
              if (!ok) {
                var statusText = response.statusText || "";
                throw new Error(`HTTP ${String(status)}: ${statusText}`);
              }
              var data = yield response.json();
              _logger.logger.debug("Secure API request successful", {
                url: url,
                status: response.status
              });
              return {
                v: data
              };
            } catch (error) {
              lastError = error instanceof Error ? error : new Error(String(error));
              _logger.logger.warn(`Secure API request attempt ${String(attempt + 1)} failed`, {
                url: url,
                error: lastError,
                attempt: attempt + 1,
                maxRetries: retries
              });
              if (attempt < retries - 1) {
                yield new Promise(function (resolve) {
                  setTimeout(function () {
                    resolve();
                  }, retryDelay * (attempt + 1));
                });
              }
            }
          },
          _ret;
        for (var attempt = 0; attempt < retries; attempt++) {
          _ret = yield* _loop(attempt);
          if (_ret) return _ret.v;
        }
        _logger.logger.error("Secure API request failed after all retries", {
          url: url,
          error: (_lastError = lastError) != null ? _lastError : undefined,
          retries: retries
        });
        throw new SecureAPIError(`Request failed after ${String(retries)} attempts: ${(_lastError$message = (_lastError2 = lastError) == null ? void 0 : _lastError2.message) != null ? _lastError$message : "Unknown error"}`, (_lastError3 = lastError) != null ? _lastError3 : undefined);
      });
      function request(_x) {
        return _request.apply(this, arguments);
      }
      return request;
    }())
  }, {
    key: "get",
    value: (function () {
      var _get = (0, _asyncToGenerator2.default)(function* (endpoint, config) {
        return this.request(endpoint, _objectSpread(_objectSpread({}, config), {}, {
          method: "GET"
        }));
      });
      function get(_x2, _x3) {
        return _get.apply(this, arguments);
      }
      return get;
    }())
  }, {
    key: "post",
    value: (function () {
      var _post = (0, _asyncToGenerator2.default)(function* (endpoint, data, config) {
        return this.request(endpoint, _objectSpread(_objectSpread({}, config != null ? config : {}), {}, {
          method: "POST",
          body: data !== null && data !== undefined ? JSON.stringify(data) : undefined
        }));
      });
      function post(_x4, _x5, _x6) {
        return _post.apply(this, arguments);
      }
      return post;
    }())
  }, {
    key: "put",
    value: (function () {
      var _put = (0, _asyncToGenerator2.default)(function* (endpoint, data, config) {
        return this.request(endpoint, _objectSpread(_objectSpread({}, config != null ? config : {}), {}, {
          method: "PUT",
          body: data !== null && data !== undefined ? JSON.stringify(data) : undefined
        }));
      });
      function put(_x7, _x8, _x9) {
        return _put.apply(this, arguments);
      }
      return put;
    }())
  }, {
    key: "delete",
    value: (function () {
      var _delete2 = (0, _asyncToGenerator2.default)(function* (endpoint, config) {
        return this.request(endpoint, _objectSpread(_objectSpread({}, config), {}, {
          method: "DELETE"
        }));
      });
      function _delete(_x0, _x1) {
        return _delete2.apply(this, arguments);
      }
      return _delete;
    }())
  }, {
    key: "validateCertificate",
    value: (function () {
      var _validateCertificate = (0, _asyncToGenerator2.default)(function* (domain) {
        try {
          var sslConfig = this.getSSLConfig(domain);
          var testConfig = _objectSpread({
            method: "HEAD",
            headers: {},
            timeoutInterval: 5000
          }, sslConfig);
          yield (0, _reactNativeSslPinning.fetch)(`https://${domain}`, testConfig);
          return true;
        } catch (error) {
          _logger.logger.error("SSL certificate validation failed", {
            domain: domain,
            error: error instanceof Error ? error : new Error(String(error))
          });
          return false;
        }
      });
      function validateCertificate(_x10) {
        return _validateCertificate.apply(this, arguments);
      }
      return validateCertificate;
    }())
  }, {
    key: "getSecurityMetrics",
    value: function getSecurityMetrics() {
      return {
        sslEnabled: true,
        certificatePinning: true,
        supportedDomains: Object.keys(SSL_CERTIFICATES)
      };
    }
  }], [{
    key: "getInstance",
    value: function getInstance() {
      if (SecureAPIService.instance === null) {
        SecureAPIService.instance = new SecureAPIService();
      }
      return SecureAPIService.instance;
    }
  }]);
}();
SecureAPIService.instance = null;
var SecureAPIError = exports.SecureAPIError = function (_Error) {
  function SecureAPIError(message, originalError) {
    var _this;
    (0, _classCallCheck2.default)(this, SecureAPIError);
    _this = _callSuper(this, SecureAPIError, [message]);
    _this.name = "SecureAPIError";
    _this.originalError = originalError;
    return _this;
  }
  (0, _inherits2.default)(SecureAPIError, _Error);
  return (0, _createClass2.default)(SecureAPIError);
}((0, _wrapNativeSuper2.default)(Error));
var secureAPI = exports.secureAPI = SecureAPIService.getInstance();
var _default = exports.default = secureAPI;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3ROYXRpdmVTc2xQaW5uaW5nIiwicmVxdWlyZSIsIl9sb2dnZXIiLCJfZXhjbHVkZWQiLCJfcHJvY2VzcyRlbnYkRVhQT19QVUIiLCJfY2FsbFN1cGVyIiwidCIsIm8iLCJlIiwiX2dldFByb3RvdHlwZU9mMiIsImRlZmF1bHQiLCJfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIiLCJfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0IiwiUmVmbGVjdCIsImNvbnN0cnVjdCIsImNvbnN0cnVjdG9yIiwiYXBwbHkiLCJCb29sZWFuIiwicHJvdG90eXBlIiwidmFsdWVPZiIsImNhbGwiLCJvd25LZXlzIiwiciIsIk9iamVjdCIsImtleXMiLCJnZXRPd25Qcm9wZXJ0eVN5bWJvbHMiLCJmaWx0ZXIiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwicHVzaCIsIl9vYmplY3RTcHJlYWQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJmb3JFYWNoIiwiX2RlZmluZVByb3BlcnR5MiIsImdldE93blByb3BlcnR5RGVzY3JpcHRvcnMiLCJkZWZpbmVQcm9wZXJ0aWVzIiwiZGVmaW5lUHJvcGVydHkiLCJCQVNFX1VSTCIsInByb2Nlc3MiLCJlbnYiLCJfX0RFVl9fIiwiU1NMX0NFUlRJRklDQVRFUyIsImFsZ29yaXRobSIsInZhbHVlIiwibG9jYWxob3N0IiwidW5kZWZpbmVkIiwiU2VjdXJlQVBJU2VydmljZSIsIl9jbGFzc0NhbGxDaGVjazIiLCJhdXRoVG9rZW4iLCJfY3JlYXRlQ2xhc3MyIiwia2V5Iiwic2V0QXV0aFRva2VuIiwidG9rZW4iLCJjbGVhckF1dGhUb2tlbiIsImdldFNTTENvbmZpZyIsImRvbWFpbiIsImNlcnRzIiwic3NsUGlubmluZyIsIkVycm9yIiwiX3JlcXVlc3QiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJlbmRwb2ludCIsIl9mZXRjaE9wdGlvbnMkbWV0aG9kIiwiX2xhc3RFcnJvciIsIl9sYXN0RXJyb3IkbWVzc2FnZSIsIl9sYXN0RXJyb3IyIiwiX2xhc3RFcnJvcjMiLCJvcHRpb25zIiwidXJsIiwiVVJMIiwiaG9zdG5hbWUiLCJfb3B0aW9ucyR0aW1lb3V0IiwidGltZW91dCIsIl9vcHRpb25zJHJldHJpZXMiLCJyZXRyaWVzIiwiX29wdGlvbnMkcmV0cnlEZWxheSIsInJldHJ5RGVsYXkiLCJmZXRjaE9wdGlvbnMiLCJfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMyIiwiaGVhZGVycyIsInNzbENvbmZpZyIsInJlcXVlc3RDb25maWciLCJtZXRob2QiLCJib2R5IiwiU3RyaW5nIiwidGltZW91dEludGVydmFsIiwibGFzdEVycm9yIiwiX2xvb3AiLCJhdHRlbXB0IiwibG9nZ2VyIiwiZGVidWciLCJyZXNwb25zZSIsInNzbEZldGNoIiwic3RhdHVzIiwib2siLCJzdGF0dXNUZXh0IiwiZGF0YSIsImpzb24iLCJ2IiwiZXJyb3IiLCJ3YXJuIiwibWF4UmV0cmllcyIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIl9yZXQiLCJTZWN1cmVBUElFcnJvciIsIm1lc3NhZ2UiLCJyZXF1ZXN0IiwiX3giLCJfZ2V0IiwiY29uZmlnIiwiZ2V0IiwiX3gyIiwiX3gzIiwiX3Bvc3QiLCJKU09OIiwic3RyaW5naWZ5IiwicG9zdCIsIl94NCIsIl94NSIsIl94NiIsIl9wdXQiLCJwdXQiLCJfeDciLCJfeDgiLCJfeDkiLCJfZGVsZXRlMiIsImRlbGV0ZSIsIl94MCIsIl94MSIsIl92YWxpZGF0ZUNlcnRpZmljYXRlIiwidGVzdENvbmZpZyIsInZhbGlkYXRlQ2VydGlmaWNhdGUiLCJfeDEwIiwiZ2V0U2VjdXJpdHlNZXRyaWNzIiwic3NsRW5hYmxlZCIsImNlcnRpZmljYXRlUGlubmluZyIsInN1cHBvcnRlZERvbWFpbnMiLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwiZXhwb3J0cyIsIl9FcnJvciIsIm9yaWdpbmFsRXJyb3IiLCJfdGhpcyIsIm5hbWUiLCJfaW5oZXJpdHMyIiwiX3dyYXBOYXRpdmVTdXBlcjIiLCJzZWN1cmVBUEkiLCJfZGVmYXVsdCJdLCJzb3VyY2VzIjpbIlNlY3VyZUFQSVNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBTZWN1cmUgQVBJIFNlcnZpY2Ugd2l0aCBTU0wgUGlubmluZyBmb3IgUGF3ZmVjdE1hdGNoIE1vYmlsZSBBcHBcbiAqIFByb3ZpZGVzIGNlcnRpZmljYXRlIHBpbm5pbmcgYW5kIHNlY3VyZSBIVFRQIGNvbW11bmljYXRpb25cbiAqL1xuaW1wb3J0IHsgZmV0Y2ggYXMgc3NsRmV0Y2ggfSBmcm9tIFwicmVhY3QtbmF0aXZlLXNzbC1waW5uaW5nXCI7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tIFwiLi4vc2VydmljZXMvbG9nZ2VyXCI7XG5pbXBvcnQgdHlwZSB7IFNTTEZldGNoLCBTU0xSZXNwb25zZSwgU1NMUGlubmluZ0NvbmZpZyB9IGZyb20gXCIuLi90eXBlcy9zc2wtcGlubmluZ1wiO1xuXG5jb25zdCBCQVNFX1VSTCA9XG4gIHByb2Nlc3MuZW52W1wiRVhQT19QVUJMSUNfQVBJX1VSTFwiXSA/P1xuICAoX19ERVZfXyA/IFwiaHR0cDovL2xvY2FsaG9zdDozMDAxL2FwaVwiIDogXCJodHRwczovL2FwaS5wYXdmZWN0bWF0Y2guY29tL2FwaVwiKTtcblxuLy8gQ2VydGlmaWNhdGUgZmluZ2VycHJpbnRzIGZvciBTU0wgcGlubmluZ1xuLy8gSW4gcHJvZHVjdGlvbiwgdGhlc2Ugc2hvdWxkIGJlIG9idGFpbmVkIGZyb20geW91ciBzZXJ2ZXIgY2VydGlmaWNhdGVzXG5jb25zdCBTU0xfQ0VSVElGSUNBVEVTOiBSZWNvcmQ8XG4gIHN0cmluZyxcbiAgQXJyYXk8eyBhbGdvcml0aG06IHN0cmluZzsgdmFsdWU6IHN0cmluZyB9PiB8IHVuZGVmaW5lZFxuPiA9IHtcbiAgLy8gRXhhbXBsZSBjZXJ0aWZpY2F0ZSBmaW5nZXJwcmludHMgKHJlcGxhY2Ugd2l0aCB5b3VyIGFjdHVhbCBjZXJ0aWZpY2F0ZXMpXG4gIFwiYXBpLnBhd2ZlY3RtYXRjaC5jb21cIjogW1xuICAgIHtcbiAgICAgIGFsZ29yaXRobTogXCJzaGEyNTZcIixcbiAgICAgIHZhbHVlOiBcIlBMQUNFSE9MREVSX0NFUlRJRklDQVRFX0ZJTkdFUlBSSU5UX1NIQTI1NlwiLFxuICAgIH0sXG4gICAge1xuICAgICAgYWxnb3JpdGhtOiBcInNoYTFcIixcbiAgICAgIHZhbHVlOiBcIlBMQUNFSE9MREVSX0NFUlRJRklDQVRFX0ZJTkdFUlBSSU5UX1NIQTFcIixcbiAgICB9LFxuICBdLFxuICAvLyBEZXZlbG9wbWVudCBjZXJ0aWZpY2F0ZXNcbiAgbG9jYWxob3N0OiB1bmRlZmluZWQsXG59O1xuXG5pbnRlcmZhY2UgU1NMQ29uZmlnIHtcbiAgdGltZW91dD86IG51bWJlcjtcbiAgcmV0cmllcz86IG51bWJlcjtcbiAgcmV0cnlEZWxheT86IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIFNTTFJlcXVlc3RDb25maWcge1xuICBtZXRob2Q6IHN0cmluZztcbiAgaGVhZGVyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgYm9keT86IHN0cmluZztcbiAgdGltZW91dEludGVydmFsOiBudW1iZXI7XG4gIHNzbFBpbm5pbmc6IHtcbiAgICBjZXJ0czogc3RyaW5nIHwgQXJyYXk8eyBhbGdvcml0aG06IHN0cmluZzsgdmFsdWU6IHN0cmluZyB9PjtcbiAgfTtcbn1cblxuY2xhc3MgU2VjdXJlQVBJU2VydmljZSB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBTZWN1cmVBUElTZXJ2aWNlIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgYXV0aFRva2VuOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge31cblxuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogU2VjdXJlQVBJU2VydmljZSB7XG4gICAgaWYgKFNlY3VyZUFQSVNlcnZpY2UuaW5zdGFuY2UgPT09IG51bGwpIHtcbiAgICAgIFNlY3VyZUFQSVNlcnZpY2UuaW5zdGFuY2UgPSBuZXcgU2VjdXJlQVBJU2VydmljZSgpO1xuICAgIH1cbiAgICByZXR1cm4gU2VjdXJlQVBJU2VydmljZS5pbnN0YW5jZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgYXV0aGVudGljYXRpb24gdG9rZW5cbiAgICovXG4gIHNldEF1dGhUb2tlbih0b2tlbjogc3RyaW5nIHwgbnVsbCk6IHZvaWQge1xuICAgIHRoaXMuYXV0aFRva2VuID0gdG9rZW47XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXIgYXV0aGVudGljYXRpb24gdG9rZW5cbiAgICovXG4gIGNsZWFyQXV0aFRva2VuKCk6IHZvaWQge1xuICAgIHRoaXMuYXV0aFRva2VuID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgU1NMIGNvbmZpZ3VyYXRpb24gZm9yIGEgZG9tYWluXG4gICAqL1xuICBwcml2YXRlIGdldFNTTENvbmZpZyhkb21haW46IHN0cmluZyk6IHtcbiAgICBzc2xQaW5uaW5nOiB7IGNlcnRzOiBzdHJpbmcgfCBBcnJheTx7IGFsZ29yaXRobTogc3RyaW5nOyB2YWx1ZTogc3RyaW5nIH0+IH07XG4gIH0ge1xuICAgIGNvbnN0IGNlcnRzID0gU1NMX0NFUlRJRklDQVRFU1tkb21haW5dO1xuICAgIGlmIChjZXJ0cyA9PT0gdW5kZWZpbmVkIHx8IGNlcnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgLy8gSW4gZGV2ZWxvcG1lbnQsIGFsbG93IHVudHJ1c3RlZCBjZXJ0aWZpY2F0ZXNcbiAgICAgIGlmIChfX0RFVl9fKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3NsUGlubmluZzoge1xuICAgICAgICAgICAgY2VydHM6IFwicHVibGljXCIsXG4gICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gU1NMIGNlcnRpZmljYXRlcyBjb25maWd1cmVkIGZvciBkb21haW46ICR7ZG9tYWlufWApO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBzc2xQaW5uaW5nOiB7XG4gICAgICAgIGNlcnRzOiBjZXJ0cyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNYWtlIGEgc2VjdXJlIEhUVFAgcmVxdWVzdCB3aXRoIFNTTCBwaW5uaW5nXG4gICAqL1xuICBhc3luYyByZXF1ZXN0PFQgPSB1bmtub3duPihcbiAgICBlbmRwb2ludDogc3RyaW5nLFxuICAgIG9wdGlvbnM6IFJlcXVlc3RJbml0ICYgU1NMQ29uZmlnID0ge30sXG4gICk6IFByb21pc2U8VD4ge1xuICAgIGNvbnN0IHVybCA9IGAke0JBU0VfVVJMfSR7ZW5kcG9pbnR9YDtcbiAgICBjb25zdCBkb21haW4gPSBuZXcgVVJMKHVybCkuaG9zdG5hbWU7XG5cbiAgICBjb25zdCB7XG4gICAgICB0aW1lb3V0ID0gMzAwMDAsXG4gICAgICByZXRyaWVzID0gMyxcbiAgICAgIHJldHJ5RGVsYXkgPSAxMDAwLFxuICAgICAgLi4uZmV0Y2hPcHRpb25zXG4gICAgfSA9IG9wdGlvbnM7XG5cbiAgICAvLyBCdWlsZCBoZWFkZXJzXG4gICAgY29uc3QgaGVhZGVyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgLi4uKGZldGNoT3B0aW9ucy5oZWFkZXJzIGFzIFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQpLFxuICAgIH07XG5cbiAgICAvLyBBZGQgYXV0aCB0b2tlbiBpZiBhdmFpbGFibGVcbiAgICBpZiAodGhpcy5hdXRoVG9rZW4gIT09IG51bGwpIHtcbiAgICAgIGhlYWRlcnNbXCJBdXRob3JpemF0aW9uXCJdID0gYEJlYXJlciAke3RoaXMuYXV0aFRva2VufWA7XG4gICAgfVxuXG4gICAgLy8gU1NMIHBpbm5pbmcgY29uZmlndXJhdGlvblxuICAgIGNvbnN0IHNzbENvbmZpZyA9IHRoaXMuZ2V0U1NMQ29uZmlnKGRvbWFpbik7XG5cbiAgICBjb25zdCByZXF1ZXN0Q29uZmlnOiBTU0xSZXF1ZXN0Q29uZmlnID0ge1xuICAgICAgbWV0aG9kOiBmZXRjaE9wdGlvbnMubWV0aG9kID8/IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzLFxuICAgICAgYm9keTogZmV0Y2hPcHRpb25zLmJvZHkgPyBTdHJpbmcoZmV0Y2hPcHRpb25zLmJvZHkpIDogdW5kZWZpbmVkLFxuICAgICAgdGltZW91dEludGVydmFsOiB0aW1lb3V0LFxuICAgICAgLi4uc3NsQ29uZmlnLFxuICAgIH07XG5cbiAgICBsZXQgbGFzdEVycm9yOiBFcnJvciB8IG51bGwgPSBudWxsO1xuXG4gICAgLy8gUmV0cnkgbG9naWNcbiAgICBmb3IgKGxldCBhdHRlbXB0ID0gMDsgYXR0ZW1wdCA8IHJldHJpZXM7IGF0dGVtcHQrKykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbG9nZ2VyLmRlYnVnKFxuICAgICAgICAgIGBTZWN1cmUgQVBJIHJlcXVlc3QgYXR0ZW1wdCAke1N0cmluZyhhdHRlbXB0ICsgMSl9LyR7U3RyaW5nKHJldHJpZXMpfWAsXG4gICAgICAgICAge1xuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgbWV0aG9kOiByZXF1ZXN0Q29uZmlnLm1ldGhvZCxcbiAgICAgICAgICB9LFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gKGF3YWl0IHNzbEZldGNoKHVybCwge1xuICAgICAgICAgIC4uLnJlcXVlc3RDb25maWcsXG4gICAgICAgICAgbWV0aG9kOiByZXF1ZXN0Q29uZmlnLm1ldGhvZCBhcyBcIkdFVFwiIHwgXCJQT1NUXCIgfCBcIlBVVFwiIHwgXCJERUxFVEVcIixcbiAgICAgICAgfSBhcyBhbnkpKSBhcyBTU0xSZXNwb25zZTtcbiAgICAgICAgY29uc3Qgc3RhdHVzID0gcmVzcG9uc2Uuc3RhdHVzO1xuICAgICAgICBjb25zdCBvayA9IHN0YXR1cyA+PSAyMDAgJiYgc3RhdHVzIDwgMzAwO1xuICAgICAgICBpZiAoIW9rKSB7XG4gICAgICAgICAgY29uc3Qgc3RhdHVzVGV4dCA9IHJlc3BvbnNlLnN0YXR1c1RleHQgfHwgXCJcIjtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgJHtTdHJpbmcoc3RhdHVzKX06ICR7c3RhdHVzVGV4dH1gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRhdGEgPSAoYXdhaXQgcmVzcG9uc2UuanNvbigpKSBhcyBUO1xuICAgICAgICBsb2dnZXIuZGVidWcoXCJTZWN1cmUgQVBJIHJlcXVlc3Qgc3VjY2Vzc2Z1bFwiLCB7XG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxhc3RFcnJvciA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyb3IpKTtcblxuICAgICAgICBsb2dnZXIud2FybihcbiAgICAgICAgICBgU2VjdXJlIEFQSSByZXF1ZXN0IGF0dGVtcHQgJHtTdHJpbmcoYXR0ZW1wdCArIDEpfSBmYWlsZWRgLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgIGVycm9yOiBsYXN0RXJyb3IsXG4gICAgICAgICAgICBhdHRlbXB0OiBhdHRlbXB0ICsgMSxcbiAgICAgICAgICAgIG1heFJldHJpZXM6IHJldHJpZXMsXG4gICAgICAgICAgfSxcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBJZiBub3QgdGhlIGxhc3QgYXR0ZW1wdCwgd2FpdCBiZWZvcmUgcmV0cnlpbmdcbiAgICAgICAgaWYgKGF0dGVtcHQgPCByZXRyaWVzIC0gMSkge1xuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsgcmVzb2x2ZSgpOyB9LCByZXRyeURlbGF5ICogKGF0dGVtcHQgKyAxKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBbGwgcmV0cmllcyBmYWlsZWRcbiAgICBsb2dnZXIuZXJyb3IoXCJTZWN1cmUgQVBJIHJlcXVlc3QgZmFpbGVkIGFmdGVyIGFsbCByZXRyaWVzXCIsIHtcbiAgICAgIHVybCxcbiAgICAgIGVycm9yOiBsYXN0RXJyb3IgPz8gdW5kZWZpbmVkLFxuICAgICAgcmV0cmllcyxcbiAgICB9KTtcblxuICAgIHRocm93IG5ldyBTZWN1cmVBUElFcnJvcihcbiAgICAgIGBSZXF1ZXN0IGZhaWxlZCBhZnRlciAke1N0cmluZyhyZXRyaWVzKX0gYXR0ZW1wdHM6ICR7bGFzdEVycm9yPy5tZXNzYWdlID8/IFwiVW5rbm93biBlcnJvclwifWAsXG4gICAgICBsYXN0RXJyb3IgPz8gdW5kZWZpbmVkLFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogR0VUIHJlcXVlc3RcbiAgICovXG4gIGFzeW5jIGdldDxUID0gdW5rbm93bj4oZW5kcG9pbnQ6IHN0cmluZywgY29uZmlnPzogU1NMQ29uZmlnKTogUHJvbWlzZTxUPiB7XG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdDxUPihlbmRwb2ludCwgeyAuLi5jb25maWcsIG1ldGhvZDogXCJHRVRcIiB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQT1NUIHJlcXVlc3RcbiAgICovXG4gIGFzeW5jIHBvc3Q8VCA9IHVua25vd24+KFxuICAgIGVuZHBvaW50OiBzdHJpbmcsXG4gICAgZGF0YT86IHVua25vd24sXG4gICAgY29uZmlnPzogU1NMQ29uZmlnLFxuICApOiBQcm9taXNlPFQ+IHtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0PFQ+KGVuZHBvaW50LCB7XG4gICAgICAuLi4oY29uZmlnID8/IHt9KSxcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBib2R5OlxuICAgICAgICBkYXRhICE9PSBudWxsICYmIGRhdGEgIT09IHVuZGVmaW5lZCA/IEpTT04uc3RyaW5naWZ5KGRhdGEpIDogdW5kZWZpbmVkLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBVVCByZXF1ZXN0XG4gICAqL1xuICBhc3luYyBwdXQ8VCA9IHVua25vd24+KFxuICAgIGVuZHBvaW50OiBzdHJpbmcsXG4gICAgZGF0YT86IHVua25vd24sXG4gICAgY29uZmlnPzogU1NMQ29uZmlnLFxuICApOiBQcm9taXNlPFQ+IHtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0PFQ+KGVuZHBvaW50LCB7XG4gICAgICAuLi4oY29uZmlnID8/IHt9KSxcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGJvZHk6XG4gICAgICAgIGRhdGEgIT09IG51bGwgJiYgZGF0YSAhPT0gdW5kZWZpbmVkID8gSlNPTi5zdHJpbmdpZnkoZGF0YSkgOiB1bmRlZmluZWQsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogREVMRVRFIHJlcXVlc3RcbiAgICovXG4gIGFzeW5jIGRlbGV0ZTxUID0gdW5rbm93bj4oZW5kcG9pbnQ6IHN0cmluZywgY29uZmlnPzogU1NMQ29uZmlnKTogUHJvbWlzZTxUPiB7XG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdDxUPihlbmRwb2ludCwgeyAuLi5jb25maWcsIG1ldGhvZDogXCJERUxFVEVcIiB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBTU0wgY2VydGlmaWNhdGUgdmFsaWRpdHlcbiAgICovXG4gIGFzeW5jIHZhbGlkYXRlQ2VydGlmaWNhdGUoZG9tYWluOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3NsQ29uZmlnID0gdGhpcy5nZXRTU0xDb25maWcoZG9tYWluKTtcbiAgICAgIC8vIFBlcmZvcm0gYSB0ZXN0IHJlcXVlc3QgdG8gdmFsaWRhdGUgU1NMIHBpbm5pbmdcbiAgICAgIGNvbnN0IHRlc3RDb25maWc6IFNTTFBpbm5pbmdDb25maWcgPSB7XG4gICAgICAgIG1ldGhvZDogXCJIRUFEXCIsXG4gICAgICAgIGhlYWRlcnM6IHt9LFxuICAgICAgICB0aW1lb3V0SW50ZXJ2YWw6IDUwMDAsXG4gICAgICAgIC4uLnNzbENvbmZpZyxcbiAgICAgIH07XG4gICAgICBhd2FpdCBzc2xGZXRjaChgaHR0cHM6Ly8ke2RvbWFpbn1gLCB0ZXN0Q29uZmlnIGFzIGFueSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKFwiU1NMIGNlcnRpZmljYXRlIHZhbGlkYXRpb24gZmFpbGVkXCIsIHtcbiAgICAgICAgZG9tYWluLFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzZWN1cml0eSBtZXRyaWNzXG4gICAqL1xuICBnZXRTZWN1cml0eU1ldHJpY3MoKToge1xuICAgIHNzbEVuYWJsZWQ6IGJvb2xlYW47XG4gICAgY2VydGlmaWNhdGVQaW5uaW5nOiBib29sZWFuO1xuICAgIHN1cHBvcnRlZERvbWFpbnM6IHN0cmluZ1tdO1xuICB9IHtcbiAgICByZXR1cm4ge1xuICAgICAgc3NsRW5hYmxlZDogdHJ1ZSxcbiAgICAgIGNlcnRpZmljYXRlUGlubmluZzogdHJ1ZSxcbiAgICAgIHN1cHBvcnRlZERvbWFpbnM6IE9iamVjdC5rZXlzKFNTTF9DRVJUSUZJQ0FURVMpLFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBDdXN0b20gZXJyb3IgY2xhc3MgZm9yIHNlY3VyZSBBUEkgZXJyb3JzXG4gKi9cbmV4cG9ydCBjbGFzcyBTZWN1cmVBUElFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgcHVibGljIG9yaWdpbmFsRXJyb3I/OiBFcnJvcjtcblxuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIG9yaWdpbmFsRXJyb3I/OiBFcnJvcikge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMubmFtZSA9IFwiU2VjdXJlQVBJRXJyb3JcIjtcbiAgICB0aGlzLm9yaWdpbmFsRXJyb3IgPSBvcmlnaW5hbEVycm9yO1xuICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcbmV4cG9ydCBjb25zdCBzZWN1cmVBUEkgPSBTZWN1cmVBUElTZXJ2aWNlLmdldEluc3RhbmNlKCk7XG5cbi8vIEV4cG9ydCB0eXBlc1xuZXhwb3J0IHR5cGUgeyBTU0xDb25maWcgfTtcbmV4cG9ydCBkZWZhdWx0IHNlY3VyZUFQSTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUlBLElBQUFBLHNCQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxPQUFBLEdBQUFELE9BQUE7QUFBNEMsSUFBQUUsU0FBQTtBQUFBLElBQUFDLHFCQUFBO0FBQUEsU0FBQUMsV0FBQUMsQ0FBQSxFQUFBQyxDQUFBLEVBQUFDLENBQUEsV0FBQUQsQ0FBQSxPQUFBRSxnQkFBQSxDQUFBQyxPQUFBLEVBQUFILENBQUEsT0FBQUksMkJBQUEsQ0FBQUQsT0FBQSxFQUFBSixDQUFBLEVBQUFNLHlCQUFBLEtBQUFDLE9BQUEsQ0FBQUMsU0FBQSxDQUFBUCxDQUFBLEVBQUFDLENBQUEsWUFBQUMsZ0JBQUEsQ0FBQUMsT0FBQSxFQUFBSixDQUFBLEVBQUFTLFdBQUEsSUFBQVIsQ0FBQSxDQUFBUyxLQUFBLENBQUFWLENBQUEsRUFBQUUsQ0FBQTtBQUFBLFNBQUFJLDBCQUFBLGNBQUFOLENBQUEsSUFBQVcsT0FBQSxDQUFBQyxTQUFBLENBQUFDLE9BQUEsQ0FBQUMsSUFBQSxDQUFBUCxPQUFBLENBQUFDLFNBQUEsQ0FBQUcsT0FBQSxpQ0FBQVgsQ0FBQSxhQUFBTSx5QkFBQSxZQUFBQSwwQkFBQSxhQUFBTixDQUFBO0FBQUEsU0FBQWUsUUFBQWIsQ0FBQSxFQUFBYyxDQUFBLFFBQUFoQixDQUFBLEdBQUFpQixNQUFBLENBQUFDLElBQUEsQ0FBQWhCLENBQUEsT0FBQWUsTUFBQSxDQUFBRSxxQkFBQSxR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QUFwSCxLQUFBLE9BQUFlLFNBQUE7TUFBQTtNQUFBLE9BQW5CdUcsbUJBQW1CO0lBQUE7RUFBQTtJQUFBbkYsR0FBQTtJQUFBUCxLQUFBLEVBd0J6QixTQUFBNEYsa0JBQWtCQSxDQUFBLEVBSWhCO01BQ0EsT0FBTztRQUNMQyxVQUFVLEVBQUUsSUFBSTtRQUNoQkMsa0JBQWtCLEVBQUUsSUFBSTtRQUN4QkMsZ0JBQWdCLEVBQUVwSCxNQUFNLENBQUNDLElBQUksQ0FBQ2tCLGdCQUFnQjtNQUNoRCxDQUFDO0lBQ0g7RUFBQztJQUFBUyxHQUFBO0lBQUFQLEtBQUEsRUEzT0QsU0FBT2dHLFdBQVdBLENBQUEsRUFBcUI7TUFDckMsSUFBSTdGLGdCQUFnQixDQUFDOEYsUUFBUSxLQUFLLElBQUksRUFBRTtRQUN0QzlGLGdCQUFnQixDQUFDOEYsUUFBUSxHQUFHLElBQUk5RixnQkFBZ0IsQ0FBQyxDQUFDO01BQ3BEO01BQ0EsT0FBT0EsZ0JBQWdCLENBQUM4RixRQUFRO0lBQ2xDO0VBQUM7QUFBQTtBQVhHOUYsZ0JBQWdCLENBQ0w4RixRQUFRLEdBQTRCLElBQUk7QUFBQSxJQXNQNUNsQyxjQUFjLEdBQUFtQyxPQUFBLENBQUFuQyxjQUFBLGFBQUFvQyxNQUFBO0VBR3pCLFNBQUFwQyxlQUFZQyxPQUFlLEVBQUVvQyxhQUFxQixFQUFFO0lBQUEsSUFBQUMsS0FBQTtJQUFBLElBQUFqRyxnQkFBQSxDQUFBdEMsT0FBQSxRQUFBaUcsY0FBQTtJQUNsRHNDLEtBQUEsR0FBQTVJLFVBQUEsT0FBQXNHLGNBQUEsR0FBTUMsT0FBTztJQUNicUMsS0FBQSxDQUFLQyxJQUFJLEdBQUcsZ0JBQWdCO0lBQzVCRCxLQUFBLENBQUtELGFBQWEsR0FBR0EsYUFBYTtJQUFDLE9BQUFDLEtBQUE7RUFDckM7RUFBQyxJQUFBRSxVQUFBLENBQUF6SSxPQUFBLEVBQUFpRyxjQUFBLEVBQUFvQyxNQUFBO0VBQUEsV0FBQTdGLGFBQUEsQ0FBQXhDLE9BQUEsRUFBQWlHLGNBQUE7QUFBQSxNQUFBeUMsaUJBQUEsQ0FBQTFJLE9BQUEsRUFQaUNpRCxLQUFLO0FBV2xDLElBQU0wRixTQUFTLEdBQUFQLE9BQUEsQ0FBQU8sU0FBQSxHQUFHdEcsZ0JBQWdCLENBQUM2RixXQUFXLENBQUMsQ0FBQztBQUFDLElBQUFVLFFBQUEsR0FBQVIsT0FBQSxDQUFBcEksT0FBQSxHQUl6QzJJLFNBQVMiLCJpZ25vcmVMaXN0IjpbXX0=