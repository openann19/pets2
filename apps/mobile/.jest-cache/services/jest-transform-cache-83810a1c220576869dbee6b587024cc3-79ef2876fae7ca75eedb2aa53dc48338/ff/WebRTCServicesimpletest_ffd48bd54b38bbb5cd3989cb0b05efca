164b710efb94aed44ea2f99cf68d2187
"use strict";

_getJestObj().mock('react-native-incall-manager');
_getJestObj().mock("../api", function () {
  return {
    request: jest.fn()
  };
});
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _WebRTCService = _interopRequireDefault(require("../WebRTCService"));
var _reactNativeIncallManager = _interopRequireDefault(require("react-native-incall-manager"));
var _api = require("../api");
function _getJestObj() {
  var _require = require("@jest/globals"),
    jest = _require.jest;
  _getJestObj = function _getJestObj() {
    return jest;
  };
  return jest;
}
var mockInCallManager = _reactNativeIncallManager.default;
var mockRequest = _api.request;
describe('WebRTCService - Core Tests', function () {
  beforeEach(function () {
    jest.clearAllMocks();
  });
  describe('Service Initialization', function () {
    it('should be a singleton instance', function () {
      expect(_WebRTCService.default).toBeDefined();
      expect(typeof _WebRTCService.default).toBe('object');
    });
    it('should have expected methods', function () {
      expect(typeof _WebRTCService.default.startCall).toBe('function');
      expect(typeof _WebRTCService.default.endCall).toBe('function');
      expect(typeof _WebRTCService.default.toggleMute).toBe('function');
      expect(typeof _WebRTCService.default.toggleVideo).toBe('function');
      expect(typeof _WebRTCService.default.getCallState).toBe('function');
    });
  });
  describe('Call Management', function () {
    it('should start voice call successfully', (0, _asyncToGenerator2.default)(function* () {
      mockRequest.mockResolvedValueOnce({
        callId: 'call123'
      });
      var result = yield _WebRTCService.default.startCall('user123', 'voice');
      expect(result).toBeDefined();
      expect(mockRequest).toHaveBeenCalledWith('/calls/start', expect.objectContaining({
        method: 'POST',
        body: expect.objectContaining({
          targetUserId: 'user123',
          callType: 'voice'
        })
      }));
    }));
    it('should start video call successfully', (0, _asyncToGenerator2.default)(function* () {
      mockRequest.mockResolvedValueOnce({
        callId: 'call456'
      });
      var result = yield _WebRTCService.default.startCall('user456', 'video');
      expect(result).toBeDefined();
      expect(mockRequest).toHaveBeenCalledWith('/calls/start', expect.objectContaining({
        method: 'POST',
        body: expect.objectContaining({
          targetUserId: 'user456',
          callType: 'video'
        })
      }));
    }));
    it('should handle call start errors', (0, _asyncToGenerator2.default)(function* () {
      mockRequest.mockRejectedValueOnce(new Error('User not available'));
      yield expect(_WebRTCService.default.startCall('user123', 'voice')).rejects.toThrow('User not available');
    }));
    it('should end call successfully', (0, _asyncToGenerator2.default)(function* () {
      mockRequest.mockResolvedValueOnce({
        success: true
      });
      var result = yield _WebRTCService.default.endCall();
      expect(result).toBe(true);
      expect(mockRequest).toHaveBeenCalledWith('/calls/end', {
        method: 'POST'
      });
    }));
  });
  describe('Call Controls', function () {
    it('should toggle mute', (0, _asyncToGenerator2.default)(function* () {
      mockRequest.mockResolvedValueOnce({
        muted: true
      });
      var result = yield _WebRTCService.default.toggleMute();
      expect(result).toBeDefined();
      expect(mockRequest).toHaveBeenCalledWith('/calls/mute', {
        method: 'POST'
      });
    }));
    it('should toggle video', (0, _asyncToGenerator2.default)(function* () {
      mockRequest.mockResolvedValueOnce({
        videoEnabled: false
      });
      var result = yield _WebRTCService.default.toggleVideo();
      expect(result).toBeDefined();
      expect(mockRequest).toHaveBeenCalledWith('/calls/video', {
        method: 'POST'
      });
    }));
    it('should switch camera', (0, _asyncToGenerator2.default)(function* () {
      mockRequest.mockResolvedValueOnce({
        camera: 'front'
      });
      var result = yield _WebRTCService.default.switchCamera();
      expect(result).toBeDefined();
      expect(mockRequest).toHaveBeenCalledWith('/calls/camera', {
        method: 'POST'
      });
    }));
  });
  describe('Call State', function () {
    it('should get call state', function () {
      var state = _WebRTCService.default.getCallState();
      expect(state).toBeDefined();
      expect(typeof state).toBe('string');
    });
    it('should check if call is active', function () {
      var isActive = _WebRTCService.default.isCallActive();
      expect(typeof isActive).toBe('boolean');
    });
  });
  describe('WebRTC Signaling', function () {
    it('should handle WebRTC offer', (0, _asyncToGenerator2.default)(function* () {
      var offer = {
        type: 'offer',
        sdp: 'fake-sdp'
      };
      mockRequest.mockResolvedValueOnce({
        answer: 'fake-answer'
      });
      var result = yield _WebRTCService.default.handleOffer('call123', offer);
      expect(result).toBeDefined();
      expect(mockRequest).toHaveBeenCalledWith('/calls/offer', {
        method: 'POST',
        body: {
          callId: 'call123',
          offer: offer
        }
      });
    }));
    it('should handle WebRTC answer', (0, _asyncToGenerator2.default)(function* () {
      var answer = {
        type: 'answer',
        sdp: 'fake-sdp'
      };
      mockRequest.mockResolvedValueOnce({
        success: true
      });
      var result = yield _WebRTCService.default.handleAnswer('call123', answer);
      expect(result).toBeDefined();
      expect(mockRequest).toHaveBeenCalledWith('/calls/answer', {
        method: 'POST',
        body: {
          callId: 'call123',
          answer: answer
        }
      });
    }));
    it('should handle ICE candidates', (0, _asyncToGenerator2.default)(function* () {
      var candidate = {
        candidate: 'fake-candidate'
      };
      mockRequest.mockResolvedValueOnce({
        success: true
      });
      var result = yield _WebRTCService.default.handleIceCandidate('call123', candidate);
      expect(result).toBeDefined();
      expect(mockRequest).toHaveBeenCalledWith('/calls/ice', {
        method: 'POST',
        body: {
          callId: 'call123',
          candidate: candidate
        }
      });
    }));
  });
  describe('Error Handling', function () {
    it('should handle network errors during call start', (0, _asyncToGenerator2.default)(function* () {
      mockRequest.mockRejectedValueOnce(new Error('Network error'));
      yield expect(_WebRTCService.default.startCall('user123', 'voice')).rejects.toThrow('Network error');
    }));
    it('should handle API errors during call controls', (0, _asyncToGenerator2.default)(function* () {
      mockRequest.mockRejectedValueOnce(new Error('Call not active'));
      yield expect(_WebRTCService.default.toggleMute()).rejects.toThrow('Call not active');
    }));
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJyZXF1ZXN0IiwiamVzdCIsImZuIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJfV2ViUlRDU2VydmljZSIsIl9yZWFjdE5hdGl2ZUluY2FsbE1hbmFnZXIiLCJfYXBpIiwiX3JlcXVpcmUiLCJtb2NrSW5DYWxsTWFuYWdlciIsIkluQ2FsbE1hbmFnZXIiLCJtb2NrUmVxdWVzdCIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJpdCIsImV4cGVjdCIsIldlYlJUQ1NlcnZpY2UiLCJ0b0JlRGVmaW5lZCIsInRvQmUiLCJzdGFydENhbGwiLCJlbmRDYWxsIiwidG9nZ2xlTXV0ZSIsInRvZ2dsZVZpZGVvIiwiZ2V0Q2FsbFN0YXRlIiwiZGVmYXVsdCIsIm1vY2tSZXNvbHZlZFZhbHVlT25jZSIsImNhbGxJZCIsInJlc3VsdCIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwib2JqZWN0Q29udGFpbmluZyIsIm1ldGhvZCIsImJvZHkiLCJ0YXJnZXRVc2VySWQiLCJjYWxsVHlwZSIsIm1vY2tSZWplY3RlZFZhbHVlT25jZSIsIkVycm9yIiwicmVqZWN0cyIsInRvVGhyb3ciLCJzdWNjZXNzIiwibXV0ZWQiLCJ2aWRlb0VuYWJsZWQiLCJjYW1lcmEiLCJzd2l0Y2hDYW1lcmEiLCJzdGF0ZSIsImlzQWN0aXZlIiwiaXNDYWxsQWN0aXZlIiwib2ZmZXIiLCJ0eXBlIiwic2RwIiwiYW5zd2VyIiwiaGFuZGxlT2ZmZXIiLCJoYW5kbGVBbnN3ZXIiLCJjYW5kaWRhdGUiLCJoYW5kbGVJY2VDYW5kaWRhdGUiXSwic291cmNlcyI6WyJXZWJSVENTZXJ2aWNlLnNpbXBsZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU2ltcGxpZmllZCBXZWJSVEMgU2VydmljZSBUZXN0cyAtIENvcmUgZnVuY3Rpb25hbGl0eVxuICovXG5cbmltcG9ydCBXZWJSVENTZXJ2aWNlIGZyb20gJy4uL1dlYlJUQ1NlcnZpY2UnO1xuXG4vLyBNb2NrIGRlcGVuZGVuY2llc1xuamVzdC5tb2NrKCdyZWFjdC1uYXRpdmUtaW5jYWxsLW1hbmFnZXInKTtcbmplc3QubW9jaygnLi4vYXBpJywgKCkgPT4gKHtcbiAgcmVxdWVzdDogamVzdC5mbigpLFxufSkpO1xuXG5pbXBvcnQgSW5DYWxsTWFuYWdlciBmcm9tICdyZWFjdC1uYXRpdmUtaW5jYWxsLW1hbmFnZXInO1xuaW1wb3J0IHsgcmVxdWVzdCB9IGZyb20gJy4uL2FwaSc7XG5cbmNvbnN0IG1vY2tJbkNhbGxNYW5hZ2VyID0gSW5DYWxsTWFuYWdlciBhcyBqZXN0Lk1vY2tlZDx0eXBlb2YgSW5DYWxsTWFuYWdlcj47XG5jb25zdCBtb2NrUmVxdWVzdCA9IHJlcXVlc3QgYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2YgcmVxdWVzdD47XG5cbmRlc2NyaWJlKCdXZWJSVENTZXJ2aWNlIC0gQ29yZSBUZXN0cycsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZXJ2aWNlIEluaXRpYWxpemF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYmUgYSBzaW5nbGV0b24gaW5zdGFuY2UnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoV2ViUlRDU2VydmljZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgV2ViUlRDU2VydmljZSkudG9CZSgnb2JqZWN0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgZXhwZWN0ZWQgbWV0aG9kcycsICgpID0+IHtcbiAgICAgIGV4cGVjdCh0eXBlb2YgV2ViUlRDU2VydmljZS5zdGFydENhbGwpLnRvQmUoJ2Z1bmN0aW9uJyk7XG4gICAgICBleHBlY3QodHlwZW9mIFdlYlJUQ1NlcnZpY2UuZW5kQ2FsbCkudG9CZSgnZnVuY3Rpb24nKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgV2ViUlRDU2VydmljZS50b2dnbGVNdXRlKS50b0JlKCdmdW5jdGlvbicpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBXZWJSVENTZXJ2aWNlLnRvZ2dsZVZpZGVvKS50b0JlKCdmdW5jdGlvbicpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBXZWJSVENTZXJ2aWNlLmdldENhbGxTdGF0ZSkudG9CZSgnZnVuY3Rpb24nKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NhbGwgTWFuYWdlbWVudCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHN0YXJ0IHZvaWNlIGNhbGwgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1JlcXVlc3QubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHsgY2FsbElkOiAnY2FsbDEyMycgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFdlYlJUQ1NlcnZpY2Uuc3RhcnRDYWxsKCd1c2VyMTIzJywgJ3ZvaWNlJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QobW9ja1JlcXVlc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvY2FsbHMvc3RhcnQnLCBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBib2R5OiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgdGFyZ2V0VXNlcklkOiAndXNlcjEyMycsXG4gICAgICAgICAgY2FsbFR5cGU6ICd2b2ljZScsXG4gICAgICAgIH0pLFxuICAgICAgfSkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzdGFydCB2aWRlbyBjYWxsIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tSZXF1ZXN0Lm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7IGNhbGxJZDogJ2NhbGw0NTYnIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBXZWJSVENTZXJ2aWNlLnN0YXJ0Q2FsbCgndXNlcjQ1NicsICd2aWRlbycpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KG1vY2tSZXF1ZXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2NhbGxzL3N0YXJ0JywgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIHRhcmdldFVzZXJJZDogJ3VzZXI0NTYnLFxuICAgICAgICAgIGNhbGxUeXBlOiAndmlkZW8nLFxuICAgICAgICB9KSxcbiAgICAgIH0pKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNhbGwgc3RhcnQgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1JlcXVlc3QubW9ja1JlamVjdGVkVmFsdWVPbmNlKG5ldyBFcnJvcignVXNlciBub3QgYXZhaWxhYmxlJykpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoV2ViUlRDU2VydmljZS5zdGFydENhbGwoJ3VzZXIxMjMnLCAndm9pY2UnKSkucmVqZWN0cy50b1Rocm93KCdVc2VyIG5vdCBhdmFpbGFibGUnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW5kIGNhbGwgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1JlcXVlc3QubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHsgc3VjY2VzczogdHJ1ZSB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgV2ViUlRDU2VydmljZS5lbmRDYWxsKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QobW9ja1JlcXVlc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvY2FsbHMvZW5kJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ2FsbCBDb250cm9scycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHRvZ2dsZSBtdXRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1JlcXVlc3QubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHsgbXV0ZWQ6IHRydWUgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFdlYlJUQ1NlcnZpY2UudG9nZ2xlTXV0ZSgpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KG1vY2tSZXF1ZXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2NhbGxzL211dGUnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRvZ2dsZSB2aWRlbycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tSZXF1ZXN0Lm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7IHZpZGVvRW5hYmxlZDogZmFsc2UgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFdlYlJUQ1NlcnZpY2UudG9nZ2xlVmlkZW8oKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrUmVxdWVzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9jYWxscy92aWRlbycsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3dpdGNoIGNhbWVyYScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tSZXF1ZXN0Lm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7IGNhbWVyYTogJ2Zyb250JyB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgV2ViUlRDU2VydmljZS5zd2l0Y2hDYW1lcmEoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrUmVxdWVzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9jYWxscy9jYW1lcmEnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDYWxsIFN0YXRlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZ2V0IGNhbGwgc3RhdGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdGF0ZSA9IFdlYlJUQ1NlcnZpY2UuZ2V0Q2FsbFN0YXRlKCk7XG5cbiAgICAgIGV4cGVjdChzdGF0ZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh0eXBlb2Ygc3RhdGUpLnRvQmUoJ3N0cmluZycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjaGVjayBpZiBjYWxsIGlzIGFjdGl2ZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGlzQWN0aXZlID0gV2ViUlRDU2VydmljZS5pc0NhbGxBY3RpdmUoKTtcblxuICAgICAgZXhwZWN0KHR5cGVvZiBpc0FjdGl2ZSkudG9CZSgnYm9vbGVhbicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnV2ViUlRDIFNpZ25hbGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBXZWJSVEMgb2ZmZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBvZmZlciA9IHsgdHlwZTogJ29mZmVyJywgc2RwOiAnZmFrZS1zZHAnIH07XG4gICAgICBtb2NrUmVxdWVzdC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoeyBhbnN3ZXI6ICdmYWtlLWFuc3dlcicgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFdlYlJUQ1NlcnZpY2UuaGFuZGxlT2ZmZXIoJ2NhbGwxMjMnLCBvZmZlcik7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QobW9ja1JlcXVlc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvY2FsbHMvb2ZmZXInLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBib2R5OiB7IGNhbGxJZDogJ2NhbGwxMjMnLCBvZmZlciB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBXZWJSVEMgYW5zd2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYW5zd2VyID0geyB0eXBlOiAnYW5zd2VyJywgc2RwOiAnZmFrZS1zZHAnIH07XG4gICAgICBtb2NrUmVxdWVzdC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoeyBzdWNjZXNzOiB0cnVlIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBXZWJSVENTZXJ2aWNlLmhhbmRsZUFuc3dlcignY2FsbDEyMycsIGFuc3dlcik7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QobW9ja1JlcXVlc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvY2FsbHMvYW5zd2VyJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogeyBjYWxsSWQ6ICdjYWxsMTIzJywgYW5zd2VyIH0sXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIElDRSBjYW5kaWRhdGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY2FuZGlkYXRlID0geyBjYW5kaWRhdGU6ICdmYWtlLWNhbmRpZGF0ZScgfTtcbiAgICAgIG1vY2tSZXF1ZXN0Lm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7IHN1Y2Nlc3M6IHRydWUgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFdlYlJUQ1NlcnZpY2UuaGFuZGxlSWNlQ2FuZGlkYXRlKCdjYWxsMTIzJywgY2FuZGlkYXRlKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrUmVxdWVzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9jYWxscy9pY2UnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBib2R5OiB7IGNhbGxJZDogJ2NhbGwxMjMnLCBjYW5kaWRhdGUgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbmV0d29yayBlcnJvcnMgZHVyaW5nIGNhbGwgc3RhcnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUmVxdWVzdC5tb2NrUmVqZWN0ZWRWYWx1ZU9uY2UobmV3IEVycm9yKCdOZXR3b3JrIGVycm9yJykpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoV2ViUlRDU2VydmljZS5zdGFydENhbGwoJ3VzZXIxMjMnLCAndm9pY2UnKSkucmVqZWN0cy50b1Rocm93KCdOZXR3b3JrIGVycm9yJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBBUEkgZXJyb3JzIGR1cmluZyBjYWxsIGNvbnRyb2xzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1JlcXVlc3QubW9ja1JlamVjdGVkVmFsdWVPbmNlKG5ldyBFcnJvcignQ2FsbCBub3QgYWN0aXZlJykpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoV2ViUlRDU2VydmljZS50b2dnbGVNdXRlKCkpLnJlamVjdHMudG9UaHJvdygnQ2FsbCBub3QgYWN0aXZlJyk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwibWFwcGluZ3MiOiI7O0FBT0FBLFdBQUEsR0FBS0MsSUFBSSxDQUFDLDZCQUE2QixDQUFDO0FBQ3hDRCxXQUFBLEdBQUtDLElBQUksV0FBVztFQUFBLE9BQU87SUFDekJDLE9BQU8sRUFBRUMsSUFBSSxDQUFDQyxFQUFFLENBQUM7RUFDbkIsQ0FBQztBQUFBLENBQUMsQ0FBQztBQUFDLElBQUFDLHNCQUFBLEdBQUFDLE9BQUE7QUFBQSxJQUFBQyxrQkFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBTkosSUFBQUUsY0FB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