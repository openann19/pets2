eda94f620ebb8292f41b563fa7d1a5d6
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.usePhotoManager = void 0;
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var ImagePicker = _interopRequireWildcard(require("expo-image-picker"));
var _react = require("react");
var _reactNative = require("react-native");
var _multipartUpload = require("../services/multipartUpload");
var _core = require("@pawfectmatch/core");
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function _interopRequireWildcard(e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (var _t in e) "default" !== _t && {}.hasOwnProperty.call(e, _t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, _t)) && (i.get || i.set) ? o(f, _t, i) : f[_t] = e[_t]); return f; })(e, t); }
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
var usePhotoManager = exports.usePhotoManager = function usePhotoManager() {
  var _useState = (0, _react.useState)([]),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    photos = _useState2[0],
    setPhotos = _useState2[1];
  var pickImage = function () {
    var _ref = (0, _asyncToGenerator2.default)(function* () {
      try {
        var _yield$ImagePicker$re = yield ImagePicker.requestMediaLibraryPermissionsAsync(),
          status = _yield$ImagePicker$re.status;
        if (status !== "granted") {
          _reactNative.Alert.alert("Permission needed", "Please grant permission to access your photos");
          return;
        }
        var result = yield ImagePicker.launchImageLibraryAsync({
          mediaTypes: ImagePicker.MediaTypeOptions.Images,
          allowsEditing: true,
          aspect: [4, 3],
          quality: 0.8,
          allowsMultipleSelection: true,
          selectionLimit: 10 - photos.length
        });
        if (!result.canceled && result.assets.length > 0) {
          var newPhotos = result.assets.map(function (asset, index) {
            return {
              uri: asset.uri,
              type: asset.type || "image/jpeg",
              fileName: `pet-photo-${Date.now()}-${index}.jpg`,
              isPrimary: photos.length === 0 && index === 0,
              isUploading: false
            };
          });
          setPhotos(function (prev) {
            return [].concat((0, _toConsumableArray2.default)(prev), (0, _toConsumableArray2.default)(newPhotos));
          });
          yield uploadPhotos(newPhotos);
        }
      } catch (error) {
        _core.logger.error("Error picking images:", {
          error: error
        });
        _reactNative.Alert.alert("Error", "Failed to pick images. Please try again.");
      }
    });
    return function pickImage() {
      return _ref.apply(this, arguments);
    };
  }();
  var uploadPhotos = (0, _react.useCallback)(function () {
    var _ref2 = (0, _asyncToGenerator2.default)(function* (photosToUpload) {
      var _loop = function* _loop(photo) {
        try {
          setPhotos(function (prev) {
            var photoIndex = prev.findIndex(function (p) {
              return p.uri === photo.uri;
            });
            if (photoIndex === -1) return prev;
            return prev.map(function (p, i) {
              return i === photoIndex ? _objectSpread(_objectSpread({}, p), {}, {
                isUploading: true,
                error: undefined
              }) : p;
            });
          });
          var uploadResult = yield (0, _multipartUpload.multipartUpload)({
            fileUri: photo.uri,
            contentType: photo.type,
            onProgress: function onProgress(uploaded, total) {
              var percentage = Math.round(uploaded / total * 100);
              setPhotos(function (prev) {
                var photoIndex = prev.findIndex(function (p) {
                  return p.uri === photo.uri;
                });
                if (photoIndex === -1) return prev;
                return prev.map(function (p, i) {
                  return i === photoIndex ? _objectSpread(_objectSpread({}, p), {}, {
                    uploadProgress: {
                      uploaded: uploaded,
                      total: total,
                      percentage: percentage
                    }
                  }) : p;
                });
              });
            }
          });
          setPhotos(function (prev) {
            var photoIndex = prev.findIndex(function (p) {
              return p.uri === photo.uri;
            });
            if (photoIndex === -1) return prev;
            return prev.map(function (p, i) {
              return i === photoIndex ? _objectSpread(_objectSpread({}, p), {}, {
                isUploading: false,
                uploadedUrl: uploadResult.url,
                thumbnailUrl: uploadResult.thumbnails.webp,
                s3Key: uploadResult.key,
                uploadProgress: undefined
              }) : p;
            });
          });
          _core.logger.info("Photo uploaded successfully:", {
            photo: photo,
            url: uploadResult.url
          });
        } catch (error) {
          _core.logger.error("Error uploading photo:", {
            error: error,
            photo: photo.uri
          });
          setPhotos(function (prev) {
            var photoIndex = prev.findIndex(function (p) {
              return p.uri === photo.uri;
            });
            if (photoIndex === -1) return prev;
            return prev.map(function (p, i) {
              return i === photoIndex ? _objectSpread(_objectSpread({}, p), {}, {
                isUploading: false,
                error: "Upload failed"
              }) : p;
            });
          });
          _reactNative.Alert.alert("Upload Failed", `Failed to upload ${photo.fileName}. Please try again.`);
        }
      };
      for (var photo of photosToUpload) {
        yield* _loop(photo);
      }
    });
    return function (_x) {
      return _ref2.apply(this, arguments);
    };
  }(), []);
  var removePhoto = function removePhoto(index) {
    setPhotos(function (prev) {
      var photoToRemove = prev[index];
      var newPhotos = prev.filter(function (_, i) {
        return i !== index;
      });
      if (photoToRemove != null && photoToRemove.isPrimary && newPhotos.length > 0) {
        var firstPhoto = newPhotos[0];
        if (firstPhoto) {
          firstPhoto.isPrimary = true;
        }
      }
      return newPhotos;
    });
  };
  var setPrimaryPhoto = function setPrimaryPhoto(index) {
    setPhotos(function (prev) {
      return prev.map(function (photo, i) {
        return _objectSpread(_objectSpread({}, photo), {}, {
          isPrimary: i === index
        });
      });
    });
  };
  var uploadPendingPhotos = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    setPhotos(function (prev) {
      var pendingPhotos = prev.filter(function (p) {
        return !p.uploadedUrl && !p.isUploading && !p.error;
      });
      if (pendingPhotos.length > 0) {
        uploadPhotos(pendingPhotos).catch(function (error) {
          _core.logger.error("Error uploading pending photos:", {
            error: error
          });
        });
      }
      return prev;
    });
  }), [uploadPhotos]);
  return {
    photos: photos,
    pickImage: pickImage,
    removePhoto: removePhoto,
    setPrimaryPhoto: setPrimaryPhoto,
    uploadPendingPhotos: uploadPendingPhotos
  };
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJJbWFnZVBpY2tlciIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwicmVxdWlyZSIsIl9yZWFjdCIsIl9yZWFjdE5hdGl2ZSIsIl9tdWx0aXBhcnRVcGxvYWQiLCJfY29yZSIsImUiLCJ0IiwiV2Vha01hcCIsInIiLCJuIiwiX19lc01vZHVsZSIsIm8iLCJpIiwiZiIsIl9fcHJvdG9fXyIsImRlZmF1bHQiLCJoYXMiLCJnZXQiLCJzZXQiLCJfdCIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwib3duS2V5cyIsImtleXMiLCJnZXRPd25Qcm9wZXJ0eVN5bWJvbHMiLCJmaWx0ZXIiLCJlbnVtZXJhYmxlIiwicHVzaCIsImFwcGx5IiwiX29iamVjdFNwcmVhZCIsImFyZ3VtZW50cyIsImxlbmd0aCIsImZvckVhY2giLCJfZGVmaW5lUHJvcGVydHkyIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyIsImRlZmluZVByb3BlcnRpZXMiLCJ1c2VQaG90b01hbmFnZXIiLCJleHBvcnRzIiwiX3VzZVN0YXRlIiwidXNlU3RhdGUiLCJfdXNlU3RhdGUyIiwiX3NsaWNlZFRvQXJyYXkyIiwicGhvdG9zIiwic2V0UGhvdG9zIiwicGlja0ltYWdlIiwiX3JlZiIsIl9hc3luY1RvR2VuZXJhdG9yMiIsIl95aWVsZCRJbWFnZVBpY2tlciRyZSIsInJlcXVlc3RNZWRpYUxpYnJhcnlQZXJtaXNzaW9uc0FzeW5jIiwic3RhdHVzIiwiQWxlcnQiLCJhbGVydCIsInJlc3VsdCIsImxhdW5jaEltYWdlTGlicmFyeUFzeW5jIiwibWVkaWFUeXBlcyIsIk1lZGlhVHlwZU9wdGlvbnMiLCJJbWFnZXMiLCJhbGxvd3NFZGl0aW5nIiwiYXNwZWN0IiwicXVhbGl0eSIsImFsbG93c011bHRpcGxlU2VsZWN0aW9uIiwic2VsZWN0aW9uTGltaXQiLCJjYW5jZWxlZCIsImFzc2V0cyIsIm5ld1Bob3RvcyIsIm1hcCIsImFzc2V0IiwiaW5kZXgiLCJ1cmkiLCJ0eXBlIiwiZmlsZU5hbWUiLCJEYXRlIiwibm93IiwiaXNQcmltYXJ5IiwiaXNVcGxvYWRpbmciLCJwcmV2IiwiY29uY2F0IiwiX3RvQ29uc3VtYWJsZUFycmF5MiIsInVwbG9hZFBob3RvcyIsImVycm9yIiwibG9nZ2VyIiwidXNlQ2FsbGJhY2siLCJfcmVmMiIsInBob3Rvc1RvVXBsb2FkIiwiX2xvb3AiLCJwaG90byIsInBob3RvSW5kZXgiLCJmaW5kSW5kZXgiLCJwIiwidW5kZWZpbmVkIiwidXBsb2FkUmVzdWx0IiwibXVsdGlwYXJ0VXBsb2FkIiwiZmlsZVVyaSIsImNvbnRlbnRUeXBlIiwib25Qcm9ncmVzcyIsInVwbG9hZGVkIiwidG90YWwiLCJwZXJjZW50YWdlIiwiTWF0aCIsInJvdW5kIiwidXBsb2FkUHJvZ3Jlc3MiLCJ1cGxvYWRlZFVybCIsInVybCIsInRodW1ibmFpbFVybCIsInRodW1ibmFpbHMiLCJ3ZWJwIiwiczNLZXkiLCJrZXkiLCJpbmZvIiwiX3giLCJyZW1vdmVQaG90byIsInBob3RvVG9SZW1vdmUiLCJfIiwiZmlyc3RQaG90byIsInNldFByaW1hcnlQaG90byIsInVwbG9hZFBlbmRpbmdQaG90b3MiLCJwZW5kaW5nUGhvdG9zIiwiY2F0Y2giXSwic291cmNlcyI6WyJ1c2VQaG90b01hbmFnZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgSW1hZ2VQaWNrZXIgZnJvbSBcImV4cG8taW1hZ2UtcGlja2VyXCI7XG5pbXBvcnQgeyB1c2VTdGF0ZSwgdXNlQ2FsbGJhY2sgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IEFsZXJ0IH0gZnJvbSBcInJlYWN0LW5hdGl2ZVwiO1xuaW1wb3J0IHsgbXVsdGlwYXJ0VXBsb2FkIH0gZnJvbSBcIi4uL3NlcnZpY2VzL211bHRpcGFydFVwbG9hZFwiO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSBcIkBwYXdmZWN0bWF0Y2gvY29yZVwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIFVwbG9hZFByb2dyZXNzIHtcbiAgdXBsb2FkZWQ6IG51bWJlcjtcbiAgdG90YWw6IG51bWJlcjtcbiAgcGVyY2VudGFnZTogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBob3RvRGF0YSB7XG4gIHVyaTogc3RyaW5nO1xuICB0eXBlOiBzdHJpbmc7XG4gIGZpbGVOYW1lOiBzdHJpbmc7XG4gIGlzUHJpbWFyeTogYm9vbGVhbjtcbiAgLy8gVXBsb2FkIHRyYWNraW5nXG4gIGlzVXBsb2FkaW5nPzogYm9vbGVhbjtcbiAgdXBsb2FkUHJvZ3Jlc3M/OiBVcGxvYWRQcm9ncmVzcztcbiAgdXBsb2FkZWRVcmw/OiBzdHJpbmc7XG4gIHRodW1ibmFpbFVybD86IHN0cmluZztcbiAgczNLZXk/OiBzdHJpbmc7XG4gIGVycm9yPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVzZVBob3RvTWFuYWdlclJldHVybiB7XG4gIHBob3RvczogUGhvdG9EYXRhW107XG4gIHBpY2tJbWFnZTogKCkgPT4gUHJvbWlzZTx2b2lkPjtcbiAgcmVtb3ZlUGhvdG86IChpbmRleDogbnVtYmVyKSA9PiB2b2lkO1xuICBzZXRQcmltYXJ5UGhvdG86IChpbmRleDogbnVtYmVyKSA9PiB2b2lkO1xuICB1cGxvYWRQZW5kaW5nUGhvdG9zOiAoKSA9PiBQcm9taXNlPHZvaWQ+O1xufVxuXG5leHBvcnQgY29uc3QgdXNlUGhvdG9NYW5hZ2VyID0gKCk6IFVzZVBob3RvTWFuYWdlclJldHVybiA9PiB7XG4gIGNvbnN0IFtwaG90b3MsIHNldFBob3Rvc10gPSB1c2VTdGF0ZTxQaG90b0RhdGFbXT4oW10pO1xuXG4gIGNvbnN0IHBpY2tJbWFnZSA9IGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBzdGF0dXMgfSA9IGF3YWl0IEltYWdlUGlja2VyLnJlcXVlc3RNZWRpYUxpYnJhcnlQZXJtaXNzaW9uc0FzeW5jKCk7XG5cbiAgICAgIGlmIChzdGF0dXMgIT09IFwiZ3JhbnRlZFwiKSB7XG4gICAgICAgIEFsZXJ0LmFsZXJ0KFxuICAgICAgICAgIFwiUGVybWlzc2lvbiBuZWVkZWRcIixcbiAgICAgICAgICBcIlBsZWFzZSBncmFudCBwZXJtaXNzaW9uIHRvIGFjY2VzcyB5b3VyIHBob3Rvc1wiLFxuICAgICAgICApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IEltYWdlUGlja2VyLmxhdW5jaEltYWdlTGlicmFyeUFzeW5jKHtcbiAgICAgICAgbWVkaWFUeXBlczogSW1hZ2VQaWNrZXIuTWVkaWFUeXBlT3B0aW9ucy5JbWFnZXMsXG4gICAgICAgIGFsbG93c0VkaXRpbmc6IHRydWUsXG4gICAgICAgIGFzcGVjdDogWzQsIDNdLFxuICAgICAgICBxdWFsaXR5OiAwLjgsXG4gICAgICAgIGFsbG93c011bHRpcGxlU2VsZWN0aW9uOiB0cnVlLFxuICAgICAgICBzZWxlY3Rpb25MaW1pdDogMTAgLSBwaG90b3MubGVuZ3RoLFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzdWx0LmNhbmNlbGVkICYmIHJlc3VsdC5hc3NldHMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBuZXdQaG90b3M6IFBob3RvRGF0YVtdID0gcmVzdWx0LmFzc2V0cy5tYXAoKGFzc2V0OiBhbnksIGluZGV4OiBudW1iZXIpID0+ICh7XG4gICAgICAgICAgdXJpOiBhc3NldC51cmksXG4gICAgICAgICAgdHlwZTogYXNzZXQudHlwZSB8fCBcImltYWdlL2pwZWdcIixcbiAgICAgICAgICBmaWxlTmFtZTogYHBldC1waG90by0ke0RhdGUubm93KCl9LSR7aW5kZXh9LmpwZ2AsXG4gICAgICAgICAgaXNQcmltYXJ5OiBwaG90b3MubGVuZ3RoID09PSAwICYmIGluZGV4ID09PSAwLFxuICAgICAgICAgIGlzVXBsb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHNldFBob3RvcygocHJldikgPT4gWy4uLnByZXYsIC4uLm5ld1Bob3Rvc10pO1xuXG4gICAgICAgIC8vIEF1dG9tYXRpY2FsbHkgdXBsb2FkIHRoZSBuZXcgcGhvdG9zXG4gICAgICAgIGF3YWl0IHVwbG9hZFBob3RvcyhuZXdQaG90b3MpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXCJFcnJvciBwaWNraW5nIGltYWdlczpcIiwgeyBlcnJvciB9KTtcbiAgICAgIEFsZXJ0LmFsZXJ0KFwiRXJyb3JcIiwgXCJGYWlsZWQgdG8gcGljayBpbWFnZXMuIFBsZWFzZSB0cnkgYWdhaW4uXCIpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCB1cGxvYWRQaG90b3MgPSB1c2VDYWxsYmFjayhhc3luYyAocGhvdG9zVG9VcGxvYWQ6IFBob3RvRGF0YVtdKSA9PiB7XG4gICAgZm9yIChjb25zdCBwaG90byBvZiBwaG90b3NUb1VwbG9hZCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gTWFyayBwaG90byBhcyB1cGxvYWRpbmcgdXNpbmcgZnVuY3Rpb25hbCB1cGRhdGUgdG8gYXZvaWQgc3RhbGUgc3RhdGVcbiAgICAgICAgc2V0UGhvdG9zKChwcmV2KSA9PiB7XG4gICAgICAgICAgY29uc3QgcGhvdG9JbmRleCA9IHByZXYuZmluZEluZGV4KChwKSA9PiBwLnVyaSA9PT0gcGhvdG8udXJpKTtcbiAgICAgICAgICBpZiAocGhvdG9JbmRleCA9PT0gLTEpIHJldHVybiBwcmV2O1xuXG4gICAgICAgICAgcmV0dXJuIHByZXYubWFwKChwLCBpKSA9PlxuICAgICAgICAgICAgaSA9PT0gcGhvdG9JbmRleFxuICAgICAgICAgICAgICA/IHsgLi4ucCwgaXNVcGxvYWRpbmc6IHRydWUsIGVycm9yOiB1bmRlZmluZWQgfVxuICAgICAgICAgICAgICA6IHAsXG4gICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU3RhcnQgbXVsdGlwYXJ0IHVwbG9hZCB3aXRoIHByb2dyZXNzIHRyYWNraW5nXG4gICAgICAgIGNvbnN0IHVwbG9hZFJlc3VsdCA9IGF3YWl0IG11bHRpcGFydFVwbG9hZCh7XG4gICAgICAgICAgZmlsZVVyaTogcGhvdG8udXJpLFxuICAgICAgICAgIGNvbnRlbnRUeXBlOiBwaG90by50eXBlLFxuICAgICAgICAgIG9uUHJvZ3Jlc3M6ICh1cGxvYWRlZCwgdG90YWwpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHBlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKCh1cGxvYWRlZCAvIHRvdGFsKSAqIDEwMCk7XG4gICAgICAgICAgICBzZXRQaG90b3MoKHByZXYpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgcGhvdG9JbmRleCA9IHByZXYuZmluZEluZGV4KChwKSA9PiBwLnVyaSA9PT0gcGhvdG8udXJpKTtcbiAgICAgICAgICAgICAgaWYgKHBob3RvSW5kZXggPT09IC0xKSByZXR1cm4gcHJldjtcblxuICAgICAgICAgICAgICByZXR1cm4gcHJldi5tYXAoKHAsIGkpID0+XG4gICAgICAgICAgICAgICAgaSA9PT0gcGhvdG9JbmRleFxuICAgICAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAgICAgLi4ucCxcbiAgICAgICAgICAgICAgICAgICAgICB1cGxvYWRQcm9ncmVzczogeyB1cGxvYWRlZCwgdG90YWwsIHBlcmNlbnRhZ2UgfSxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgOiBwLFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gTWFyayBwaG90byBhcyBzdWNjZXNzZnVsbHkgdXBsb2FkZWRcbiAgICAgICAgc2V0UGhvdG9zKChwcmV2KSA9PiB7XG4gICAgICAgICAgY29uc3QgcGhvdG9JbmRleCA9IHByZXYuZmluZEluZGV4KChwKSA9PiBwLnVyaSA9PT0gcGhvdG8udXJpKTtcbiAgICAgICAgICBpZiAocGhvdG9JbmRleCA9PT0gLTEpIHJldHVybiBwcmV2O1xuXG4gICAgICAgICAgcmV0dXJuIHByZXYubWFwKChwLCBpKSA9PlxuICAgICAgICAgICAgaSA9PT0gcGhvdG9JbmRleFxuICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgIC4uLnAsXG4gICAgICAgICAgICAgICAgICBpc1VwbG9hZGluZzogZmFsc2UsXG4gICAgICAgICAgICAgICAgICB1cGxvYWRlZFVybDogdXBsb2FkUmVzdWx0LnVybCxcbiAgICAgICAgICAgICAgICAgIHRodW1ibmFpbFVybDogdXBsb2FkUmVzdWx0LnRodW1ibmFpbHMud2VicCxcbiAgICAgICAgICAgICAgICAgIHMzS2V5OiB1cGxvYWRSZXN1bHQua2V5LFxuICAgICAgICAgICAgICAgICAgdXBsb2FkUHJvZ3Jlc3M6IHVuZGVmaW5lZCwgLy8gQ2xlYXIgcHJvZ3Jlc3Mgb24gc3VjY2Vzc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgOiBwLFxuICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxvZ2dlci5pbmZvKFwiUGhvdG8gdXBsb2FkZWQgc3VjY2Vzc2Z1bGx5OlwiLCB7IHBob3RvLCB1cmw6IHVwbG9hZFJlc3VsdC51cmwgfSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXCJFcnJvciB1cGxvYWRpbmcgcGhvdG86XCIsIHsgZXJyb3IsIHBob3RvOiBwaG90by51cmkgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBNYXJrIHBob3RvIHdpdGggZXJyb3JcbiAgICAgICAgc2V0UGhvdG9zKChwcmV2KSA9PiB7XG4gICAgICAgICAgY29uc3QgcGhvdG9JbmRleCA9IHByZXYuZmluZEluZGV4KChwKSA9PiBwLnVyaSA9PT0gcGhvdG8udXJpKTtcbiAgICAgICAgICBpZiAocGhvdG9JbmRleCA9PT0gLTEpIHJldHVybiBwcmV2O1xuXG4gICAgICAgICAgcmV0dXJuIHByZXYubWFwKChwLCBpKSA9PlxuICAgICAgICAgICAgaSA9PT0gcGhvdG9JbmRleFxuICAgICAgICAgICAgICA/IHsgLi4ucCwgaXNVcGxvYWRpbmc6IGZhbHNlLCBlcnJvcjogXCJVcGxvYWQgZmFpbGVkXCIgfVxuICAgICAgICAgICAgICA6IHAsXG4gICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgQWxlcnQuYWxlcnQoXG4gICAgICAgICAgXCJVcGxvYWQgRmFpbGVkXCIsXG4gICAgICAgICAgYEZhaWxlZCB0byB1cGxvYWQgJHtwaG90by5maWxlTmFtZX0uIFBsZWFzZSB0cnkgYWdhaW4uYCxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIFtdKTtcblxuICBjb25zdCByZW1vdmVQaG90byA9IChpbmRleDogbnVtYmVyKSA9PiB7XG4gICAgc2V0UGhvdG9zKChwcmV2KSA9PiB7XG4gICAgICBjb25zdCBwaG90b1RvUmVtb3ZlID0gcHJldltpbmRleF07XG4gICAgICBjb25zdCBuZXdQaG90b3MgPSBwcmV2LmZpbHRlcigoXywgaSkgPT4gaSAhPT0gaW5kZXgpO1xuICAgICAgLy8gSWYgd2UgcmVtb3ZlZCB0aGUgcHJpbWFyeSBwaG90bywgbWFrZSB0aGUgZmlyc3QgcmVtYWluaW5nIHBob3RvIHByaW1hcnlcbiAgICAgIGlmIChwaG90b1RvUmVtb3ZlPy5pc1ByaW1hcnkgJiYgbmV3UGhvdG9zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgZmlyc3RQaG90byA9IG5ld1Bob3Rvc1swXTtcbiAgICAgICAgaWYgKGZpcnN0UGhvdG8pIHtcbiAgICAgICAgICBmaXJzdFBob3RvLmlzUHJpbWFyeSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBuZXdQaG90b3M7XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3Qgc2V0UHJpbWFyeVBob3RvID0gKGluZGV4OiBudW1iZXIpID0+IHtcbiAgICBzZXRQaG90b3MoKHByZXYpID0+XG4gICAgICBwcmV2Lm1hcCgocGhvdG8sIGkpID0+ICh7XG4gICAgICAgIC4uLnBob3RvLFxuICAgICAgICBpc1ByaW1hcnk6IGkgPT09IGluZGV4LFxuICAgICAgfSkpLFxuICAgICk7XG4gIH07XG5cbiAgY29uc3QgdXBsb2FkUGVuZGluZ1Bob3RvcyA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcbiAgICBzZXRQaG90b3MoKHByZXYpID0+IHtcbiAgICAgIGNvbnN0IHBlbmRpbmdQaG90b3MgPSBwcmV2LmZpbHRlcihcbiAgICAgICAgKHApID0+ICFwLnVwbG9hZGVkVXJsICYmICFwLmlzVXBsb2FkaW5nICYmICFwLmVycm9yLFxuICAgICAgKTtcblxuICAgICAgaWYgKHBlbmRpbmdQaG90b3MubGVuZ3RoID4gMCkge1xuICAgICAgICAvLyBVcGxvYWQgaW4gYmFja2dyb3VuZCB3aXRob3V0IGJsb2NraW5nXG4gICAgICAgIHVwbG9hZFBob3RvcyhwZW5kaW5nUGhvdG9zKS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJFcnJvciB1cGxvYWRpbmcgcGVuZGluZyBwaG90b3M6XCIsIHsgZXJyb3IgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcHJldjtcbiAgICB9KTtcbiAgfSwgW3VwbG9hZFBob3Rvc10pO1xuXG4gIHJldHVybiB7XG4gICAgcGhvdG9zLFxuICAgIHBpY2tJbWFnZSxcbiAgICByZW1vdmVQaG90byxcbiAgICBzZXRQcmltYXJ5UGhvdG8sXG4gICAgdXBsb2FkUGVuZGluZ1Bob3RvcyxcbiAgfTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEsSUFBQUEsV0FBQSxHQUFBQyx1QkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsTUFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsWUFBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsZ0JBQUEsR0FBQUgsT0FBQTtBQUNBLElBQUFJLEtBQUEsR0FBQUosT0FBQTtBQUE0QyxTQUFBRCx3QkFBQU0sQ0FBQSxFQUFBQyxDQUFBLDZCQUFB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