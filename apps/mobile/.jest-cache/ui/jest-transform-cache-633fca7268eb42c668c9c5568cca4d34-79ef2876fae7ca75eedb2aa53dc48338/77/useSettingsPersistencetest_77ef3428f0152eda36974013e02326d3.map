{"version":3,"names":["_getJestObj","mock","getItem","jest","fn","setItem","removeItem","_interopRequireDefault","require","_asyncToGenerator2","_reactNative","_useSettingsPersistence","_asyncStorage","_require","mockAsyncStorage","AsyncStorage","describe","beforeEach","clearAllMocks","mockResolvedValue","it","_renderHook","renderHook","useSettingsPersistence","key","result","expect","current","loadSettings","toBe","saveSettings","clearSettings","default","storedSettings","theme","notifications","JSON","stringify","_renderHook2","loadedSettings","toHaveBeenCalledWith","toEqual","initialData","language","_renderHook3","_renderHook4","settingsToSave","volume","autoPlay","act","_renderHook5","consoleSpy","spyOn","console","mockImplementation","mockRejectedValue","Error","fallback","_renderHook6","toHaveBeenCalled","mockRestore","_renderHook7","test","_renderHook8","complexSettings","profile","name","avatar","preferences","email","push","sms","history","_renderHook9","_renderHook0","rerender","firstLoad","firstSave","firstClear"],"sources":["useSettingsPersistence.test.ts"],"sourcesContent":["/**\n * @jest-environment jsdom\n */\nimport { renderHook, act } from \"@testing-library/react-native\";\nimport { useSettingsPersistence } from \"../useSettingsPersistence\";\n\n// Mock AsyncStorage\njest.mock(\"@react-native-async-storage/async-storage\", () => ({\n  getItem: jest.fn(),\n  setItem: jest.fn(),\n  removeItem: jest.fn(),\n}));\n\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\n\nconst mockAsyncStorage = AsyncStorage as jest.Mocked<typeof AsyncStorage>;\n\ndescribe(\"useSettingsPersistence\", () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    mockAsyncStorage.getItem.mockResolvedValue(null);\n    mockAsyncStorage.setItem.mockResolvedValue();\n    mockAsyncStorage.removeItem.mockResolvedValue();\n  });\n\n  it(\"should initialize with default options\", () => {\n    const { result } = renderHook(() =>\n      useSettingsPersistence({ key: \"test-settings\" }),\n    );\n\n    expect(typeof result.current.loadSettings).toBe(\"function\");\n    expect(typeof result.current.saveSettings).toBe(\"function\");\n    expect(typeof result.current.clearSettings).toBe(\"function\");\n  });\n\n  it(\"should load settings from AsyncStorage\", async () => {\n    const storedSettings = { theme: \"dark\", notifications: true };\n    mockAsyncStorage.getItem.mockResolvedValue(JSON.stringify(storedSettings));\n\n    const { result } = renderHook(() =>\n      useSettingsPersistence({ key: \"user-settings\" }),\n    );\n\n    const loadedSettings = await result.current.loadSettings();\n\n    expect(mockAsyncStorage.getItem).toHaveBeenCalledWith(\"user-settings\");\n    expect(loadedSettings).toEqual(storedSettings);\n  });\n\n  it(\"should return initial data when no stored settings\", async () => {\n    const initialData = { theme: \"light\", language: \"en\" };\n\n    const { result } = renderHook(() =>\n      useSettingsPersistence({ key: \"empty-settings\", initialData }),\n    );\n\n    const loadedSettings = await result.current.loadSettings();\n\n    expect(loadedSettings).toEqual(initialData);\n  });\n\n  it(\"should save settings to AsyncStorage\", async () => {\n    const { result } = renderHook(() =>\n      useSettingsPersistence({ key: \"save-test\" }),\n    );\n\n    const settingsToSave = { volume: 75, autoPlay: false };\n\n    await act(async () => {\n      await result.current.saveSettings(settingsToSave);\n    });\n\n    expect(mockAsyncStorage.setItem).toHaveBeenCalledWith(\n      \"save-test\",\n      JSON.stringify(settingsToSave),\n    );\n  });\n\n  it(\"should clear settings from AsyncStorage\", async () => {\n    const { result } = renderHook(() =>\n      useSettingsPersistence({ key: \"clear-test\" }),\n    );\n\n    await act(async () => {\n      await result.current.clearSettings();\n    });\n\n    expect(mockAsyncStorage.removeItem).toHaveBeenCalledWith(\"clear-test\");\n  });\n\n  it(\"should handle AsyncStorage errors gracefully\", async () => {\n    const consoleSpy = jest.spyOn(console, \"error\").mockImplementation();\n\n    mockAsyncStorage.getItem.mockRejectedValue(new Error(\"Storage error\"));\n    const initialData = { fallback: true };\n\n    const { result } = renderHook(() =>\n      useSettingsPersistence({ key: \"error-test\", initialData }),\n    );\n\n    const loadedSettings = await result.current.loadSettings();\n\n    expect(loadedSettings).toEqual(initialData);\n    expect(consoleSpy).toHaveBeenCalled();\n\n    consoleSpy.mockRestore();\n  });\n\n  it(\"should handle save errors gracefully\", async () => {\n    const consoleSpy = jest.spyOn(console, \"error\").mockImplementation();\n    mockAsyncStorage.setItem.mockRejectedValue(new Error(\"Save error\"));\n\n    const { result } = renderHook(() =>\n      useSettingsPersistence({ key: \"save-error-test\" }),\n    );\n\n    // Should not throw\n    await act(async () => {\n      await result.current.saveSettings({ test: \"data\" });\n    });\n\n    expect(consoleSpy).toHaveBeenCalled();\n    consoleSpy.mockRestore();\n  });\n\n  it(\"should handle clear errors gracefully\", async () => {\n    const consoleSpy = jest.spyOn(console, \"error\").mockImplementation();\n    mockAsyncStorage.removeItem.mockRejectedValue(new Error(\"Clear error\"));\n\n    const { result } = renderHook(() =>\n      useSettingsPersistence({ key: \"clear-error-test\" }),\n    );\n\n    // Should not throw\n    await act(async () => {\n      await result.current.clearSettings();\n    });\n\n    expect(consoleSpy).toHaveBeenCalled();\n    consoleSpy.mockRestore();\n  });\n\n  it(\"should work with complex nested objects\", async () => {\n    const complexSettings = {\n      profile: {\n        name: \"John Doe\",\n        avatar: \"avatar.jpg\",\n      },\n      preferences: {\n        theme: \"dark\",\n        notifications: {\n          email: true,\n          push: false,\n          sms: true,\n        },\n      },\n      history: [1, 2, 3, 4, 5],\n    };\n\n    const { result } = renderHook(() =>\n      useSettingsPersistence({ key: \"complex-settings\" }),\n    );\n\n    await act(async () => {\n      await result.current.saveSettings(complexSettings);\n    });\n\n    expect(mockAsyncStorage.setItem).toHaveBeenCalledWith(\n      \"complex-settings\",\n      JSON.stringify(complexSettings),\n    );\n  });\n\n  it(\"should return stable function references\", () => {\n    const { result, rerender } = renderHook(() =>\n      useSettingsPersistence({ key: \"stable-test\" }),\n    );\n\n    const firstLoad = result.current.loadSettings;\n    const firstSave = result.current.saveSettings;\n    const firstClear = result.current.clearSettings;\n\n    rerender();\n\n    expect(result.current.loadSettings).toBe(firstLoad);\n    expect(result.current.saveSettings).toBe(firstSave);\n    expect(result.current.clearSettings).toBe(firstClear);\n  });\n});\n"],"mappings":"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","ignoreList":[]}