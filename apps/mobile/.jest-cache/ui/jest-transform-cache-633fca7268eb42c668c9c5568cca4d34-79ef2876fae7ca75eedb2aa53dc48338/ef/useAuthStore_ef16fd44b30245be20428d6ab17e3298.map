{"version":3,"names":["_zustand","require","_middleware","_immer","_secureStorage","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty2","default","getOwnPropertyDescriptors","defineProperties","defineProperty","useAuthStore","exports","create","persist","immer","set","user","accessToken","refreshToken","isLoading","error","isAuthenticated","setUser","state","updateUser","setTokens","clearTokens","logout","setIsLoading","setError","name","storage","createSecureStorage","partialize"],"sources":["useAuthStore.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nimport type { PersistStorage } from \"zustand/middleware\";\nimport { immer } from \"zustand/middleware/immer\";\nimport { createSecureStorage } from \"../utils/secureStorage\";\n\nimport type { User } from \"@pawfectmatch/core\";\n\nexport interface AuthState {\n  user: User | null;\n  accessToken: string | null;\n  refreshToken: string | null;\n  isLoading: boolean;\n  error: string | null;\n  isAuthenticated: boolean;\n\n  // Actions\n  setUser: (user: User | null) => void;\n  updateUser: (user: User) => void;\n  setTokens: (accessToken: string, refreshToken: string) => void;\n  clearTokens: () => void;\n  logout: () => void;\n  setIsLoading: (isLoading: boolean) => void;\n  setError: (error: string | null) => void;\n}\n\n/**\n * Mobile-specific authentication store using Zustand with secure storage\n * Fixes M-SEC-01: Uses expo-secure-store instead of AsyncStorage for JWT tokens\n * Persists sensitive tokens securely and user data safely\n */\nexport const useAuthStore = create<AuthState>()(\n  persist(\n    immer((set) => ({\n      user: null,\n      accessToken: null,\n      refreshToken: null,\n      isLoading: false,\n      error: null,\n      isAuthenticated: false,\n\n      // Update user data\n      setUser: (user: User | null) =>\n        set((state) => {\n          state.user = user;\n          state.isAuthenticated = user !== null;\n          return state;\n        }),\n\n      // Update user data (merge with existing)\n      updateUser: (user: User) =>\n        set((state) => {\n          if (state.user) {\n            state.user = { ...state.user, ...user };\n          }\n          return state;\n        }),\n\n      // Set tokens after successful login/registration\n      setTokens: (accessToken: string, refreshToken: string) =>\n        set((state) => {\n          state.accessToken = accessToken;\n          state.refreshToken = refreshToken;\n          state.isAuthenticated = true;\n          return state;\n        }),\n\n      // Clear tokens on logout\n      clearTokens: () =>\n        set((state) => {\n          state.accessToken = null;\n          state.refreshToken = null;\n          state.isAuthenticated = false;\n          return state;\n        }),\n\n      // Full logout\n      logout: () =>\n        set((state) => {\n          state.user = null;\n          state.accessToken = null;\n          state.refreshToken = null;\n          state.isAuthenticated = false;\n          return state;\n        }),\n\n      // Set loading state\n      setIsLoading: (isLoading: boolean) =>\n        set((state) => {\n          state.isLoading = isLoading;\n          return state;\n        }),\n\n      // Set error message\n      setError: (error: string | null) =>\n        set((state) => {\n          state.error = error;\n          return state;\n        }),\n    })),\n    {\n      name: \"auth-storage-secure\",\n      storage: createSecureStorage() as any,\n      partialize: (state) => ({\n        accessToken: state.accessToken,\n        refreshToken: state.refreshToken,\n        user: state.user,\n        isAuthenticated: state.isAuthenticated,\n      }),\n    },\n  ),\n);\n"],"mappings":"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","ignoreList":[]}