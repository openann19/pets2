6567490532657afc32b6f5e37baabe69
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.usePhotoManager = void 0;
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var ImagePicker = _interopRequireWildcard(require("expo-image-picker"));
var _react = require("react");
var _reactNative = require("react-native");
var _multipartUpload = require("../services/multipartUpload");
var _core = require("@pawfectmatch/core");
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function _interopRequireWildcard(e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (var _t2 in e) "default" !== _t2 && {}.hasOwnProperty.call(e, _t2) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, _t2)) && (i.get || i.set) ? o(f, _t2, i) : f[_t2] = e[_t2]); return f; })(e, t); }
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
var usePhotoManager = exports.usePhotoManager = function usePhotoManager() {
  var _useState = (0, _react.useState)([]),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    photos = _useState2[0],
    setPhotos = _useState2[1];
  var pickImage = function () {
    var _ref = (0, _asyncToGenerator2.default)(function* () {
      try {
        var _yield$ImagePicker$re = yield ImagePicker.requestMediaLibraryPermissionsAsync(),
          status = _yield$ImagePicker$re.status;
        if (status !== "granted") {
          _reactNative.Alert.alert("Permission needed", "Please grant permission to access your photos");
          return;
        }
        var result = yield ImagePicker.launchImageLibraryAsync({
          mediaTypes: ImagePicker.MediaTypeOptions.Images,
          allowsEditing: true,
          aspect: [4, 3],
          quality: 0.8,
          allowsMultipleSelection: true,
          selectionLimit: 10 - photos.length
        });
        if (!result.canceled && result.assets.length > 0) {
          var newPhotos = result.assets.map(function (asset, index) {
            return {
              uri: asset.uri,
              type: asset.type || "image/jpeg",
              fileName: `pet-photo-${Date.now()}-${index}.jpg`,
              isPrimary: photos.length === 0 && index === 0,
              isUploading: false
            };
          });
          setPhotos(function (prev) {
            return [].concat((0, _toConsumableArray2.default)(prev), (0, _toConsumableArray2.default)(newPhotos));
          });
          yield uploadPhotos(newPhotos);
        }
      } catch (error) {
        _core.logger.error("Error picking images:", {
          error: error
        });
        _reactNative.Alert.alert("Error", "Failed to pick images. Please try again.");
      }
    });
    return function pickImage() {
      return _ref.apply(this, arguments);
    };
  }();
  var uploadPhotos = (0, _react.useCallback)(function () {
    var _ref2 = (0, _asyncToGenerator2.default)(function* (photosToUpload) {
      var _loop = function* _loop(photo) {
        try {
          setPhotos(function (prev) {
            var photoIndex = prev.findIndex(function (p) {
              return p.uri === photo.uri;
            });
            if (photoIndex === -1) return prev;
            return prev.map(function (p, i) {
              return i === photoIndex ? _objectSpread(_objectSpread({}, p), {}, {
                isUploading: true,
                error: undefined
              }) : p;
            });
          });
          var uploadResult = yield (0, _multipartUpload.multipartUpload)({
            fileUri: photo.uri,
            contentType: photo.type,
            onProgress: function onProgress(uploaded, total) {
              var percentage = Math.round(uploaded / total * 100);
              setPhotos(function (prev) {
                var photoIndex = prev.findIndex(function (p) {
                  return p.uri === photo.uri;
                });
                if (photoIndex === -1) return prev;
                return prev.map(function (p, i) {
                  return i === photoIndex ? _objectSpread(_objectSpread({}, p), {}, {
                    uploadProgress: {
                      uploaded: uploaded,
                      total: total,
                      percentage: percentage
                    }
                  }) : p;
                });
              });
            }
          });
          setPhotos(function (prev) {
            var photoIndex = prev.findIndex(function (p) {
              return p.uri === photo.uri;
            });
            if (photoIndex === -1) return prev;
            return prev.map(function (p, i) {
              return i === photoIndex ? _objectSpread(_objectSpread({}, p), {}, {
                isUploading: false,
                uploadedUrl: uploadResult.url,
                thumbnailUrl: uploadResult.thumbnails.webp,
                s3Key: uploadResult.key,
                uploadProgress: undefined
              }) : p;
            });
          });
          _core.logger.info("Photo uploaded successfully:", {
            photo: photo,
            url: uploadResult.url
          });
        } catch (error) {
          _core.logger.error("Error uploading photo:", {
            error: error,
            photo: photo.uri
          });
          setPhotos(function (prev) {
            var photoIndex = prev.findIndex(function (p) {
              return p.uri === photo.uri;
            });
            if (photoIndex === -1) return prev;
            return prev.map(function (p, i) {
              return i === photoIndex ? _objectSpread(_objectSpread({}, p), {}, {
                isUploading: false,
                error: "Upload failed"
              }) : p;
            });
          });
          _reactNative.Alert.alert("Upload Failed", `Failed to upload ${photo.fileName}. Please try again.`);
        }
      };
      for (var photo of photosToUpload) {
        yield* _loop(photo);
      }
    });
    return function (_x) {
      return _ref2.apply(this, arguments);
    };
  }(), []);
  var removePhoto = function removePhoto(index) {
    setPhotos(function (prev) {
      var photoToRemove = prev[index];
      var newPhotos = prev.filter(function (_, i) {
        return i !== index;
      });
      if (photoToRemove != null && photoToRemove.isPrimary && newPhotos.length > 0) {
        var firstPhoto = newPhotos[0];
        if (firstPhoto) {
          firstPhoto.isPrimary = true;
        }
      }
      return newPhotos;
    });
  };
  var setPrimaryPhoto = function setPrimaryPhoto(index) {
    setPhotos(function (prev) {
      return prev.map(function (photo, i) {
        return _objectSpread(_objectSpread({}, photo), {}, {
          isPrimary: i === index
        });
      });
    });
  };
  var uploadPendingPhotos = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    setPhotos(function (prev) {
      var pendingPhotos = prev.filter(function (p) {
        return !p.uploadedUrl && !p.isUploading && !p.error;
      });
      if (pendingPhotos.length > 0) {
        uploadPhotos(pendingPhotos).catch(function (error) {
          _core.logger.error("Error uploading pending photos:", {
            error: error
          });
        });
      }
      return prev;
    });
  }), [uploadPhotos]);
  return {
    photos: photos,
    pickImage: pickImage,
    removePhoto: removePhoto,
    setPrimaryPhoto: setPrimaryPhoto,
    uploadPendingPhotos: uploadPendingPhotos
  };
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJJbWFnZVBpY2tlciIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwicmVxdWlyZSIsIl9yZWFjdCIsIl9yZWFjdE5hdGl2ZSIsIl9tdWx0aXBhcnRVcGxvYWQiLCJfY29yZSIsImUiLCJ0IiwiV2Vha01hcCIsInIiLCJuIiwiX19lc01vZHVsZSIsIm8iLCJpIiwiZiIsIl9fcHJvdG9fXyIsImRlZmF1bHQiLCJoYXMiLCJnZXQiLCJzZXQiLCJfdDIiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsIm93bktleXMiLCJrZXlzIiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwiZmlsdGVyIiwiZW51bWVyYWJsZSIsInB1c2giLCJhcHBseSIsIl9vYmplY3RTcHJlYWQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJmb3JFYWNoIiwiX2RlZmluZVByb3BlcnR5MiIsImdldE93blByb3BlcnR5RGVzY3JpcHRvcnMiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidXNlUGhvdG9NYW5hZ2VyIiwiZXhwb3J0cyIsIl91c2VTdGF0ZSIsInVzZVN0YXRlIiwiX3VzZVN0YXRlMiIsIl9zbGljZWRUb0FycmF5MiIsInBob3RvcyIsInNldFBob3RvcyIsInBpY2tJbWFnZSIsIl9yZWYiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJfeWllbGQkSW1hZ2VQaWNrZXIkcmUiLCJyZXF1ZXN0TWVkaWFMaWJyYXJ5UGVybWlzc2lvbnNBc3luYyIsInN0YXR1cyIsIkFsZXJ0IiwiYWxlcnQiLCJyZXN1bHQiLCJsYXVuY2hJbWFnZUxpYnJhcnlBc3luYyIsIm1lZGlhVHlwZXMiLCJNZWRpYVR5cGVPcHRpb25zIiwiSW1hZ2VzIiwiYWxsb3dzRWRpdGluZyIsImFzcGVjdCIsInF1YWxpdHkiLCJhbGxvd3NNdWx0aXBsZVNlbGVjdGlvbiIsInNlbGVjdGlvbkxpbWl0IiwiY2FuY2VsZWQiLCJhc3NldHMiLCJuZXdQaG90b3MiLCJtYXAiLCJhc3NldCIsImluZGV4IiwidXJpIiwidHlwZSIsImZpbGVOYW1lIiwiRGF0ZSIsIm5vdyIsImlzUHJpbWFyeSIsImlzVXBsb2FkaW5nIiwicHJldiIsImNvbmNhdCIsIl90b0NvbnN1bWFibGVBcnJheTIiLCJ1cGxvYWRQaG90b3MiLCJlcnJvciIsImxvZ2dlciIsInVzZUNhbGxiYWNrIiwiX3JlZjIiLCJwaG90b3NUb1VwbG9hZCIsIl9sb29wIiwicGhvdG8iLCJwaG90b0luZGV4IiwiZmluZEluZGV4IiwicCIsInVuZGVmaW5lZCIsInVwbG9hZFJlc3VsdCIsIm11bHRpcGFydFVwbG9hZCIsImZpbGVVcmkiLCJjb250ZW50VHlwZSIsIm9uUHJvZ3Jlc3MiLCJ1cGxvYWRlZCIsInRvdGFsIiwicGVyY2VudGFnZSIsIk1hdGgiLCJyb3VuZCIsInVwbG9hZFByb2dyZXNzIiwidXBsb2FkZWRVcmwiLCJ1cmwiLCJ0aHVtYm5haWxVcmwiLCJ0aHVtYm5haWxzIiwid2VicCIsInMzS2V5Iiwia2V5IiwiaW5mbyIsIl94IiwicmVtb3ZlUGhvdG8iLCJwaG90b1RvUmVtb3ZlIiwiXyIsImZpcnN0UGhvdG8iLCJzZXRQcmltYXJ5UGhvdG8iLCJ1cGxvYWRQZW5kaW5nUGhvdG9zIiwicGVuZGluZ1Bob3RvcyIsImNhdGNoIl0sInNvdXJjZXMiOlsidXNlUGhvdG9NYW5hZ2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEltYWdlUGlja2VyIGZyb20gXCJleHBvLWltYWdlLXBpY2tlclwiO1xuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUNhbGxiYWNrIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBBbGVydCB9IGZyb20gXCJyZWFjdC1uYXRpdmVcIjtcbmltcG9ydCB7IG11bHRpcGFydFVwbG9hZCB9IGZyb20gXCIuLi9zZXJ2aWNlcy9tdWx0aXBhcnRVcGxvYWRcIjtcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gXCJAcGF3ZmVjdG1hdGNoL2NvcmVcIjtcblxuZXhwb3J0IGludGVyZmFjZSBVcGxvYWRQcm9ncmVzcyB7XG4gIHVwbG9hZGVkOiBudW1iZXI7XG4gIHRvdGFsOiBudW1iZXI7XG4gIHBlcmNlbnRhZ2U6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQaG90b0RhdGEge1xuICB1cmk6IHN0cmluZztcbiAgdHlwZTogc3RyaW5nO1xuICBmaWxlTmFtZTogc3RyaW5nO1xuICBpc1ByaW1hcnk6IGJvb2xlYW47XG4gIC8vIFVwbG9hZCB0cmFja2luZ1xuICBpc1VwbG9hZGluZz86IGJvb2xlYW47XG4gIHVwbG9hZFByb2dyZXNzPzogVXBsb2FkUHJvZ3Jlc3M7XG4gIHVwbG9hZGVkVXJsPzogc3RyaW5nO1xuICB0aHVtYm5haWxVcmw/OiBzdHJpbmc7XG4gIHMzS2V5Pzogc3RyaW5nO1xuICBlcnJvcj86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBVc2VQaG90b01hbmFnZXJSZXR1cm4ge1xuICBwaG90b3M6IFBob3RvRGF0YVtdO1xuICBwaWNrSW1hZ2U6ICgpID0+IFByb21pc2U8dm9pZD47XG4gIHJlbW92ZVBob3RvOiAoaW5kZXg6IG51bWJlcikgPT4gdm9pZDtcbiAgc2V0UHJpbWFyeVBob3RvOiAoaW5kZXg6IG51bWJlcikgPT4gdm9pZDtcbiAgdXBsb2FkUGVuZGluZ1Bob3RvczogKCkgPT4gUHJvbWlzZTx2b2lkPjtcbn1cblxuZXhwb3J0IGNvbnN0IHVzZVBob3RvTWFuYWdlciA9ICgpOiBVc2VQaG90b01hbmFnZXJSZXR1cm4gPT4ge1xuICBjb25zdCBbcGhvdG9zLCBzZXRQaG90b3NdID0gdXNlU3RhdGU8UGhvdG9EYXRhW10+KFtdKTtcblxuICBjb25zdCBwaWNrSW1hZ2UgPSBhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgc3RhdHVzIH0gPSBhd2FpdCBJbWFnZVBpY2tlci5yZXF1ZXN0TWVkaWFMaWJyYXJ5UGVybWlzc2lvbnNBc3luYygpO1xuXG4gICAgICBpZiAoc3RhdHVzICE9PSBcImdyYW50ZWRcIikge1xuICAgICAgICBBbGVydC5hbGVydChcbiAgICAgICAgICBcIlBlcm1pc3Npb24gbmVlZGVkXCIsXG4gICAgICAgICAgXCJQbGVhc2UgZ3JhbnQgcGVybWlzc2lvbiB0byBhY2Nlc3MgeW91ciBwaG90b3NcIixcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBJbWFnZVBpY2tlci5sYXVuY2hJbWFnZUxpYnJhcnlBc3luYyh7XG4gICAgICAgIG1lZGlhVHlwZXM6IEltYWdlUGlja2VyLk1lZGlhVHlwZU9wdGlvbnMuSW1hZ2VzLFxuICAgICAgICBhbGxvd3NFZGl0aW5nOiB0cnVlLFxuICAgICAgICBhc3BlY3Q6IFs0LCAzXSxcbiAgICAgICAgcXVhbGl0eTogMC44LFxuICAgICAgICBhbGxvd3NNdWx0aXBsZVNlbGVjdGlvbjogdHJ1ZSxcbiAgICAgICAgc2VsZWN0aW9uTGltaXQ6IDEwIC0gcGhvdG9zLmxlbmd0aCxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXJlc3VsdC5jYW5jZWxlZCAmJiByZXN1bHQuYXNzZXRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgbmV3UGhvdG9zOiBQaG90b0RhdGFbXSA9IHJlc3VsdC5hc3NldHMubWFwKChhc3NldDogYW55LCBpbmRleDogbnVtYmVyKSA9PiAoe1xuICAgICAgICAgIHVyaTogYXNzZXQudXJpLFxuICAgICAgICAgIHR5cGU6IGFzc2V0LnR5cGUgfHwgXCJpbWFnZS9qcGVnXCIsXG4gICAgICAgICAgZmlsZU5hbWU6IGBwZXQtcGhvdG8tJHtEYXRlLm5vdygpfS0ke2luZGV4fS5qcGdgLFxuICAgICAgICAgIGlzUHJpbWFyeTogcGhvdG9zLmxlbmd0aCA9PT0gMCAmJiBpbmRleCA9PT0gMCxcbiAgICAgICAgICBpc1VwbG9hZGluZzogZmFsc2UsXG4gICAgICAgIH0pKTtcblxuICAgICAgICBzZXRQaG90b3MoKHByZXYpID0+IFsuLi5wcmV2LCAuLi5uZXdQaG90b3NdKTtcblxuICAgICAgICAvLyBBdXRvbWF0aWNhbGx5IHVwbG9hZCB0aGUgbmV3IHBob3Rvc1xuICAgICAgICBhd2FpdCB1cGxvYWRQaG90b3MobmV3UGhvdG9zKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKFwiRXJyb3IgcGlja2luZyBpbWFnZXM6XCIsIHsgZXJyb3IgfSk7XG4gICAgICBBbGVydC5hbGVydChcIkVycm9yXCIsIFwiRmFpbGVkIHRvIHBpY2sgaW1hZ2VzLiBQbGVhc2UgdHJ5IGFnYWluLlwiKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgdXBsb2FkUGhvdG9zID0gdXNlQ2FsbGJhY2soYXN5bmMgKHBob3Rvc1RvVXBsb2FkOiBQaG90b0RhdGFbXSkgPT4ge1xuICAgIGZvciAoY29uc3QgcGhvdG8gb2YgcGhvdG9zVG9VcGxvYWQpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIE1hcmsgcGhvdG8gYXMgdXBsb2FkaW5nIHVzaW5nIGZ1bmN0aW9uYWwgdXBkYXRlIHRvIGF2b2lkIHN0YWxlIHN0YXRlXG4gICAgICAgIHNldFBob3RvcygocHJldikgPT4ge1xuICAgICAgICAgIGNvbnN0IHBob3RvSW5kZXggPSBwcmV2LmZpbmRJbmRleCgocCkgPT4gcC51cmkgPT09IHBob3RvLnVyaSk7XG4gICAgICAgICAgaWYgKHBob3RvSW5kZXggPT09IC0xKSByZXR1cm4gcHJldjtcblxuICAgICAgICAgIHJldHVybiBwcmV2Lm1hcCgocCwgaSkgPT5cbiAgICAgICAgICAgIGkgPT09IHBob3RvSW5kZXhcbiAgICAgICAgICAgICAgPyB7IC4uLnAsIGlzVXBsb2FkaW5nOiB0cnVlLCBlcnJvcjogdW5kZWZpbmVkIH1cbiAgICAgICAgICAgICAgOiBwLFxuICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFN0YXJ0IG11bHRpcGFydCB1cGxvYWQgd2l0aCBwcm9ncmVzcyB0cmFja2luZ1xuICAgICAgICBjb25zdCB1cGxvYWRSZXN1bHQgPSBhd2FpdCBtdWx0aXBhcnRVcGxvYWQoe1xuICAgICAgICAgIGZpbGVVcmk6IHBob3RvLnVyaSxcbiAgICAgICAgICBjb250ZW50VHlwZTogcGhvdG8udHlwZSxcbiAgICAgICAgICBvblByb2dyZXNzOiAodXBsb2FkZWQsIHRvdGFsKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwZXJjZW50YWdlID0gTWF0aC5yb3VuZCgodXBsb2FkZWQgLyB0b3RhbCkgKiAxMDApO1xuICAgICAgICAgICAgc2V0UGhvdG9zKChwcmV2KSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHBob3RvSW5kZXggPSBwcmV2LmZpbmRJbmRleCgocCkgPT4gcC51cmkgPT09IHBob3RvLnVyaSk7XG4gICAgICAgICAgICAgIGlmIChwaG90b0luZGV4ID09PSAtMSkgcmV0dXJuIHByZXY7XG5cbiAgICAgICAgICAgICAgcmV0dXJuIHByZXYubWFwKChwLCBpKSA9PlxuICAgICAgICAgICAgICAgIGkgPT09IHBob3RvSW5kZXhcbiAgICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICAgIC4uLnAsXG4gICAgICAgICAgICAgICAgICAgICAgdXBsb2FkUHJvZ3Jlc3M6IHsgdXBsb2FkZWQsIHRvdGFsLCBwZXJjZW50YWdlIH0sXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIDogcCxcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIE1hcmsgcGhvdG8gYXMgc3VjY2Vzc2Z1bGx5IHVwbG9hZGVkXG4gICAgICAgIHNldFBob3RvcygocHJldikgPT4ge1xuICAgICAgICAgIGNvbnN0IHBob3RvSW5kZXggPSBwcmV2LmZpbmRJbmRleCgocCkgPT4gcC51cmkgPT09IHBob3RvLnVyaSk7XG4gICAgICAgICAgaWYgKHBob3RvSW5kZXggPT09IC0xKSByZXR1cm4gcHJldjtcblxuICAgICAgICAgIHJldHVybiBwcmV2Lm1hcCgocCwgaSkgPT5cbiAgICAgICAgICAgIGkgPT09IHBob3RvSW5kZXhcbiAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAuLi5wLFxuICAgICAgICAgICAgICAgICAgaXNVcGxvYWRpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgdXBsb2FkZWRVcmw6IHVwbG9hZFJlc3VsdC51cmwsXG4gICAgICAgICAgICAgICAgICB0aHVtYm5haWxVcmw6IHVwbG9hZFJlc3VsdC50aHVtYm5haWxzLndlYnAsXG4gICAgICAgICAgICAgICAgICBzM0tleTogdXBsb2FkUmVzdWx0LmtleSxcbiAgICAgICAgICAgICAgICAgIHVwbG9hZFByb2dyZXNzOiB1bmRlZmluZWQsIC8vIENsZWFyIHByb2dyZXNzIG9uIHN1Y2Nlc3NcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIDogcCxcbiAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICBsb2dnZXIuaW5mbyhcIlBob3RvIHVwbG9hZGVkIHN1Y2Nlc3NmdWxseTpcIiwgeyBwaG90bywgdXJsOiB1cGxvYWRSZXN1bHQudXJsIH0pO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiRXJyb3IgdXBsb2FkaW5nIHBob3RvOlwiLCB7IGVycm9yLCBwaG90bzogcGhvdG8udXJpIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gTWFyayBwaG90byB3aXRoIGVycm9yXG4gICAgICAgIHNldFBob3RvcygocHJldikgPT4ge1xuICAgICAgICAgIGNvbnN0IHBob3RvSW5kZXggPSBwcmV2LmZpbmRJbmRleCgocCkgPT4gcC51cmkgPT09IHBob3RvLnVyaSk7XG4gICAgICAgICAgaWYgKHBob3RvSW5kZXggPT09IC0xKSByZXR1cm4gcHJldjtcblxuICAgICAgICAgIHJldHVybiBwcmV2Lm1hcCgocCwgaSkgPT5cbiAgICAgICAgICAgIGkgPT09IHBob3RvSW5kZXhcbiAgICAgICAgICAgICAgPyB7IC4uLnAsIGlzVXBsb2FkaW5nOiBmYWxzZSwgZXJyb3I6IFwiVXBsb2FkIGZhaWxlZFwiIH1cbiAgICAgICAgICAgICAgOiBwLFxuICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIEFsZXJ0LmFsZXJ0KFxuICAgICAgICAgIFwiVXBsb2FkIEZhaWxlZFwiLFxuICAgICAgICAgIGBGYWlsZWQgdG8gdXBsb2FkICR7cGhvdG8uZmlsZU5hbWV9LiBQbGVhc2UgdHJ5IGFnYWluLmAsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICB9LCBbXSk7XG5cbiAgY29uc3QgcmVtb3ZlUGhvdG8gPSAoaW5kZXg6IG51bWJlcikgPT4ge1xuICAgIHNldFBob3RvcygocHJldikgPT4ge1xuICAgICAgY29uc3QgcGhvdG9Ub1JlbW92ZSA9IHByZXZbaW5kZXhdO1xuICAgICAgY29uc3QgbmV3UGhvdG9zID0gcHJldi5maWx0ZXIoKF8sIGkpID0+IGkgIT09IGluZGV4KTtcbiAgICAgIC8vIElmIHdlIHJlbW92ZWQgdGhlIHByaW1hcnkgcGhvdG8sIG1ha2UgdGhlIGZpcnN0IHJlbWFpbmluZyBwaG90byBwcmltYXJ5XG4gICAgICBpZiAocGhvdG9Ub1JlbW92ZT8uaXNQcmltYXJ5ICYmIG5ld1Bob3Rvcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IGZpcnN0UGhvdG8gPSBuZXdQaG90b3NbMF07XG4gICAgICAgIGlmIChmaXJzdFBob3RvKSB7XG4gICAgICAgICAgZmlyc3RQaG90by5pc1ByaW1hcnkgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3UGhvdG9zO1xuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IHNldFByaW1hcnlQaG90byA9IChpbmRleDogbnVtYmVyKSA9PiB7XG4gICAgc2V0UGhvdG9zKChwcmV2KSA9PlxuICAgICAgcHJldi5tYXAoKHBob3RvLCBpKSA9PiAoe1xuICAgICAgICAuLi5waG90byxcbiAgICAgICAgaXNQcmltYXJ5OiBpID09PSBpbmRleCxcbiAgICAgIH0pKSxcbiAgICApO1xuICB9O1xuXG4gIGNvbnN0IHVwbG9hZFBlbmRpbmdQaG90b3MgPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7XG4gICAgc2V0UGhvdG9zKChwcmV2KSA9PiB7XG4gICAgICBjb25zdCBwZW5kaW5nUGhvdG9zID0gcHJldi5maWx0ZXIoXG4gICAgICAgIChwKSA9PiAhcC51cGxvYWRlZFVybCAmJiAhcC5pc1VwbG9hZGluZyAmJiAhcC5lcnJvcixcbiAgICAgICk7XG5cbiAgICAgIGlmIChwZW5kaW5nUGhvdG9zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gVXBsb2FkIGluIGJhY2tncm91bmQgd2l0aG91dCBibG9ja2luZ1xuICAgICAgICB1cGxvYWRQaG90b3MocGVuZGluZ1Bob3RvcykuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRXJyb3IgdXBsb2FkaW5nIHBlbmRpbmcgcGhvdG9zOlwiLCB7IGVycm9yIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByZXY7XG4gICAgfSk7XG4gIH0sIFt1cGxvYWRQaG90b3NdKTtcblxuICByZXR1cm4ge1xuICAgIHBob3RvcyxcbiAgICBwaWNrSW1hZ2UsXG4gICAgcmVtb3ZlUGhvdG8sXG4gICAgc2V0UHJpbWFyeVBob3RvLFxuICAgIHVwbG9hZFBlbmRpbmdQaG90b3MsXG4gIH07XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBLElBQUFBLFdBQUEsR0FBQUMsdUJBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLE1BQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLFlBQUEsR0FBQUYsT0FBQTtBQUNBLElBQUFHLGdCQUFBLEdBQUFILE9BQUE7QUFDQSxJQUFBSSxLQUFBLEdBQUFKLE9BQUE7QUFBNEMsU0FBQUQsd0JBQUFNLENBQUEsRUFBQUMsQ0FBQSw2QkFB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