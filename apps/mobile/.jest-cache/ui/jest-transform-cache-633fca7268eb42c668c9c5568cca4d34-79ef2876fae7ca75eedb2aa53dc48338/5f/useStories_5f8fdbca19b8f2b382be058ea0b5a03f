ea36fe6807834cac04a2172f371da449
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useStories = void 0;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _react = require("react");
var Haptics = _interopRequireWildcard(require("expo-haptics"));
var _reactQuery = require("@tanstack/react-query");
var _core = require("@pawfectmatch/core");
var _useSocket = require("../../useSocket");
var _apiClient = _interopRequireDefault(require("../../../services/apiClient"));
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function _interopRequireWildcard(e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (var _t2 in e) "default" !== _t2 && {}.hasOwnProperty.call(e, _t2) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, _t2)) && (i.get || i.set) ? o(f, _t2, i) : f[_t2] = e[_t2]); return f; })(e, t); }
var useStories = exports.useStories = function useStories() {
  var initialGroupIndex = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
  var _useState = (0, _react.useState)(initialGroupIndex),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    currentGroupIndex = _useState2[0],
    setCurrentGroupIndex = _useState2[1];
  var _useState3 = (0, _react.useState)(0),
    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),
    currentStoryIndex = _useState4[0],
    setCurrentStoryIndex = _useState4[1];
  var _useState5 = (0, _react.useState)(false),
    _useState6 = (0, _slicedToArray2.default)(_useState5, 2),
    isPaused = _useState6[0],
    setIsPaused = _useState6[1];
  var _useState7 = (0, _react.useState)(false),
    _useState8 = (0, _slicedToArray2.default)(_useState7, 2),
    isMuted = _useState8[0],
    setIsMuted = _useState8[1];
  var _useState9 = (0, _react.useState)(0),
    _useState0 = (0, _slicedToArray2.default)(_useState9, 2),
    progress = _useState0[0],
    setProgress = _useState0[1];
  var _useState1 = (0, _react.useState)(0),
    _useState10 = (0, _slicedToArray2.default)(_useState1, 2),
    viewCount = _useState10[0],
    setViewCount = _useState10[1];
  var timerRef = (0, _react.useRef)(null);
  var progressIntervalRef = (0, _react.useRef)(null);
  var longPressTimer = (0, _react.useRef)(null);
  var socket = (0, _useSocket.useSocket)();
  var _useQuery = (0, _reactQuery.useQuery)({
      queryKey: ["stories-feed"],
      queryFn: function () {
        var _queryFn = (0, _asyncToGenerator2.default)(function* () {
          var response = yield _apiClient.default.get("/stories");
          return response.stories;
        });
        function queryFn() {
          return _queryFn.apply(this, arguments);
        }
        return queryFn;
      }()
    }),
    storyGroups = _useQuery.data,
    isLoading = _useQuery.isLoading,
    error = _useQuery.error,
    refetch = _useQuery.refetch;
  var currentGroup = storyGroups == null ? void 0 : storyGroups[currentGroupIndex];
  var refreshStories = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    yield refetch();
  }), [refetch]);
  var currentStory = currentGroup == null ? void 0 : currentGroup.stories[currentStoryIndex];
  var viewStoryMutation = (0, _reactQuery.useMutation)({
    mutationFn: function () {
      var _mutationFn = (0, _asyncToGenerator2.default)(function* (storyId) {
        var response = yield _apiClient.default.post(`/stories/${storyId}/view`);
        return response;
      });
      function mutationFn(_x) {
        return _mutationFn.apply(this, arguments);
      }
      return mutationFn;
    }(),
    onSuccess: function onSuccess(data) {
      setViewCount(data.viewCount);
    }
  });
  var goToNextStory = (0, _react.useCallback)(function () {
    if (!currentGroup) return;
    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);
    if (currentStoryIndex < currentGroup.stories.length - 1) {
      setCurrentStoryIndex(function (prev) {
        return prev + 1;
      });
      setProgress(0);
    } else if (storyGroups && currentGroupIndex < storyGroups.length - 1) {
      setCurrentGroupIndex(function (prev) {
        return prev + 1;
      });
      setCurrentStoryIndex(0);
      setProgress(0);
    } else {
      _core.logger.info("Reached end of stories");
    }
  }, [currentGroup, currentStoryIndex, currentGroupIndex, storyGroups]);
  var goToPreviousStory = (0, _react.useCallback)(function () {
    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);
    if (currentStoryIndex > 0) {
      setCurrentStoryIndex(function (prev) {
        return prev - 1;
      });
      setProgress(0);
    } else if (currentGroupIndex > 0 && storyGroups) {
      var prevGroupIndex = currentGroupIndex - 1;
      var prevGroup = storyGroups[prevGroupIndex];
      if (prevGroup) {
        setCurrentGroupIndex(prevGroupIndex);
        setCurrentStoryIndex(prevGroup.stories.length - 1);
        setProgress(0);
      }
    }
  }, [currentStoryIndex, currentGroupIndex, storyGroups]);
  var goToGroup = (0, _react.useCallback)(function (groupIndex) {
    if (groupIndex >= 0 && storyGroups && groupIndex < storyGroups.length) {
      setCurrentGroupIndex(groupIndex);
      setCurrentStoryIndex(0);
      setProgress(0);
    }
  }, [storyGroups]);
  var goToStory = (0, _react.useCallback)(function (groupIndex, storyIndex) {
    if (groupIndex >= 0 && storyGroups && groupIndex < storyGroups.length) {
      var group = storyGroups[groupIndex];
      if (group && storyIndex >= 0 && storyIndex < group.stories.length) {
        setCurrentGroupIndex(groupIndex);
        setCurrentStoryIndex(storyIndex);
        setProgress(0);
      }
    }
  }, [storyGroups]);
  (0, _react.useEffect)(function () {
    if (!currentStory || isPaused) return;
    var duration = currentStory.duration * 1000;
    var startTime = Date.now();
    progressIntervalRef.current = setInterval(function () {
      var elapsed = Date.now() - startTime;
      var newProgress = Math.min(elapsed / duration * 100, 100);
      setProgress(newProgress);
    }, 16);
    timerRef.current = setTimeout(function () {
      goToNextStory();
    }, duration);
    return function () {
      if (timerRef.current) clearTimeout(timerRef.current);
      if (progressIntervalRef.current) clearInterval(progressIntervalRef.current);
    };
  }, [currentStory, isPaused, goToNextStory]);
  (0, _react.useEffect)(function () {
    if (currentStory) {
      viewStoryMutation.mutate(currentStory._id);
    }
  }, [currentStory == null ? void 0 : currentStory._id]);
  (0, _react.useEffect)(function () {
    if (!socket || !currentStory) return;
    var handleStoryViewed = function handleStoryViewed(data) {
      if (data.storyId === currentStory._id) {
        setViewCount(data.viewCount);
      }
    };
    socket.on("story:viewed", handleStoryViewed);
    return function () {
      socket.off("story:viewed", handleStoryViewed);
    };
  }, [socket, currentStory == null ? void 0 : currentStory._id]);
  var markAsViewed = (0, _react.useCallback)(function () {
    var _ref2 = (0, _asyncToGenerator2.default)(function* (storyId) {
      try {
        yield viewStoryMutation.mutateAsync(storyId);
      } catch (error) {
        _core.logger.error("Failed to mark story as viewed", {
          error: error,
          storyId: storyId
        });
      }
    });
    return function (_x2) {
      return _ref2.apply(this, arguments);
    };
  }(), [viewStoryMutation]);
  var setPaused = (0, _react.useCallback)(function (paused) {
    setIsPaused(paused);
  }, []);
  var setMuted = (0, _react.useCallback)(function (muted) {
    setIsMuted(muted);
  }, []);
  return {
    storyGroups: storyGroups,
    isLoading: isLoading,
    error: (error == null ? void 0 : error.message) || null,
    currentGroupIndex: currentGroupIndex,
    currentStoryIndex: currentStoryIndex,
    currentGroup: currentGroup,
    currentStory: currentStory,
    progress: progress,
    viewCount: viewCount,
    isPaused: isPaused,
    isMuted: isMuted,
    setPaused: setPaused,
    setMuted: setMuted,
    goToNextStory: goToNextStory,
    goToPreviousStory: goToPreviousStory,
    goToGroup: goToGroup,
    goToStory: goToStory,
    markAsViewed: markAsViewed,
    refreshStories: refreshStories,
    timerRef: timerRef,
    progressIntervalRef: progressIntervalRef,
    longPressTimer: longPressTimer
  };
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiSGFwdGljcyIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwiX3JlYWN0UXVlcnkiLCJfY29yZSIsIl91c2VTb2NrZXQiLCJfYXBpQ2xpZW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsImUiLCJ0IiwiV2Vha01hcCIsInIiLCJuIiwiX19lc01vZHVsZSIsIm8iLCJpIiwiZiIsIl9fcHJvdG9fXyIsImRlZmF1bHQiLCJoYXMiLCJnZXQiLCJzZXQiLCJfdDIiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsInVzZVN0b3JpZXMiLCJleHBvcnRzIiwiaW5pdGlhbEdyb3VwSW5kZXgiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJfdXNlU3RhdGUiLCJ1c2VTdGF0ZSIsIl91c2VTdGF0ZTIiLCJfc2xpY2VkVG9BcnJheTIiLCJjdXJyZW50R3JvdXBJbmRleCIsInNldEN1cnJlbnRHcm91cEluZGV4IiwiX3VzZVN0YXRlMyIsIl91c2VTdGF0ZTQiLCJjdXJyZW50U3RvcnlJbmRleCIsInNldEN1cnJlbnRTdG9yeUluZGV4IiwiX3VzZVN0YXRlNSIsIl91c2VTdGF0ZTYiLCJpc1BhdXNlZCIsInNldElzUGF1c2VkIiwiX3VzZVN0YXRlNyIsIl91c2VTdGF0ZTgiLCJpc011dGVkIiwic2V0SXNNdXRlZCIsIl91c2VTdGF0ZTkiLCJfdXNlU3RhdGUwIiwicHJvZ3Jlc3MiLCJzZXRQcm9ncmVzcyIsIl91c2VTdGF0ZTEiLCJfdXNlU3RhdGUxMCIsInZpZXdDb3VudCIsInNldFZpZXdDb3VudCIsInRpbWVyUmVmIiwidXNlUmVmIiwicHJvZ3Jlc3NJbnRlcnZhbFJlZiIsImxvbmdQcmVzc1RpbWVyIiwic29ja2V0IiwidXNlU29ja2V0IiwiX3VzZVF1ZXJ5IiwidXNlUXVlcnkiLCJxdWVyeUtleSIsInF1ZXJ5Rm4iLCJfcXVlcnlGbiIsIl9hc3luY1RvR2VuZXJhdG9yMiIsInJlc3BvbnNlIiwiYXBpQ2xpZW50Iiwic3RvcmllcyIsImFwcGx5Iiwic3RvcnlHcm91cHMiLCJkYXRhIiwiaXNMb2FkaW5nIiwiZXJyb3IiLCJyZWZldGNoIiwiY3VycmVudEdyb3VwIiwicmVmcmVzaFN0b3JpZXMiLCJ1c2VDYWxsYmFjayIsImN1cnJlbnRTdG9yeSIsInZpZXdTdG9yeU11dGF0aW9uIiwidXNlTXV0YXRpb24iLCJtdXRhdGlvbkZuIiwiX211dGF0aW9uRm4iLCJzdG9yeUlkIiwicG9zdCIsIl94Iiwib25TdWNjZXNzIiwiZ29Ub05leHRTdG9yeSIsImltcGFjdEFzeW5jIiwiSW1wYWN0RmVlZGJhY2tTdHlsZSIsIkxpZ2h0IiwicHJldiIsImxvZ2dlciIsImluZm8iLCJnb1RvUHJldmlvdXNTdG9yeSIsInByZXZHcm91cEluZGV4IiwicHJldkdyb3VwIiwiZ29Ub0dyb3VwIiwiZ3JvdXBJbmRleCIsImdvVG9TdG9yeSIsInN0b3J5SW5kZXgiLCJncm91cCIsInVzZUVmZmVjdCIsImR1cmF0aW9uIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsImN1cnJlbnQiLCJzZXRJbnRlcnZhbCIsImVsYXBzZWQiLCJuZXdQcm9ncmVzcyIsIk1hdGgiLCJtaW4iLCJzZXRUaW1lb3V0IiwiY2xlYXJUaW1lb3V0IiwiY2xlYXJJbnRlcnZhbCIsIm11dGF0ZSIsIl9pZCIsImhhbmRsZVN0b3J5Vmlld2VkIiwib24iLCJvZmYiLCJtYXJrQXNWaWV3ZWQiLCJfcmVmMiIsIm11dGF0ZUFzeW5jIiwiX3gyIiwic2V0UGF1c2VkIiwicGF1c2VkIiwic2V0TXV0ZWQiLCJtdXRlZCIsIm1lc3NhZ2UiXSwic291cmNlcyI6WyJ1c2VTdG9yaWVzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogdXNlU3RvcmllcyBIb29rXG4gKiBNYW5hZ2VzIHN0b3JpZXMgZmVlZCwgbmF2aWdhdGlvbiwgcHJvZ3Jlc3MgdHJhY2tpbmcsIGFuZCB2aWV3aW5nIGludGVyYWN0aW9uc1xuICovXG5pbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgKiBhcyBIYXB0aWNzIGZyb20gXCJleHBvLWhhcHRpY3NcIjtcbmltcG9ydCB7IHVzZVF1ZXJ5LCB1c2VNdXRhdGlvbiB9IGZyb20gXCJAdGFuc3RhY2svcmVhY3QtcXVlcnlcIjtcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gXCJAcGF3ZmVjdG1hdGNoL2NvcmVcIjtcbmltcG9ydCB7IHVzZVNvY2tldCB9IGZyb20gXCIuLi8uLi91c2VTb2NrZXRcIjtcbmltcG9ydCBhcGlDbGllbnQgZnJvbSBcIi4uLy4uLy4uL3NlcnZpY2VzL2FwaUNsaWVudFwiO1xuXG5pbnRlcmZhY2UgU3Rvcnkge1xuICBfaWQ6IHN0cmluZztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIG1lZGlhVHlwZTogXCJwaG90b1wiIHwgXCJ2aWRlb1wiO1xuICBtZWRpYVVybDogc3RyaW5nO1xuICBjYXB0aW9uPzogc3RyaW5nO1xuICBkdXJhdGlvbjogbnVtYmVyO1xuICB2aWV3Q291bnQ6IG51bWJlcjtcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBTdG9yeVVzZXIge1xuICBfaWQ6IHN0cmluZztcbiAgdXNlcm5hbWU6IHN0cmluZztcbiAgcHJvZmlsZVBob3RvPzogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgU3RvcnlHcm91cCB7XG4gIHVzZXJJZDogc3RyaW5nO1xuICB1c2VyOiBTdG9yeVVzZXI7XG4gIHN0b3JpZXM6IFN0b3J5W107XG4gIHN0b3J5Q291bnQ6IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIFN0b3JpZXNGZWVkUmVzcG9uc2Uge1xuICBzdG9yaWVzOiBTdG9yeUdyb3VwW107XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBWaWV3U3RvcnlSZXNwb25zZSB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIHZpZXdDb3VudDogbnVtYmVyO1xufVxuXG5pbnRlcmZhY2UgVXNlU3Rvcmllc1JldHVybiB7XG4gIC8vIERhdGFcbiAgc3RvcnlHcm91cHM6IFN0b3J5R3JvdXBbXSB8IHVuZGVmaW5lZDtcbiAgaXNMb2FkaW5nOiBib29sZWFuO1xuICBlcnJvcjogc3RyaW5nIHwgbnVsbDtcblxuICAvLyBDdXJyZW50IG5hdmlnYXRpb24gc3RhdGVcbiAgY3VycmVudEdyb3VwSW5kZXg6IG51bWJlcjtcbiAgY3VycmVudFN0b3J5SW5kZXg6IG51bWJlcjtcbiAgY3VycmVudEdyb3VwOiBTdG9yeUdyb3VwIHwgdW5kZWZpbmVkO1xuICBjdXJyZW50U3Rvcnk6IFN0b3J5IHwgdW5kZWZpbmVkO1xuICBwcm9ncmVzczogbnVtYmVyO1xuICB2aWV3Q291bnQ6IG51bWJlcjtcblxuICAvLyBDb250cm9sc1xuICBpc1BhdXNlZDogYm9vbGVhbjtcbiAgaXNNdXRlZDogYm9vbGVhbjtcbiAgc2V0UGF1c2VkOiAocGF1c2VkOiBib29sZWFuKSA9PiB2b2lkO1xuICBzZXRNdXRlZDogKG11dGVkOiBib29sZWFuKSA9PiB2b2lkO1xuXG4gIC8vIE5hdmlnYXRpb25cbiAgZ29Ub05leHRTdG9yeTogKCkgPT4gdm9pZDtcbiAgZ29Ub1ByZXZpb3VzU3Rvcnk6ICgpID0+IHZvaWQ7XG4gIGdvVG9Hcm91cDogKGdyb3VwSW5kZXg6IG51bWJlcikgPT4gdm9pZDtcbiAgZ29Ub1N0b3J5OiAoZ3JvdXBJbmRleDogbnVtYmVyLCBzdG9yeUluZGV4OiBudW1iZXIpID0+IHZvaWQ7XG5cbiAgLy8gQWN0aW9uc1xuICBtYXJrQXNWaWV3ZWQ6IChzdG9yeUlkOiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD47XG4gIHJlZnJlc2hTdG9yaWVzOiAoKSA9PiBQcm9taXNlPHZvaWQ+O1xuXG4gIC8vIFJlZnMgZm9yIGV4dGVybmFsIHVzZSAodmlkZW8sIHRpbWVycywgZXRjLilcbiAgdGltZXJSZWY6IFJlYWN0Lk11dGFibGVSZWZPYmplY3Q8Tm9kZUpTLlRpbWVvdXQgfCBudWxsPjtcbiAgcHJvZ3Jlc3NJbnRlcnZhbFJlZjogUmVhY3QuTXV0YWJsZVJlZk9iamVjdDxOb2RlSlMuVGltZW91dCB8IG51bGw+O1xuICBsb25nUHJlc3NUaW1lcjogUmVhY3QuTXV0YWJsZVJlZk9iamVjdDxOb2RlSlMuVGltZW91dCB8IG51bGw+O1xufVxuXG5leHBvcnQgY29uc3QgdXNlU3RvcmllcyA9IChpbml0aWFsR3JvdXBJbmRleDogbnVtYmVyID0gMCk6IFVzZVN0b3JpZXNSZXR1cm4gPT4ge1xuICBjb25zdCBbY3VycmVudEdyb3VwSW5kZXgsIHNldEN1cnJlbnRHcm91cEluZGV4XSA9IHVzZVN0YXRlKGluaXRpYWxHcm91cEluZGV4KTtcbiAgY29uc3QgW2N1cnJlbnRTdG9yeUluZGV4LCBzZXRDdXJyZW50U3RvcnlJbmRleF0gPSB1c2VTdGF0ZSgwKTtcbiAgY29uc3QgW2lzUGF1c2VkLCBzZXRJc1BhdXNlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtpc011dGVkLCBzZXRJc011dGVkXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW3Byb2dyZXNzLCBzZXRQcm9ncmVzc10gPSB1c2VTdGF0ZSgwKTtcbiAgY29uc3QgW3ZpZXdDb3VudCwgc2V0Vmlld0NvdW50XSA9IHVzZVN0YXRlKDApO1xuXG4gIGNvbnN0IHRpbWVyUmVmID0gdXNlUmVmPE5vZGVKUy5UaW1lb3V0IHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IHByb2dyZXNzSW50ZXJ2YWxSZWYgPSB1c2VSZWY8Tm9kZUpTLlRpbWVvdXQgfCBudWxsPihudWxsKTtcbiAgY29uc3QgbG9uZ1ByZXNzVGltZXIgPSB1c2VSZWY8Tm9kZUpTLlRpbWVvdXQgfCBudWxsPihudWxsKTtcbiAgY29uc3Qgc29ja2V0ID0gdXNlU29ja2V0KCk7XG5cbiAgLy8gRmV0Y2ggc3RvcmllcyBmZWVkXG4gIGNvbnN0IHtcbiAgICBkYXRhOiBzdG9yeUdyb3VwcyxcbiAgICBpc0xvYWRpbmcsXG4gICAgZXJyb3IsXG4gICAgcmVmZXRjaCxcbiAgfSA9IHVzZVF1ZXJ5KHtcbiAgICBxdWVyeUtleTogW1wic3Rvcmllcy1mZWVkXCJdLFxuICAgIHF1ZXJ5Rm46IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpQ2xpZW50LmdldDxTdG9yaWVzRmVlZFJlc3BvbnNlPihcIi9zdG9yaWVzXCIpO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0b3JpZXM7XG4gICAgfSxcbiAgfSk7XG5cbiAgY29uc3QgY3VycmVudEdyb3VwID0gc3RvcnlHcm91cHM/LltjdXJyZW50R3JvdXBJbmRleF07XG5cbiAgLy8gV3JhcHBlciBmdW5jdGlvbiB0byBtYXRjaCBleHBlY3RlZCBpbnRlcmZhY2VcbiAgY29uc3QgcmVmcmVzaFN0b3JpZXMgPSB1c2VDYWxsYmFjayhhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgYXdhaXQgcmVmZXRjaCgpO1xuICB9LCBbcmVmZXRjaF0pO1xuXG4gIGNvbnN0IGN1cnJlbnRTdG9yeSA9IGN1cnJlbnRHcm91cD8uc3Rvcmllc1tjdXJyZW50U3RvcnlJbmRleF07XG5cbiAgLy8gTWFyayBzdG9yeSBhcyB2aWV3ZWQgbXV0YXRpb25cbiAgY29uc3Qgdmlld1N0b3J5TXV0YXRpb24gPSB1c2VNdXRhdGlvbih7XG4gICAgbXV0YXRpb25GbjogYXN5bmMgKHN0b3J5SWQ6IHN0cmluZykgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlDbGllbnQucG9zdDxWaWV3U3RvcnlSZXNwb25zZT4oXG4gICAgICAgIGAvc3Rvcmllcy8ke3N0b3J5SWR9L3ZpZXdgLFxuICAgICAgKTtcbiAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICB9LFxuICAgIG9uU3VjY2VzczogKGRhdGE6IFZpZXdTdG9yeVJlc3BvbnNlKSA9PiB7XG4gICAgICBzZXRWaWV3Q291bnQoZGF0YS52aWV3Q291bnQpO1xuICAgIH0sXG4gIH0pO1xuXG4gIC8vIE5hdmlnYXRpb24gZnVuY3Rpb25zXG4gIGNvbnN0IGdvVG9OZXh0U3RvcnkgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKCFjdXJyZW50R3JvdXApIHJldHVybjtcblxuICAgIEhhcHRpY3MuaW1wYWN0QXN5bmMoSGFwdGljcy5JbXBhY3RGZWVkYmFja1N0eWxlLkxpZ2h0KTtcblxuICAgIGlmIChjdXJyZW50U3RvcnlJbmRleCA8IGN1cnJlbnRHcm91cC5zdG9yaWVzLmxlbmd0aCAtIDEpIHtcbiAgICAgIHNldEN1cnJlbnRTdG9yeUluZGV4KChwcmV2KSA9PiBwcmV2ICsgMSk7XG4gICAgICBzZXRQcm9ncmVzcygwKTtcbiAgICB9IGVsc2UgaWYgKHN0b3J5R3JvdXBzICYmIGN1cnJlbnRHcm91cEluZGV4IDwgc3RvcnlHcm91cHMubGVuZ3RoIC0gMSkge1xuICAgICAgc2V0Q3VycmVudEdyb3VwSW5kZXgoKHByZXYpID0+IHByZXYgKyAxKTtcbiAgICAgIHNldEN1cnJlbnRTdG9yeUluZGV4KDApO1xuICAgICAgc2V0UHJvZ3Jlc3MoMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEVuZCBvZiBzdG9yaWVzIC0gY291bGQgZW1pdCBldmVudCBmb3IgcGFyZW50IHRvIGhhbmRsZSBuYXZpZ2F0aW9uXG4gICAgICBsb2dnZXIuaW5mbyhcIlJlYWNoZWQgZW5kIG9mIHN0b3JpZXNcIik7XG4gICAgfVxuICB9LCBbY3VycmVudEdyb3VwLCBjdXJyZW50U3RvcnlJbmRleCwgY3VycmVudEdyb3VwSW5kZXgsIHN0b3J5R3JvdXBzXSk7XG5cbiAgY29uc3QgZ29Ub1ByZXZpb3VzU3RvcnkgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgSGFwdGljcy5pbXBhY3RBc3luYyhIYXB0aWNzLkltcGFjdEZlZWRiYWNrU3R5bGUuTGlnaHQpO1xuXG4gICAgaWYgKGN1cnJlbnRTdG9yeUluZGV4ID4gMCkge1xuICAgICAgc2V0Q3VycmVudFN0b3J5SW5kZXgoKHByZXYpID0+IHByZXYgLSAxKTtcbiAgICAgIHNldFByb2dyZXNzKDApO1xuICAgIH0gZWxzZSBpZiAoY3VycmVudEdyb3VwSW5kZXggPiAwICYmIHN0b3J5R3JvdXBzKSB7XG4gICAgICBjb25zdCBwcmV2R3JvdXBJbmRleCA9IGN1cnJlbnRHcm91cEluZGV4IC0gMTtcbiAgICAgIGNvbnN0IHByZXZHcm91cCA9IHN0b3J5R3JvdXBzW3ByZXZHcm91cEluZGV4XTtcbiAgICAgIGlmIChwcmV2R3JvdXApIHtcbiAgICAgICAgc2V0Q3VycmVudEdyb3VwSW5kZXgocHJldkdyb3VwSW5kZXgpO1xuICAgICAgICBzZXRDdXJyZW50U3RvcnlJbmRleChwcmV2R3JvdXAuc3Rvcmllcy5sZW5ndGggLSAxKTtcbiAgICAgICAgc2V0UHJvZ3Jlc3MoMCk7XG4gICAgICB9XG4gICAgfVxuICB9LCBbY3VycmVudFN0b3J5SW5kZXgsIGN1cnJlbnRHcm91cEluZGV4LCBzdG9yeUdyb3Vwc10pO1xuXG4gIGNvbnN0IGdvVG9Hcm91cCA9IHVzZUNhbGxiYWNrKFxuICAgIChncm91cEluZGV4OiBudW1iZXIpID0+IHtcbiAgICAgIGlmIChncm91cEluZGV4ID49IDAgJiYgc3RvcnlHcm91cHMgJiYgZ3JvdXBJbmRleCA8IHN0b3J5R3JvdXBzLmxlbmd0aCkge1xuICAgICAgICBzZXRDdXJyZW50R3JvdXBJbmRleChncm91cEluZGV4KTtcbiAgICAgICAgc2V0Q3VycmVudFN0b3J5SW5kZXgoMCk7XG4gICAgICAgIHNldFByb2dyZXNzKDApO1xuICAgICAgfVxuICAgIH0sXG4gICAgW3N0b3J5R3JvdXBzXSxcbiAgKTtcblxuICBjb25zdCBnb1RvU3RvcnkgPSB1c2VDYWxsYmFjayhcbiAgICAoZ3JvdXBJbmRleDogbnVtYmVyLCBzdG9yeUluZGV4OiBudW1iZXIpID0+IHtcbiAgICAgIGlmIChncm91cEluZGV4ID49IDAgJiYgc3RvcnlHcm91cHMgJiYgZ3JvdXBJbmRleCA8IHN0b3J5R3JvdXBzLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBncm91cCA9IHN0b3J5R3JvdXBzW2dyb3VwSW5kZXhdO1xuICAgICAgICBpZiAoZ3JvdXAgJiYgc3RvcnlJbmRleCA+PSAwICYmIHN0b3J5SW5kZXggPCBncm91cC5zdG9yaWVzLmxlbmd0aCkge1xuICAgICAgICAgIHNldEN1cnJlbnRHcm91cEluZGV4KGdyb3VwSW5kZXgpO1xuICAgICAgICAgIHNldEN1cnJlbnRTdG9yeUluZGV4KHN0b3J5SW5kZXgpO1xuICAgICAgICAgIHNldFByb2dyZXNzKDApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBbc3RvcnlHcm91cHNdLFxuICApO1xuXG4gIC8vIEF1dG8tYWR2YW5jZSB0aW1lclxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICghY3VycmVudFN0b3J5IHx8IGlzUGF1c2VkKSByZXR1cm47XG5cbiAgICBjb25zdCBkdXJhdGlvbiA9IGN1cnJlbnRTdG9yeS5kdXJhdGlvbiAqIDEwMDA7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgIC8vIFByb2dyZXNzIHVwZGF0ZSBpbnRlcnZhbFxuICAgIHByb2dyZXNzSW50ZXJ2YWxSZWYuY3VycmVudCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGNvbnN0IGVsYXBzZWQgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgY29uc3QgbmV3UHJvZ3Jlc3MgPSBNYXRoLm1pbigoZWxhcHNlZCAvIGR1cmF0aW9uKSAqIDEwMCwgMTAwKTtcbiAgICAgIHNldFByb2dyZXNzKG5ld1Byb2dyZXNzKTtcbiAgICB9LCAxNik7IC8vIH42MGZwc1xuXG4gICAgLy8gQXV0by1hZHZhbmNlIHRpbWVyXG4gICAgdGltZXJSZWYuY3VycmVudCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgZ29Ub05leHRTdG9yeSgpO1xuICAgIH0sIGR1cmF0aW9uKTtcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBpZiAodGltZXJSZWYuY3VycmVudCkgY2xlYXJUaW1lb3V0KHRpbWVyUmVmLmN1cnJlbnQpO1xuICAgICAgaWYgKHByb2dyZXNzSW50ZXJ2YWxSZWYuY3VycmVudClcbiAgICAgICAgY2xlYXJJbnRlcnZhbChwcm9ncmVzc0ludGVydmFsUmVmLmN1cnJlbnQpO1xuICAgIH07XG4gIH0sIFtjdXJyZW50U3RvcnksIGlzUGF1c2VkLCBnb1RvTmV4dFN0b3J5XSk7XG5cbiAgLy8gTWFyayBzdG9yeSBhcyB2aWV3ZWRcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoY3VycmVudFN0b3J5KSB7XG4gICAgICB2aWV3U3RvcnlNdXRhdGlvbi5tdXRhdGUoY3VycmVudFN0b3J5Ll9pZCk7XG4gICAgfVxuICB9LCBbY3VycmVudFN0b3J5Py5faWRdKTtcblxuICAvLyBTb2NrZXQuaW8gcmVhbC10aW1lIHZpZXcgdXBkYXRlc1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICghc29ja2V0IHx8ICFjdXJyZW50U3RvcnkpIHJldHVybjtcblxuICAgIGNvbnN0IGhhbmRsZVN0b3J5Vmlld2VkID0gKGRhdGE6IHtcbiAgICAgIHN0b3J5SWQ6IHN0cmluZztcbiAgICAgIHZpZXdDb3VudDogbnVtYmVyO1xuICAgIH0pID0+IHtcbiAgICAgIGlmIChkYXRhLnN0b3J5SWQgPT09IGN1cnJlbnRTdG9yeS5faWQpIHtcbiAgICAgICAgc2V0Vmlld0NvdW50KGRhdGEudmlld0NvdW50KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgc29ja2V0Lm9uKFwic3Rvcnk6dmlld2VkXCIsIGhhbmRsZVN0b3J5Vmlld2VkKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgc29ja2V0Lm9mZihcInN0b3J5OnZpZXdlZFwiLCBoYW5kbGVTdG9yeVZpZXdlZCk7XG4gICAgfTtcbiAgfSwgW3NvY2tldCwgY3VycmVudFN0b3J5Py5faWRdKTtcblxuICBjb25zdCBtYXJrQXNWaWV3ZWQgPSB1c2VDYWxsYmFjayhcbiAgICBhc3luYyAoc3RvcnlJZDogc3RyaW5nKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB2aWV3U3RvcnlNdXRhdGlvbi5tdXRhdGVBc3luYyhzdG9yeUlkKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBtYXJrIHN0b3J5IGFzIHZpZXdlZFwiLCB7IGVycm9yLCBzdG9yeUlkIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgW3ZpZXdTdG9yeU11dGF0aW9uXSxcbiAgKTtcblxuICBjb25zdCBzZXRQYXVzZWQgPSB1c2VDYWxsYmFjaygocGF1c2VkOiBib29sZWFuKSA9PiB7XG4gICAgc2V0SXNQYXVzZWQocGF1c2VkKTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IHNldE11dGVkID0gdXNlQ2FsbGJhY2soKG11dGVkOiBib29sZWFuKSA9PiB7XG4gICAgc2V0SXNNdXRlZChtdXRlZCk7XG4gIH0sIFtdKTtcblxuICByZXR1cm4ge1xuICAgIC8vIERhdGFcbiAgICBzdG9yeUdyb3VwcyxcbiAgICBpc0xvYWRpbmcsXG4gICAgZXJyb3I6IGVycm9yPy5tZXNzYWdlIHx8IG51bGwsXG5cbiAgICAvLyBDdXJyZW50IG5hdmlnYXRpb24gc3RhdGVcbiAgICBjdXJyZW50R3JvdXBJbmRleCxcbiAgICBjdXJyZW50U3RvcnlJbmRleCxcbiAgICBjdXJyZW50R3JvdXAsXG4gICAgY3VycmVudFN0b3J5LFxuICAgIHByb2dyZXNzLFxuICAgIHZpZXdDb3VudCxcblxuICAgIC8vIENvbnRyb2xzXG4gICAgaXNQYXVzZWQsXG4gICAgaXNNdXRlZCxcbiAgICBzZXRQYXVzZWQsXG4gICAgc2V0TXV0ZWQsXG5cbiAgICAvLyBOYXZpZ2F0aW9uXG4gICAgZ29Ub05leHRTdG9yeSxcbiAgICBnb1RvUHJldmlvdXNTdG9yeSxcbiAgICBnb1RvR3JvdXAsXG4gICAgZ29Ub1N0b3J5LFxuXG4gICAgLy8gQWN0aW9uc1xuICAgIG1hcmtBc1ZpZXdlZCxcbiAgICByZWZyZXNoU3RvcmllcyxcblxuICAgIC8vIFJlZnMgZm9yIGV4dGVybmFsIHVzZVxuICAgIHRp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