{"version":3,"names":["_getJestObj","mock","gdprService","requestAccountDeletion","jest","fn","cancelDeletion","_interopRequireDefault","require","_asyncToGenerator2","_reactNative","_useAccountDeletion","_gdprService","_require","mockGdprService","describe","beforeEach","clearAllMocks","mockResolvedValue","success","message","gracePeriodEndsAt","deletionId","it","_renderHook","renderHook","useAccountDeletion","result","expect","current","isDeleting","toBe","error","default","_renderHook2","act","requestDeletion","waitFor","toHaveBeenCalledWith","mockRejectedValue","Error","_renderHook3","_renderHook4","toHaveBeenCalledTimes","_renderHook5","_renderHook6","undefined","_renderHook7","firstRequest","firstCancel","_renderHook8","result2"],"sources":["useAccountDeletion.test.ts"],"sourcesContent":["/**\n * @jest-environment jsdom\n */\nimport { renderHook, act, waitFor } from \"@testing-library/react-native\";\nimport { useAccountDeletion } from \"../useAccountDeletion\";\n\n// Mock the GDPR service\njest.mock(\"../../../../services/gdprService\", () => ({\n  gdprService: {\n    requestAccountDeletion: jest.fn(),\n    cancelDeletion: jest.fn(),\n  },\n}));\n\nimport { gdprService } from \"../../../../services/gdprService\";\n\nconst mockGdprService = gdprService as jest.Mocked<typeof gdprService>;\n\ndescribe(\"useAccountDeletion\", () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    mockGdprService.requestAccountDeletion.mockResolvedValue({\n      success: true,\n      message: \"Deletion requested successfully\",\n      gracePeriodEndsAt: \"2024-12-26T00:00:00.000Z\",\n      deletionId: \"test-deletion-id\",\n    });\n    mockGdprService.cancelDeletion.mockResolvedValue({\n      success: true,\n      message: \"Deletion cancelled successfully\",\n    });\n  });\n\n  it(\"should initialize with correct default state\", () => {\n    const { result } = renderHook(() => useAccountDeletion());\n\n    expect(result.current.isDeleting).toBe(false);\n    expect(result.current.error).toBe(null);\n  });\n\n  it(\"should request account deletion successfully\", async () => {\n    const { result } = renderHook(() => useAccountDeletion());\n\n    act(() => {\n      result.current.requestDeletion(\n        \"password123\",\n        \"Privacy concerns\",\n        \"Detailed feedback\",\n      );\n    });\n\n    expect(result.current.isDeleting).toBe(true);\n\n    await waitFor(() => {\n      expect(result.current.isDeleting).toBe(false);\n    });\n\n    expect(mockGdprService.requestAccountDeletion).toHaveBeenCalledWith(\n      \"password123\",\n      \"Privacy concerns\",\n      \"Detailed feedback\",\n    );\n    expect(result.current.error).toBe(null);\n  });\n\n  it(\"should handle request deletion failure\", async () => {\n    mockGdprService.requestAccountDeletion.mockRejectedValue(\n      new Error(\"Invalid password\"),\n    );\n\n    const { result } = renderHook(() => useAccountDeletion());\n\n    act(() => {\n      result.current.requestDeletion(\"wrongpassword\");\n    });\n\n    await waitFor(() => {\n      expect(result.current.isDeleting).toBe(false);\n    });\n\n    expect(result.current.error).toBe(\"Invalid password\");\n  });\n\n  it(\"should cancel account deletion successfully\", async () => {\n    const { result } = renderHook(() => useAccountDeletion());\n\n    act(() => {\n      result.current.cancelDeletion();\n    });\n\n    expect(result.current.isDeleting).toBe(true);\n\n    await waitFor(() => {\n      expect(result.current.isDeleting).toBe(false);\n    });\n\n    expect(mockGdprService.cancelDeletion).toHaveBeenCalledTimes(1);\n    expect(result.current.error).toBe(null);\n  });\n\n  it(\"should handle cancel deletion failure\", async () => {\n    mockGdprService.cancelDeletion.mockRejectedValue(\n      new Error(\"Cancellation failed\"),\n    );\n\n    const { result } = renderHook(() => useAccountDeletion());\n\n    act(() => {\n      result.current.cancelDeletion();\n    });\n\n    await waitFor(() => {\n      expect(result.current.isDeleting).toBe(false);\n    });\n\n    expect(result.current.error).toBe(\"Cancellation failed\");\n  });\n\n  it(\"should request deletion with minimal parameters\", async () => {\n    const { result } = renderHook(() => useAccountDeletion());\n\n    act(() => {\n      result.current.requestDeletion(\"password123\");\n    });\n\n    await waitFor(() => {\n      expect(result.current.isDeleting).toBe(false);\n    });\n\n    expect(mockGdprService.requestAccountDeletion).toHaveBeenCalledWith(\n      \"password123\",\n      undefined,\n      undefined,\n    );\n  });\n\n  it(\"should return stable function references\", () => {\n    const { result } = renderHook(() => useAccountDeletion());\n\n    const firstRequest = result.current.requestDeletion;\n    const firstCancel = result.current.cancelDeletion;\n\n    // In React Native testing, create a new hook instance to test stability\n    const { result: result2 } = renderHook(() => useAccountDeletion());\n\n    expect(result.current.requestDeletion).toBe(firstRequest);\n    expect(result.current.cancelDeletion).toBe(firstCancel);\n  });\n});\n"],"mappings":"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","ignoreList":[]}