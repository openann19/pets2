{"version":3,"names":["_getJestObj","mock","getItem","jest","fn","setItem","_interopRequireDefault","require","_asyncToGenerator2","_reactNative","_useScrollPersistence","_asyncStorage","_require","mockAsyncStorage","AsyncStorage","describe","beforeEach","clearAllMocks","mockResolvedValue","it","_renderHook","renderHook","useScrollPersistence","key","result","expect","current","scrollPosition","toBe","default","JSON","stringify","y","_renderHook2","act","Promise","resolve","setTimeout","_renderHook3","saveScrollPosition","toHaveBeenCalledWith","timestamp","any","Number","_renderHook4","consoleSpy","spyOn","console","mockImplementation","mockRejectedValue","Error","_renderHook5","toHaveBeenCalled","mockRestore","_renderHook6","clearScrollPosition","_renderHook7","defaultPosition","_renderHook8","firstSave","firstClear","_renderHook9","result2"],"sources":["useScrollPersistence.test.ts"],"sourcesContent":["/**\n * @jest-environment jsdom\n */\nimport { renderHook, act } from \"@testing-library/react-native\";\nimport { useScrollPersistence } from \"../useScrollPersistence\";\n\n// Mock AsyncStorage\njest.mock(\"@react-native-async-storage/async-storage\", () => ({\n  getItem: jest.fn(),\n  setItem: jest.fn(),\n}));\n\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\n\nconst mockAsyncStorage = AsyncStorage as jest.Mocked<typeof AsyncStorage>;\n\ndescribe(\"useScrollPersistence\", () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    mockAsyncStorage.getItem.mockResolvedValue(null);\n    mockAsyncStorage.setItem.mockResolvedValue();\n  });\n\n  it(\"should initialize with default scroll position\", () => {\n    const { result } = renderHook(() =>\n      useScrollPersistence({ key: \"test-scroll\" }),\n    );\n\n    expect(result.current.scrollPosition).toBe(0);\n  });\n\n  it(\"should load stored scroll position\", async () => {\n    mockAsyncStorage.getItem.mockResolvedValue(JSON.stringify({ y: 150 }));\n\n    const { result } = renderHook(() =>\n      useScrollPersistence({ key: \"test-scroll\" }),\n    );\n\n    // Wait for async load\n    await act(async () => {\n      await new Promise((resolve) => setTimeout(resolve, 0));\n    });\n\n    expect(result.current.scrollPosition).toBe(150);\n  });\n\n  it(\"should save scroll position when updated\", async () => {\n    const { result } = renderHook(() =>\n      useScrollPersistence({ key: \"test-scroll\" }),\n    );\n\n    await act(async () => {\n      await new Promise((resolve) => setTimeout(resolve, 0));\n    });\n\n    act(() => {\n      result.current.saveScrollPosition(250);\n    });\n\n    expect(mockAsyncStorage.setItem).toHaveBeenCalledWith(\n      \"test-scroll\",\n      JSON.stringify({ y: 250, timestamp: expect.any(Number) }),\n    );\n    expect(result.current.scrollPosition).toBe(250);\n  });\n\n  it(\"should restore scroll position\", async () => {\n    mockAsyncStorage.getItem.mockResolvedValue(JSON.stringify({ y: 100 }));\n\n    const { result } = renderHook(() =>\n      useScrollPersistence({ key: \"test-scroll\" }),\n    );\n\n    await act(async () => {\n      await new Promise((resolve) => setTimeout(resolve, 0));\n    });\n\n    expect(result.current.scrollPosition).toBe(100);\n\n    act(() => {\n      result.current.saveScrollPosition(200);\n    });\n\n    expect(result.current.scrollPosition).toBe(200);\n  });\n\n  it(\"should handle AsyncStorage errors gracefully\", async () => {\n    const consoleSpy = jest.spyOn(console, \"error\").mockImplementation();\n    mockAsyncStorage.getItem.mockRejectedValue(new Error(\"Storage error\"));\n\n    const { result } = renderHook(() =>\n      useScrollPersistence({ key: \"error-scroll\" }),\n    );\n\n    await act(async () => {\n      await new Promise((resolve) => setTimeout(resolve, 0));\n    });\n\n    expect(result.current.scrollPosition).toBe(0);\n    expect(consoleSpy).toHaveBeenCalled();\n\n    consoleSpy.mockRestore();\n  });\n\n  it(\"should clear stored scroll position\", async () => {\n    mockAsyncStorage.getItem.mockResolvedValue(JSON.stringify({ y: 75 }));\n\n    const { result } = renderHook(() =>\n      useScrollPersistence({ key: \"clear-test\" }),\n    );\n\n    await act(async () => {\n      await new Promise((resolve) => setTimeout(resolve, 0));\n    });\n\n    expect(result.current.scrollPosition).toBe(75);\n\n    act(() => {\n      result.current.clearScrollPosition();\n    });\n\n    expect(result.current.scrollPosition).toBe(0);\n  });\n\n  it(\"should work with custom default position\", () => {\n    const { result } = renderHook(() =>\n      useScrollPersistence({ key: \"custom-default\", defaultPosition: 50 }),\n    );\n\n    expect(result.current.scrollPosition).toBe(50);\n  });\n\n  it(\"should return stable function references\", async () => {\n    const { result } = renderHook(() =>\n      useScrollPersistence({ key: \"stable-test\" }),\n    );\n\n    await act(async () => {\n      await new Promise((resolve) => setTimeout(resolve, 0));\n    });\n\n    const firstSave = result.current.saveScrollPosition;\n    const firstClear = result.current.clearScrollPosition;\n\n    // Create new hook instance\n    const { result: result2 } = renderHook(() =>\n      useScrollPersistence({ key: \"stable-test-2\" }),\n    );\n\n    await act(async () => {\n      await new Promise((resolve) => setTimeout(resolve, 0));\n    });\n\n    expect(result.current.saveScrollPosition).toBe(firstSave);\n    expect(result.current.clearScrollPosition).toBe(firstClear);\n  });\n});\n"],"mappings":"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","ignoreList":[]}