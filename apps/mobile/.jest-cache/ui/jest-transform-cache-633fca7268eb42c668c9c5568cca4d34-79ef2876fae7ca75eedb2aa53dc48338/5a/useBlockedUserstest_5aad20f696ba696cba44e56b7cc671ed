363d430e76313f7f8dbc315c4c570a28
"use strict";

_getJestObj().mock("@pawfectmatch/core", function () {
  return {
    logger: {
      info: jest.fn(),
      error: jest.fn()
    }
  };
});
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _reactNative = require("@testing-library/react-native");
var _reactNative2 = require("react-native");
var _useBlockedUsers = require("../useBlockedUsers");
function _getJestObj() {
  var _require = require("@jest/globals"),
    jest = _require.jest;
  _getJestObj = function _getJestObj() {
    return jest;
  };
  return jest;
}
jest.spyOn(_reactNative2.Alert, "alert");
describe("useBlockedUsers", function () {
  beforeEach(function () {
    jest.clearAllMocks();
    jest.useFakeTimers();
  });
  afterEach(function () {
    jest.runOnlyPendingTimers();
    jest.useRealTimers();
  });
  it("should initialize with loading state", function () {
    var _renderHook = (0, _reactNative.renderHook)(function () {
        return (0, _useBlockedUsers.useBlockedUsers)();
      }),
      result = _renderHook.result;
    expect(result.current.isLoading).toBe(true);
    expect(result.current.blockedUsers).toEqual([]);
    expect(result.current.isRefreshing).toBe(false);
  });
  it("should load blocked users manually", (0, _asyncToGenerator2.default)(function* () {
    var _renderHook2 = (0, _reactNative.renderHook)(function () {
        return (0, _useBlockedUsers.useBlockedUsers)();
      }),
      result = _renderHook2.result;
    yield (0, _reactNative.act)((0, _asyncToGenerator2.default)(function* () {
      yield result.current.loadBlockedUsers();
    }));
    yield (0, _reactNative.waitFor)(function () {
      expect(result.current.isLoading).toBe(false);
    });
    expect(result.current.blockedUsers).toHaveLength(2);
    expect(result.current.totalBlocked).toBe(2);
  }));
  it("should load blocked users on mount with timer", (0, _asyncToGenerator2.default)(function* () {
    var _renderHook3 = (0, _reactNative.renderHook)(function () {
        return (0, _useBlockedUsers.useBlockedUsers)();
      }),
      result = _renderHook3.result;
    (0, _reactNative.act)(function () {
      jest.advanceTimersByTime(1000);
    });
    yield (0, _reactNative.waitFor)(function () {
      expect(result.current.isLoading).toBe(false);
    });
    expect(result.current.blockedUsers).toHaveLength(2);
  }));
  it("should refresh blocked users", (0, _asyncToGenerator2.default)(function* () {
    var _renderHook4 = (0, _reactNative.renderHook)(function () {
        return (0, _useBlockedUsers.useBlockedUsers)();
      }),
      result = _renderHook4.result;
    (0, _reactNative.act)(function () {
      jest.advanceTimersByTime(1000);
    });
    yield (0, _reactNative.waitFor)(function () {
      expect(result.current.isLoading).toBe(false);
    });
    yield (0, _reactNative.act)((0, _asyncToGenerator2.default)(function* () {
      yield result.current.refreshData();
    }));
    expect(result.current.isRefreshing).toBe(false);
  }));
  it("should unblock a user", (0, _asyncToGenerator2.default)(function* () {
    var _renderHook5 = (0, _reactNative.renderHook)(function () {
        return (0, _useBlockedUsers.useBlockedUsers)();
      }),
      result = _renderHook5.result;
    (0, _reactNative.act)(function () {
      jest.advanceTimersByTime(1000);
    });
    yield (0, _reactNative.waitFor)(function () {
      expect(result.current.isLoading).toBe(false);
    });
    var initialCount = result.current.blockedUsers.length;
    yield (0, _reactNative.act)((0, _asyncToGenerator2.default)(function* () {
      yield result.current.unblockUser("user1", "John Doe");
    }));
    expect(_reactNative2.Alert.alert).toHaveBeenCalledWith("Unblock User", "Are you sure you want to unblock John Doe?", expect.arrayContaining([expect.objectContaining({
      text: "Cancel",
      style: "cancel"
    }), expect.objectContaining({
      text: "Unblock",
      style: "destructive"
    })]));
  }));
  it("should block a user", (0, _asyncToGenerator2.default)(function* () {
    var _renderHook6 = (0, _reactNative.renderHook)(function () {
        return (0, _useBlockedUsers.useBlockedUsers)();
      }),
      result = _renderHook6.result;
    yield (0, _reactNative.act)((0, _asyncToGenerator2.default)(function* () {
      var success = yield result.current.blockUser("user3", "Spam");
      expect(success).toBe(true);
    }));
  }));
  it("should handle blocking user failure", (0, _asyncToGenerator2.default)(function* () {
    var mockLogger = require("@pawfectmatch/core").logger;
    mockLogger.info.mockImplementationOnce(function () {
      throw new Error("Network error");
    });
    var _renderHook7 = (0, _reactNative.renderHook)(function () {
        return (0, _useBlockedUsers.useBlockedUsers)();
      }),
      result = _renderHook7.result;
    yield (0, _reactNative.act)((0, _asyncToGenerator2.default)(function* () {
      var success = yield result.current.blockUser("user3", "Spam");
      expect(success).toBe(false);
    }));
    yield (0, _reactNative.waitFor)(function () {
      expect(result.current.isLoading).toBe(false);
    });
    var firstUser = result.current.blockedUsers[0];
    expect(firstUser).toHaveProperty("id");
    expect(firstUser).toHaveProperty("name");
    expect(firstUser).toHaveProperty("email");
    expect(firstUser).toHaveProperty("blockedAt");
    expect(firstUser).toHaveProperty("reason");
    expect(firstUser.reason).toBe("Inappropriate behavior");
  }));
  it("should track blocked timestamp", (0, _asyncToGenerator2.default)(function* () {
    var _renderHook8 = (0, _reactNative.renderHook)(function () {
        return (0, _useBlockedUsers.useBlockedUsers)();
      }),
      result = _renderHook8.result;
    (0, _reactNative.act)(function () {
      jest.advanceTimersByTime(1000);
    });
    yield (0, _reactNative.waitFor)(function () {
      expect(result.current.isLoading).toBe(false);
    });
    var firstUser = result.current.blockedUsers[0];
    expect(firstUser.blockedAt).toBeDefined();
    expect(new Date(firstUser.blockedAt)).toBeInstanceOf(Date);
  }));
  it("should return stable function references", function () {
    var _renderHook9 = (0, _reactNative.renderHook)(function () {
        return (0, _useBlockedUsers.useBlockedUsers)();
      }),
      result = _renderHook9.result;
    (0, _reactNative.act)(function () {
      jest.advanceTimersByTime(1000);
    });
    var firstRefreshData = result.current.refreshData;
    var firstBlockUser = result.current.blockUser;
    var firstUnblockUser = result.current.unblockUser;
    (0, _reactNative.act)(function () {
      jest.advanceTimersByTime(100);
    });
    expect(result.current.refreshData).toBe(firstRefreshData);
    expect(result.current.blockUser).toBe(firstBlockUser);
    expect(result.current.unblockUser).toBe(firstUnblockUser);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJsb2dnZXIiLCJpbmZvIiwiamVzdCIsImZuIiwiZXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9hc3luY1RvR2VuZXJhdG9yMiIsIl9yZWFjdE5hdGl2ZSIsIl9yZWFjdE5hdGl2ZTIiLCJfdXNlQmxvY2tlZFVzZXJzIiwiX3JlcXVpcmUiLCJzcHlPbiIsIkFsZXJ0IiwiZGVzY3JpYmUiLCJiZWZvcmVFYWNoIiwiY2xlYXJBbGxNb2NrcyIsInVzZUZha2VUaW1lcnMiLCJhZnRlckVhY2giLCJydW5Pbmx5UGVuZGluZ1RpbWVycyIsInVzZVJlYWxUaW1lcnMiLCJpdCIsIl9yZW5kZXJIb29rIiwicmVuZGVySG9vayIsInVzZUJsb2NrZWRVc2VycyIsInJlc3VsdCIsImV4cGVjdCIsImN1cnJlbnQiLCJpc0xvYWRpbmciLCJ0b0JlIiwiYmxvY2tlZFVzZXJzIiwidG9FcXVhbCIsImlzUmVmcmVzaGluZyIsImRlZmF1bHQiLCJfcmVuZGVySG9vazIiLCJhY3QiLCJsb2FkQmxvY2tlZFVzZXJzIiwid2FpdEZvciIsInRvSGF2ZUxlbmd0aCIsInRvdGFsQmxvY2tlZCIsIl9yZW5kZXJIb29rMyIsImFkdmFuY2VUaW1lcnNCeVRpbWUiLCJfcmVuZGVySG9vazQiLCJyZWZyZXNoRGF0YSIsIl9yZW5kZXJIb29rNSIsImluaXRpYWxDb3VudCIsImxlbmd0aCIsInVuYmxvY2tVc2VyIiwiYWxlcnQiLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsImFycmF5Q29udGFpbmluZyIsIm9iamVjdENvbnRhaW5pbmciLCJ0ZXh0Iiwic3R5bGUiLCJfcmVuZGVySG9vazYiLCJzdWNjZXNzIiwiYmxvY2tVc2VyIiwibW9ja0xvZ2dlciIsIm1vY2tJbXBsZW1lbnRhdGlvbk9uY2UiLCJFcnJvciIsIl9yZW5kZXJIb29rNyIsImZpcnN0VXNlciIsInRvSGF2ZVByb3BlcnR5IiwicmVhc29uIiwiX3JlbmRlckhvb2s4IiwiYmxvY2tlZEF0IiwidG9CZURlZmluZWQiLCJEYXRlIiwidG9CZUluc3RhbmNlT2YiLCJfcmVuZGVySG9vazkiLCJmaXJzdFJlZnJlc2hEYXRhIiwiZmlyc3RCbG9ja1VzZXIiLCJmaXJzdFVuYmxvY2tVc2VyIl0sInNvdXJjZXMiOlsidXNlQmxvY2tlZFVzZXJzLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAamVzdC1lbnZpcm9ubWVudCBqc2RvbVxuICovXG5pbXBvcnQgeyByZW5kZXJIb29rLCBhY3QsIHdhaXRGb3IgfSBmcm9tIFwiQHRlc3RpbmctbGlicmFyeS9yZWFjdC1uYXRpdmVcIjtcbmltcG9ydCB7IEFsZXJ0IH0gZnJvbSBcInJlYWN0LW5hdGl2ZVwiO1xuaW1wb3J0IHsgdXNlQmxvY2tlZFVzZXJzIH0gZnJvbSBcIi4uL3VzZUJsb2NrZWRVc2Vyc1wiO1xuXG4vLyBNb2NrIEFsZXJ0XG5qZXN0LnNweU9uKEFsZXJ0LCBcImFsZXJ0XCIpO1xuXG4vLyBNb2NrIGxvZ2dlclxuamVzdC5tb2NrKFwiQHBhd2ZlY3RtYXRjaC9jb3JlXCIsICgpID0+ICh7XG4gIGxvZ2dlcjoge1xuICAgIGluZm86IGplc3QuZm4oKSxcbiAgICBlcnJvcjogamVzdC5mbigpLFxuICB9LFxufSkpO1xuXG5kZXNjcmliZShcInVzZUJsb2NrZWRVc2Vyc1wiLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIGplc3QudXNlRmFrZVRpbWVycygpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QucnVuT25seVBlbmRpbmdUaW1lcnMoKTtcbiAgICBqZXN0LnVzZVJlYWxUaW1lcnMoKTtcbiAgfSk7XG5cbiAgaXQoXCJzaG91bGQgaW5pdGlhbGl6ZSB3aXRoIGxvYWRpbmcgc3RhdGVcIiwgKCkgPT4ge1xuICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUJsb2NrZWRVc2VycygpKTtcblxuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5pc0xvYWRpbmcpLnRvQmUodHJ1ZSk7XG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LmJsb2NrZWRVc2VycykudG9FcXVhbChbXSk7XG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LmlzUmVmcmVzaGluZykudG9CZShmYWxzZSk7XG4gIH0pO1xuXG4gIGl0KFwic2hvdWxkIGxvYWQgYmxvY2tlZCB1c2VycyBtYW51YWxseVwiLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlQmxvY2tlZFVzZXJzKCkpO1xuXG4gICAgLy8gTWFudWFsbHkgbG9hZCB1c2Vyc1xuICAgIGF3YWl0IGFjdChhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCByZXN1bHQuY3VycmVudC5sb2FkQmxvY2tlZFVzZXJzKCk7XG4gICAgfSk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5pc0xvYWRpbmcpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LmJsb2NrZWRVc2VycykudG9IYXZlTGVuZ3RoKDIpO1xuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC50b3RhbEJsb2NrZWQpLnRvQmUoMik7XG4gIH0pO1xuXG4gIGl0KFwic2hvdWxkIGxvYWQgYmxvY2tlZCB1c2VycyBvbiBtb3VudCB3aXRoIHRpbWVyXCIsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VCbG9ja2VkVXNlcnMoKSk7XG5cbiAgICAvLyBXYWl0IGZvciB0aGUgdXNlRWZmZWN0IHRvIHRyaWdnZXIgbG9hZEJsb2NrZWRVc2Vyc1xuICAgIGFjdCgoKSA9PiB7XG4gICAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMTAwMCk7XG4gICAgfSk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5pc0xvYWRpbmcpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LmJsb2NrZWRVc2VycykudG9IYXZlTGVuZ3RoKDIpO1xuICB9KTtcblxuICBpdChcInNob3VsZCByZWZyZXNoIGJsb2NrZWQgdXNlcnNcIiwgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUJsb2NrZWRVc2VycygpKTtcblxuICAgIC8vIEluaXRpYWwgbG9hZFxuICAgIGFjdCgoKSA9PiB7XG4gICAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMTAwMCk7XG4gICAgfSk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5pc0xvYWRpbmcpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgLy8gUmVmcmVzaFxuICAgIGF3YWl0IGFjdChhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCByZXN1bHQuY3VycmVudC5yZWZyZXNoRGF0YSgpO1xuICAgIH0pO1xuXG4gICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LmlzUmVmcmVzaGluZykudG9CZShmYWxzZSk7XG4gIH0pO1xuXG4gIGl0KFwic2hvdWxkIHVuYmxvY2sgYSB1c2VyXCIsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VCbG9ja2VkVXNlcnMoKSk7XG5cbiAgICAvLyBMb2FkIHVzZXJzIGZpcnN0XG4gICAgYWN0KCgpID0+IHtcbiAgICAgIGplc3QuYWR2YW5jZVRpbWVyc0J5VGltZSgxMDAwKTtcbiAgICB9KTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LmlzTG9hZGluZykudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBpbml0aWFsQ291bnQgPSByZXN1bHQuY3VycmVudC5ibG9ja2VkVXNlcnMubGVuZ3RoO1xuXG4gICAgLy8gTW9jayB0aGUgYWxlcnQgY29uZmlybWF0aW9uIGJ5IGNhbGxpbmcgdGhlIG9uUHJlc3MgZGlyZWN0bHlcbiAgICBhd2FpdCBhY3QoYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gU2ltdWxhdGUgdXNlciBjb25maXJtaW5nIHVuYmxvY2tcbiAgICAgIGF3YWl0IHJlc3VsdC5jdXJyZW50LnVuYmxvY2tVc2VyKFwidXNlcjFcIiwgXCJKb2huIERvZVwiKTtcbiAgICB9KTtcblxuICAgIC8vIFNpbmNlIEFsZXJ0LmFsZXJ0IGlzIG1vY2tlZCwgd2UgbmVlZCB0byBzaW11bGF0ZSB0aGUgY29uZmlybWF0aW9uXG4gICAgLy8gSW4gYSByZWFsIHNjZW5hcmlvLCB0aGUgYWxlcnQgY2FsbGJhY2sgd291bGQgYmUgY2FsbGVkXG4gICAgLy8gRm9yIHRlc3RpbmcsIHdlJ2xsIGp1c3QgdmVyaWZ5IHRoZSBhbGVydCB3YXMgc2hvd25cbiAgICBleHBlY3QoQWxlcnQuYWxlcnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgXCJVbmJsb2NrIFVzZXJcIixcbiAgICAgIFwiQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIHVuYmxvY2sgSm9obiBEb2U/XCIsXG4gICAgICBleHBlY3QuYXJyYXlDb250YWluaW5nKFtcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyB0ZXh0OiBcIkNhbmNlbFwiLCBzdHlsZTogXCJjYW5jZWxcIiB9KSxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyB0ZXh0OiBcIlVuYmxvY2tcIiwgc3R5bGU6IFwiZGVzdHJ1Y3RpdmVcIiB9KSxcbiAgICAgIF0pLFxuICAgICk7XG4gIH0pO1xuXG4gIGl0KFwic2hvdWxkIGJsb2NrIGEgdXNlclwiLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlQmxvY2tlZFVzZXJzKCkpO1xuXG4gICAgYXdhaXQgYWN0KGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBhd2FpdCByZXN1bHQuY3VycmVudC5ibG9ja1VzZXIoXCJ1c2VyM1wiLCBcIlNwYW1cIik7XG4gICAgICBleHBlY3Qoc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoXCJzaG91bGQgaGFuZGxlIGJsb2NraW5nIHVzZXIgZmFpbHVyZVwiLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gTW9jayBsb2dnZXIgdG8gdGhyb3cgZXJyb3JcbiAgICBjb25zdCBtb2NrTG9nZ2VyID0gcmVxdWlyZShcIkBwYXdmZWN0bWF0Y2gvY29yZVwiKS5sb2dnZXI7XG4gICAgbW9ja0xvZ2dlci5pbmZvLm1vY2tJbXBsZW1lbnRhdGlvbk9uY2UoKCkgPT4ge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTmV0d29yayBlcnJvclwiKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUJsb2NrZWRVc2VycygpKTtcblxuICAgIGF3YWl0IGFjdChhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzdWNjZXNzID0gYXdhaXQgcmVzdWx0LmN1cnJlbnQuYmxvY2tVc2VyKFwidXNlcjNcIiwgXCJTcGFtXCIpO1xuICAgICAgZXhwZWN0KHN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuaXNMb2FkaW5nKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGZpcnN0VXNlciA9IHJlc3VsdC5jdXJyZW50LmJsb2NrZWRVc2Vyc1swXTtcbiAgICBleHBlY3QoZmlyc3RVc2VyKS50b0hhdmVQcm9wZXJ0eShcImlkXCIpO1xuICAgIGV4cGVjdChmaXJzdFVzZXIpLnRvSGF2ZVByb3BlcnR5KFwibmFtZVwiKTtcbiAgICBleHBlY3QoZmlyc3RVc2VyKS50b0hhdmVQcm9wZXJ0eShcImVtYWlsXCIpO1xuICAgIGV4cGVjdChmaXJzdFVzZXIpLnRvSGF2ZVByb3BlcnR5KFwiYmxvY2tlZEF0XCIpO1xuICAgIGV4cGVjdChmaXJzdFVzZXIpLnRvSGF2ZVByb3BlcnR5KFwicmVhc29uXCIpO1xuICAgIGV4cGVjdChmaXJzdFVzZXIucmVhc29uKS50b0JlKFwiSW5hcHByb3ByaWF0ZSBiZWhhdmlvclwiKTtcbiAgfSk7XG5cbiAgaXQoXCJzaG91bGQgdHJhY2sgYmxvY2tlZCB0aW1lc3RhbXBcIiwgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUJsb2NrZWRVc2VycygpKTtcblxuICAgIGFjdCgoKSA9PiB7XG4gICAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMTAwMCk7XG4gICAgfSk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5pc0xvYWRpbmcpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgY29uc3QgZmlyc3RVc2VyID0gcmVzdWx0LmN1cnJlbnQuYmxvY2tlZFVzZXJzWzBdO1xuICAgIGV4cGVjdChmaXJzdFVzZXIuYmxvY2tlZEF0KS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChuZXcgRGF0ZShmaXJzdFVzZXIuYmxvY2tlZEF0KSkudG9CZUluc3RhbmNlT2YoRGF0ZSk7XG4gIH0pO1xuXG4gIGl0KFwic2hvdWxkIHJldHVybiBzdGFibGUgZnVuY3Rpb24gcmVmZXJlbmNlc1wiLCAoKSA9PiB7XG4gICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlQmxvY2tlZFVzZXJzKCkpO1xuXG4gICAgYWN0KCgpID0+IHtcbiAgICAgIGplc3QuYWR2YW5jZVRpbWVyc0J5VGltZSgxMDAwKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGZpcnN0UmVmcmVzaERhdGEgPSByZXN1bHQuY3VycmVudC5yZWZyZXNoRGF0YTtcbiAgICBjb25zdCBmaXJzdEJsb2NrVXNlciA9IHJlc3VsdC5jdXJyZW50LmJsb2NrVXNlcjtcbiAgICBjb25zdCBmaXJzdFVuYmxvY2tVc2VyID0gcmVzdWx0LmN1cnJlbnQudW5ibG9ja1VzZXI7XG5cbiAgICAvLyBSZS1yZW5kZXIgdGhlIGhvb2sgKFJlYWN0IHdpbGwgcmUtcnVuIHRoZSBob29rIGJvZHkpXG4gICAgYWN0KCgpID0+IHtcbiAgICAgIC8vIFRyaWdnZXIgYSByZS1yZW5kZXIgYnkgY2hhbmdpbmcgc29tZSBzdGF0ZSBvciBqdXN0IHdhaXRcbiAgICAgIGplc3QuYWR2YW5jZVRpbWVyc0J5VGltZSgxMDApO1xuICAgIH0pO1xuXG4gICAgLy8gRnVuY3Rpb25zIHNob3VsZCBiZSBzdGFibGUgcmVmZXJlbmNlc1xuICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5yZWZyZXNoRGF0YSkudG9CZShmaXJzdFJlZnJlc2hEYXRhKTtcbiAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuYmxvY2tVc2VyKS50b0JlKGZpcnN0QmxvY2tVc2VyKTtcbiAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQudW5ibG9ja1VzZXIpLnRvQmUoZmlyc3RVbmJsb2NrVXNlcik7XG4gIH0pO1xufSk7XG4iXSwibWFwcGluZ3MiOiI7O0FBV0FBLFdBQUEsR0FBS0MsSUFBSSxDQUFDLG9CQUFvQixFQUFFO0VBQUEsT0FBTztJQUNyQ0MsTUFBTSxFQUFFO01BQ05DLElBQUksRUFBRUMsSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQztNQUNmQyxLQUFLLEVBQUVGLElBQUksQ0FBQ0MsRUFBRSxDQUFDO0lBQ2pCO0VBQ0YsQ0FBQztBQUFBLENBQUMsQ0FBQztBQUFDLElBQUFFLHNCQUFBLEdBQUFDLE9BQUE7QUFBQSxJQUFBQyxrQkFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBYkosSUFBQUUsWUFBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsYUFBQSxHQUFBSCxPQUFBO0FB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