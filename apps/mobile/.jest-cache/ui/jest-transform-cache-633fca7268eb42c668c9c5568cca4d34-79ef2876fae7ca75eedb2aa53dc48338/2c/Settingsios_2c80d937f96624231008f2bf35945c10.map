{"version":3,"names":["_RCTDeviceEventEmitter","_interopRequireDefault","require","_NativeSettingsManager","_invariant","subscriptions","Settings","_settings","NativeSettingsManager","getConstants","settings","get","key","set","Object","assign","setValues","watchKeys","keys","callback","invariant","Array","isArray","sid","length","push","clearWatch","watchId","_sendObservations","body","_this","forEach","newValue","didChange","sub","indexOf","RCTDeviceEventEmitter","addListener","bind","module","exports"],"sources":["Settings.ios.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * @flow\n */\n\nimport RCTDeviceEventEmitter from '../EventEmitter/RCTDeviceEventEmitter';\nimport NativeSettingsManager from './NativeSettingsManager';\nimport invariant from 'invariant';\n\nconst subscriptions: Array<{\n  keys: Array<string>,\n  callback: ?Function,\n  ...\n}> = [];\n\nconst Settings = {\n  _settings: (NativeSettingsManager &&\n    NativeSettingsManager.getConstants().settings: any),\n\n  get(key: string): mixed {\n    // $FlowFixMe[object-this-reference]\n    return this._settings[key];\n  },\n\n  set(settings: Object) {\n    // $FlowFixMe[object-this-reference]\n    this._settings = Object.assign(this._settings, settings);\n    NativeSettingsManager.setValues(settings);\n  },\n\n  watchKeys(keys: string | Array<string>, callback: Function): number {\n    if (typeof keys === 'string') {\n      keys = [keys];\n    }\n\n    invariant(\n      Array.isArray(keys),\n      'keys should be a string or array of strings',\n    );\n\n    const sid = subscriptions.length;\n    subscriptions.push({keys: keys, callback: callback});\n    return sid;\n  },\n\n  clearWatch(watchId: number) {\n    if (watchId < subscriptions.length) {\n      subscriptions[watchId] = {keys: [], callback: null};\n    }\n  },\n\n  _sendObservations(body: Object) {\n    Object.keys(body).forEach(key => {\n      const newValue = body[key];\n      // $FlowFixMe[object-this-reference]\n      const didChange = this._settings[key] !== newValue;\n      // $FlowFixMe[object-this-reference]\n      this._settings[key] = newValue;\n\n      if (didChange) {\n        subscriptions.forEach(sub => {\n          if (sub.keys.indexOf(key) !== -1 && sub.callback) {\n            sub.callback();\n          }\n        });\n      }\n    });\n  },\n};\n\nRCTDeviceEventEmitter.addListener(\n  'settingsUpdated',\n  Settings._sendObservations.bind(Settings),\n);\n\nmodule.exports = Settings;\n"],"mappings":";;;AAUA,IAAAA,sBAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,sBAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,UAAA,GAAAH,sBAAA,CAAAC,OAAA;AAEA,IAAMG,aAIJ,GAAG,EAAE;AAEP,IAAMC,QAAQ,GAAG;EACfC,SAAS,EAAGC,8BAAqB,IAC/BA,8BAAqB,CAACC,YAAY,CAAC,CAAC,CAACC,QAAc;EAErDC,GAAG,WAAHA,GAAGA,CAACC,GAAW,EAAS;IAEtB,OAAO,IAAI,CAACL,SAAS,CAACK,GAAG,CAAC;EAC5B,CAAC;EAEDC,GAAG,WAAHA,GAAGA,CAACH,QAAgB,EAAE;IAEpB,IAAI,CAACH,SAAS,GAAGO,MAAM,CAACC,MAAM,CAAC,IAAI,CAACR,SAAS,EAAEG,QAAQ,CAAC;IACxDF,8BAAqB,CAACQ,SAAS,CAACN,QAAQ,CAAC;EAC3C,CAAC;EAEDO,SAAS,WAATA,SAASA,CAACC,IAA4B,EAAEC,QAAkB,EAAU;IAClE,IAAI,OAAOD,IAAI,KAAK,QAAQ,EAAE;MAC5BA,IAAI,GAAG,CAACA,IAAI,CAAC;IACf;IAEA,IAAAE,kBAAS,EACPC,KAAK,CAACC,OAAO,CAACJ,IAAI,CAAC,EACnB,6CACF,CAAC;IAED,IAAMK,GAAG,GAAGlB,aAAa,CAACmB,MAAM;IAChCnB,aAAa,CAACoB,IAAI,CAAC;MAACP,IAAI,EAAEA,IAAI;MAAEC,QAAQ,EAAEA;IAAQ,CAAC,CAAC;IACpD,OAAOI,GAAG;EACZ,CAAC;EAEDG,UAAU,WAAVA,UAAUA,CAACC,OAAe,EAAE;IAC1B,IAAIA,OAAO,GAAGtB,aAAa,CAACmB,MAAM,EAAE;MAClCnB,aAAa,CAACsB,OAAO,CAAC,GAAG;QAACT,IAAI,EAAE,EAAE;QAAEC,QAAQ,EAAE;MAAI,CAAC;IACrD;EACF,CAAC;EAEDS,iBAAiB,WAAjBA,iBAAiBA,CAACC,IAAY,EAAE;IAAA,IAAAC,KAAA;IAC9BhB,MAAM,CAACI,IAAI,CAACW,IAAI,CAAC,CAACE,OAAO,CAAC,UAAAnB,GAAG,EAAI;MAC/B,IAAMoB,QAAQ,GAAGH,IAAI,CAACjB,GAAG,CAAC;MAE1B,IAAMqB,SAAS,GAAGH,KAAI,CAACvB,SAAS,CAACK,GAAG,CAAC,KAAKoB,QAAQ;MAElDF,KAAI,CAACvB,SAAS,CAACK,GAAG,CAAC,GAAGoB,QAAQ;MAE9B,IAAIC,SAAS,EAAE;QACb5B,aAAa,CAAC0B,OAAO,CAAC,UAAAG,GAAG,EAAI;UAC3B,IAAIA,GAAG,CAAChB,IAAI,CAACiB,OAAO,CAACvB,GAAG,CAAC,KAAK,CAAC,CAAC,IAAIsB,GAAG,CAACf,QAAQ,EAAE;YAChDe,GAAG,CAACf,QAAQ,CAAC,CAAC;UAChB;QACF,CAAC,CAAC;MACJ;IACF,CAAC,CAAC;EACJ;AACF,CAAC;AAEDiB,8BAAqB,CAACC,WAAW,CAC/B,iBAAiB,EACjB/B,QAAQ,CAACsB,iBAAiB,CAACU,IAAI,CAAChC,QAAQ,CAC1C,CAAC;AAEDiC,MAAM,CAACC,OAAO,GAAGlC,QAAQ","ignoreList":[]}