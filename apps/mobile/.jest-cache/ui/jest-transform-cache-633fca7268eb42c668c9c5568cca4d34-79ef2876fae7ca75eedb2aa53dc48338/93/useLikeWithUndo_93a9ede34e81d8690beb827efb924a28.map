{"version":3,"names":["_react","require","useLikeWithUndo","_ref","onLike","onUndo","cleanupRef","useRef","likeNow","cleanup","current","triggerUndoPill","win","window","__undoPillShow","undoNow","__undoPillHide"],"sources":["useLikeWithUndo.ts"],"sourcesContent":["import { useRef } from \"react\";\n\ninterface WindowWithUndo {\n  __undoPillShow?: () => void;\n  __undoPillHide?: () => void;\n}\n\n/**\n * Orchestrates optimistic like + undo.\n * - Calls onLike() immediately (may return a cleanup function).\n * - Exposes triggerUndoPill() which shows the UndoPill.\n * - If user taps Undo within the window, calls cleanup/onUndo.\n */\nexport function useLikeWithUndo({\n  onLike,\n  onUndo,\n}: {\n  onLike: () => void | (() => void);\n  onUndo?: () => void;\n}) {\n  const cleanupRef = useRef<null | (() => void)>(null);\n\n  const likeNow = () => {\n    const cleanup = onLike();\n    if (typeof cleanup === \"function\") cleanupRef.current = cleanup;\n  };\n\n  const triggerUndoPill = () => {\n    const win = window as unknown as WindowWithUndo;\n    if (typeof win.__undoPillShow === \"function\") win.__undoPillShow();\n  };\n\n  const undoNow = () => {\n    cleanupRef.current?.();\n    cleanupRef.current = null;\n    onUndo?.();\n    const win = window as unknown as WindowWithUndo;\n    if (typeof win.__undoPillHide === \"function\") win.__undoPillHide();\n  };\n\n  return { likeNow, triggerUndoPill, undoNow };\n}\n\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAaO,SAASC,eAAeA,CAAAC,IAAA,EAM5B;EAAA,IALDC,MAAM,GAAAD,IAAA,CAANC,MAAM;IACNC,MAAM,GAAAF,IAAA,CAANE,MAAM;EAKN,IAAMC,UAAU,GAAG,IAAAC,aAAM,EAAsB,IAAI,CAAC;EAEpD,IAAMC,OAAO,GAAG,SAAVA,OAAOA,CAAA,EAAS;IACpB,IAAMC,OAAO,GAAGL,MAAM,CAAC,CAAC;IACxB,IAAI,OAAOK,OAAO,KAAK,UAAU,EAAEH,UAAU,CAACI,OAAO,GAAGD,OAAO;EACjE,CAAC;EAED,IAAME,eAAe,GAAG,SAAlBA,eAAeA,CAAA,EAAS;IAC5B,IAAMC,GAAG,GAAGC,MAAmC;IAC/C,IAAI,OAAOD,GAAG,CAACE,cAAc,KAAK,UAAU,EAAEF,GAAG,CAACE,cAAc,CAAC,CAAC;EACpE,CAAC;EAED,IAAMC,OAAO,GAAG,SAAVA,OAAOA,CAAA,EAAS;IACpBT,UAAU,CAACI,OAAO,oBAAlBJ,UAAU,CAACI,OAAO,CAAG,CAAC;IACtBJ,UAAU,CAACI,OAAO,GAAG,IAAI;IACzBL,MAAM,oBAANA,MAAM,CAAG,CAAC;IACV,IAAMO,GAAG,GAAGC,MAAmC;IAC/C,IAAI,OAAOD,GAAG,CAACI,cAAc,KAAK,UAAU,EAAEJ,GAAG,CAACI,cAAc,CAAC,CAAC;EACpE,CAAC;EAED,OAAO;IAAER,OAAO,EAAPA,OAAO;IAAEG,eAAe,EAAfA,eAAe;IAAEI,OAAO,EAAPA;EAAQ,CAAC;AAC9C","ignoreList":[]}