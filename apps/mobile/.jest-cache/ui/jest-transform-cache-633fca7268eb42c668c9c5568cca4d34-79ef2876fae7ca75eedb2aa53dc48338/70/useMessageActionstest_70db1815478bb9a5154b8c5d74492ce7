ccfda94de6653d23d43b4d3be717d133
"use strict";

_getJestObj().mock("../../../services/api");
_getJestObj().mock('@pawfectmatch/core', function () {
  return {
    logger: {
      info: _globals.jest.fn(),
      error: _globals.jest.fn()
    }
  };
});
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _globals = require("@jest/globals");
var _reactNative = require("@testing-library/react-native");
var _useMessageActions = require("../useMessageActions");
var _api = require("../../../services/api");
var _core = require("@pawfectmatch/core");
function _getJestObj() {
  var _require = require("@jest/globals"),
    jest = _require.jest;
  _getJestObj = function _getJestObj() {
    return jest;
  };
  return jest;
}
var mockMatchesAPI = _api.matchesAPI;
var mockLogger = _core.logger;
(0, _globals.describe)('useMessageActions', function () {
  var matchId = 'test-match-123';
  (0, _globals.beforeEach)(function () {
    _globals.jest.clearAllMocks();
    mockMatchesAPI.sendMessage = _globals.jest.fn().mockResolvedValue(undefined);
    mockMatchesAPI.deleteMessage = _globals.jest.fn().mockResolvedValue(undefined);
  });
  var mockMessages = [{
    _id: 'msg-1',
    content: 'Hello',
    senderId: 'user-1',
    receiverId: 'user-2',
    createdAt: new Date().toISOString(),
    status: 'sent'
  }, {
    _id: 'msg-2',
    content: 'World',
    senderId: 'user-1',
    receiverId: 'user-2',
    createdAt: new Date().toISOString(),
    status: 'sent'
  }];
  (0, _globals.describe)('Initialization', function () {
    (0, _globals.it)('should initialize with retry and delete functions', function () {
      var _renderHook = (0, _reactNative.renderHook)(function () {
          return (0, _useMessageActions.useMessageActions)({
            matchId: matchId
          });
        }),
        result = _renderHook.result;
      (0, _globals.expect)(result.current.retryMessage).toBeDefined();
      (0, _globals.expect)(result.current.deleteMessage).toBeDefined();
    });
  });
  (0, _globals.describe)('Retry Message', function () {
    (0, _globals.it)('should retry an existing message', (0, _asyncToGenerator2.default)(function* () {
      var onMessageRetried = _globals.jest.fn();
      var _renderHook2 = (0, _reactNative.renderHook)(function () {
          return (0, _useMessageActions.useMessageActions)({
            matchId: matchId,
            onMessageRetried: onMessageRetried
          });
        }),
        result = _renderHook2.result;
      yield result.current.retryMessage('msg-1', mockMessages);
      (0, _globals.expect)(mockMatchesAPI.sendMessage).toHaveBeenCalledWith(matchId, 'Hello');
      (0, _globals.expect)(onMessageRetried).toHaveBeenCalledWith('msg-1');
      (0, _globals.expect)(mockLogger.info).toHaveBeenCalledWith('Message retried', {
        messageId: 'msg-1',
        matchId: matchId
      });
    }));
    (0, _globals.it)('should not retry non-existent message', (0, _asyncToGenerator2.default)(function* () {
      var _renderHook3 = (0, _reactNative.renderHook)(function () {
          return (0, _useMessageActions.useMessageActions)({
            matchId: matchId
          });
        }),
        result = _renderHook3.result;
      yield result.current.retryMessage('msg-999', mockMessages);
      (0, _globals.expect)(mockMatchesAPI.sendMessage).not.toHaveBeenCalled();
    }));
    (0, _globals.it)('should handle retry errors', (0, _asyncToGenerator2.default)(function* () {
      var error = new Error('Network error');
      mockMatchesAPI.sendMessage.mockRejectedValue(error);
      var _renderHook4 = (0, _reactNative.renderHook)(function () {
          return (0, _useMessageActions.useMessageActions)({
            matchId: matchId
          });
        }),
        result = _renderHook4.result;
      yield (0, _globals.expect)(result.current.retryMessage('msg-1', mockMessages)).rejects.toThrow(error);
      (0, _globals.expect)(mockLogger.error).toHaveBeenCalledWith('Failed to retry message', {
        error: error,
        messageId: 'msg-1'
      });
    }));
    (0, _globals.it)('should work without callback', (0, _asyncToGenerator2.default)(function* () {
      var _renderHook5 = (0, _reactNative.renderHook)(function () {
          return (0, _useMessageActions.useMessageActions)({
            matchId: matchId
          });
        }),
        result = _renderHook5.result;
      yield result.current.retryMessage('msg-2', mockMessages);
      (0, _globals.expect)(mockMatchesAPI.sendMessage).toHaveBeenCalledWith(matchId, 'World');
    }));
  });
  (0, _globals.describe)('Delete Message', function () {
    (0, _globals.it)('should delete a message', (0, _asyncToGenerator2.default)(function* () {
      var onMessageDeleted = _globals.jest.fn();
      var _renderHook6 = (0, _reactNative.renderHook)(function () {
          return (0, _useMessageActions.useMessageActions)({
            matchId: matchId,
            onMessageDeleted: onMessageDeleted
          });
        }),
        result = _renderHook6.result;
      yield result.current.deleteMessage('msg-1');
      (0, _globals.expect)(mockMatchesAPI.deleteMessage).toHaveBeenCalledWith(matchId, 'msg-1');
      (0, _globals.expect)(onMessageDeleted).toHaveBeenCalledWith('msg-1');
      (0, _globals.expect)(mockLogger.info).toHaveBeenCalledWith('Message deleted', {
        messageId: 'msg-1',
        matchId: matchId
      });
    }));
    (0, _globals.it)('should handle delete errors', (0, _asyncToGenerator2.default)(function* () {
      var error = new Error('Network error');
      mockMatchesAPI.deleteMessage.mockRejectedValue(error);
      var _renderHook7 = (0, _reactNative.renderHook)(function () {
          return (0, _useMessageActions.useMessageActions)({
            matchId: matchId
          });
        }),
        result = _renderHook7.result;
      yield (0, _globals.expect)(result.current.deleteMessage('msg-1')).rejects.toThrow(error);
      (0, _globals.expect)(mockLogger.error).toHaveBeenCalledWith('Failed to delete message', {
        error: error,
        messageId: 'msg-1'
      });
    }));
    (0, _globals.it)('should work without callback', (0, _asyncToGenerator2.default)(function* () {
      var _renderHook8 = (0, _reactNative.renderHook)(function () {
          return (0, _useMessageActions.useMessageActions)({
            matchId: matchId
          });
        }),
        result = _renderHook8.result;
      yield result.current.deleteMessage('msg-2');
      (0, _globals.expect)(mockMatchesAPI.deleteMessage).toHaveBeenCalledWith(matchId, 'msg-2');
    }));
  });
  (0, _globals.describe)('Integration', function () {
    (0, _globals.it)('should retry then delete message', (0, _asyncToGenerator2.default)(function* () {
      var _renderHook9 = (0, _reactNative.renderHook)(function () {
          return (0, _useMessageActions.useMessageActions)({
            matchId: matchId
          });
        }),
        result = _renderHook9.result;
      yield result.current.retryMessage('msg-1', mockMessages);
      yield result.current.deleteMessage('msg-1');
      (0, _globals.expect)(mockMatchesAPI.sendMessage).toHaveBeenCalledWith(matchId, 'Hello');
      (0, _globals.expect)(mockMatchesAPI.deleteMessage).toHaveBeenCalledWith(matchId, 'msg-1');
    }));
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJsb2dnZXIiLCJpbmZvIiwiamVzdCIsImZuIiwiZXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9hc3luY1RvR2VuZXJhdG9yMiIsIl9nbG9iYWxzIiwiX3JlYWN0TmF0aXZlIiwiX3VzZU1lc3NhZ2VBY3Rpb25zIiwiX2FwaSIsIl9jb3JlIiwiX3JlcXVpcmUiLCJtb2NrTWF0Y2hlc0FQSSIsIm1hdGNoZXNBUEkiLCJtb2NrTG9nZ2VyIiwiZGVzY3JpYmUiLCJtYXRjaElkIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJzZW5kTWVzc2FnZSIsIm1vY2tSZXNvbHZlZFZhbHVlIiwidW5kZWZpbmVkIiwiZGVsZXRlTWVzc2FnZSIsIm1vY2tNZXNzYWdlcyIsIl9pZCIsImNvbnRlbnQiLCJzZW5kZXJJZCIsInJlY2VpdmVySWQiLCJjcmVhdGVkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzdGF0dXMiLCJpdCIsIl9yZW5kZXJIb29rIiwicmVuZGVySG9vayIsInVzZU1lc3NhZ2VBY3Rpb25zIiwicmVzdWx0IiwiZXhwZWN0IiwiY3VycmVudCIsInJldHJ5TWVzc2FnZSIsInRvQmVEZWZpbmVkIiwiZGVmYXVsdCIsIm9uTWVzc2FnZVJldHJpZWQiLCJfcmVuZGVySG9vazIiLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsIm1lc3NhZ2VJZCIsIl9yZW5kZXJIb29rMyIsIm5vdCIsInRvSGF2ZUJlZW5DYWxsZWQiLCJFcnJvciIsIm1vY2tSZWplY3RlZFZhbHVlIiwiX3JlbmRlckhvb2s0IiwicmVqZWN0cyIsInRvVGhyb3ciLCJfcmVuZGVySG9vazUiLCJvbk1lc3NhZ2VEZWxldGVkIiwiX3JlbmRlckhvb2s2IiwiX3JlbmRlckhvb2s3IiwiX3JlbmRlckhvb2s4IiwiX3JlbmRlckhvb2s5Il0sInNvdXJjZXMiOlsidXNlTWVzc2FnZUFjdGlvbnMudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRlc3RzIGZvciB1c2VNZXNzYWdlQWN0aW9ucyBob29rXG4gKiBUZXN0cyBtZXNzYWdlIHJldHJ5IGFuZCBkZWxldGUgZnVuY3Rpb25hbGl0eVxuICovXG5cbmltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0LCBqZXN0LCBiZWZvcmVFYWNoIH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQgeyByZW5kZXJIb29rIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdC1uYXRpdmUnO1xuaW1wb3J0IHsgdXNlTWVzc2FnZUFjdGlvbnMgfSBmcm9tICcuLi91c2VNZXNzYWdlQWN0aW9ucyc7XG5pbXBvcnQgeyBtYXRjaGVzQVBJIH0gZnJvbSAnLi4vLi4vLi4vc2VydmljZXMvYXBpJztcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0BwYXdmZWN0bWF0Y2gvY29yZSc7XG5pbXBvcnQgdHlwZSB7IE1lc3NhZ2UgfSBmcm9tICcuLi8uLi91c2VDaGF0RGF0YSc7XG5cbi8vIE1vY2sgZGVwZW5kZW5jaWVzXG5qZXN0Lm1vY2soJy4uLy4uLy4uL3NlcnZpY2VzL2FwaScpO1xuamVzdC5tb2NrKCdAcGF3ZmVjdG1hdGNoL2NvcmUnLCAoKSA9PiAoe1xuICBsb2dnZXI6IHtcbiAgICBpbmZvOiBqZXN0LmZuKCksXG4gICAgZXJyb3I6IGplc3QuZm4oKSxcbiAgfSxcbn0pKTtcblxuY29uc3QgbW9ja01hdGNoZXNBUEkgPSBtYXRjaGVzQVBJIGFzIGplc3QuTW9ja2VkPHR5cGVvZiBtYXRjaGVzQVBJPjtcbmNvbnN0IG1vY2tMb2dnZXIgPSBsb2dnZXIgYXMgamVzdC5Nb2NrZWQ8dHlwZW9mIGxvZ2dlcj47XG5cbmRlc2NyaWJlKCd1c2VNZXNzYWdlQWN0aW9ucycsICgpID0+IHtcbiAgY29uc3QgbWF0Y2hJZCA9ICd0ZXN0LW1hdGNoLTEyMyc7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgbW9ja01hdGNoZXNBUEkuc2VuZE1lc3NhZ2UgPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcbiAgICBtb2NrTWF0Y2hlc0FQSS5kZWxldGVNZXNzYWdlID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG4gIH0pO1xuXG4gIGNvbnN0IG1vY2tNZXNzYWdlczogTWVzc2FnZVtdID0gW1xuICAgIHtcbiAgICAgIF9pZDogJ21zZy0xJyxcbiAgICAgIGNvbnRlbnQ6ICdIZWxsbycsXG4gICAgICBzZW5kZXJJZDogJ3VzZXItMScsXG4gICAgICByZWNlaXZlcklkOiAndXNlci0yJyxcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgc3RhdHVzOiAnc2VudCcsXG4gICAgfSxcbiAgICB7XG4gICAgICBfaWQ6ICdtc2ctMicsXG4gICAgICBjb250ZW50OiAnV29ybGQnLFxuICAgICAgc2VuZGVySWQ6ICd1c2VyLTEnLFxuICAgICAgcmVjZWl2ZXJJZDogJ3VzZXItMicsXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIHN0YXR1czogJ3NlbnQnLFxuICAgIH0sXG4gIF07XG5cbiAgZGVzY3JpYmUoJ0luaXRpYWxpemF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSB3aXRoIHJldHJ5IGFuZCBkZWxldGUgZnVuY3Rpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT5cbiAgICAgICAgdXNlTWVzc2FnZUFjdGlvbnMoeyBtYXRjaElkIH0pLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnJldHJ5TWVzc2FnZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5kZWxldGVNZXNzYWdlKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUmV0cnkgTWVzc2FnZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHJ5IGFuIGV4aXN0aW5nIG1lc3NhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBvbk1lc3NhZ2VSZXRyaWVkID0gamVzdC5mbigpO1xuICAgICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT5cbiAgICAgICAgdXNlTWVzc2FnZUFjdGlvbnMoeyBtYXRjaElkLCBvbk1lc3NhZ2VSZXRyaWVkIH0pLFxuICAgICAgKTtcblxuICAgICAgYXdhaXQgcmVzdWx0LmN1cnJlbnQucmV0cnlNZXNzYWdlKCdtc2ctMScsIG1vY2tNZXNzYWdlcyk7XG5cbiAgICAgIGV4cGVjdChtb2NrTWF0Y2hlc0FQSS5zZW5kTWVzc2FnZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIG1hdGNoSWQsXG4gICAgICAgICdIZWxsbycsXG4gICAgICApO1xuICAgICAgZXhwZWN0KG9uTWVzc2FnZVJldHJpZWQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdtc2ctMScpO1xuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuaW5mbykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ01lc3NhZ2UgcmV0cmllZCcsIHtcbiAgICAgICAgbWVzc2FnZUlkOiAnbXNnLTEnLFxuICAgICAgICBtYXRjaElkLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCByZXRyeSBub24tZXhpc3RlbnQgbWVzc2FnZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+XG4gICAgICAgIHVzZU1lc3NhZ2VBY3Rpb25zKHsgbWF0Y2hJZCB9KSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHJlc3VsdC5jdXJyZW50LnJldHJ5TWVzc2FnZSgnbXNnLTk5OScsIG1vY2tNZXNzYWdlcyk7XG5cbiAgICAgIGV4cGVjdChtb2NrTWF0Y2hlc0FQSS5zZW5kTWVzc2FnZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHJldHJ5IGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdOZXR3b3JrIGVycm9yJyk7XG4gICAgICBtb2NrTWF0Y2hlc0FQSS5zZW5kTWVzc2FnZS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+XG4gICAgICAgIHVzZU1lc3NhZ2VBY3Rpb25zKHsgbWF0Y2hJZCB9KSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgcmVzdWx0LmN1cnJlbnQucmV0cnlNZXNzYWdlKCdtc2ctMScsIG1vY2tNZXNzYWdlcyksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhlcnJvcik7XG5cbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnRmFpbGVkIHRvIHJldHJ5IG1lc3NhZ2UnLCB7XG4gICAgICAgIGVycm9yLFxuICAgICAgICBtZXNzYWdlSWQ6ICdtc2ctMScsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgd29yayB3aXRob3V0IGNhbGxiYWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT5cbiAgICAgICAgdXNlTWVzc2FnZUFjdGlvbnMoeyBtYXRjaElkIH0pLFxuICAgICAgKTtcblxuICAgICAgYXdhaXQgcmVzdWx0LmN1cnJlbnQucmV0cnlNZXNzYWdlKCdtc2ctMicsIG1vY2tNZXNzYWdlcyk7XG5cbiAgICAgIGV4cGVjdChtb2NrTWF0Y2hlc0FQSS5zZW5kTWVzc2FnZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIG1hdGNoSWQsXG4gICAgICAgICdXb3JsZCcsXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRGVsZXRlIE1lc3NhZ2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBkZWxldGUgYSBtZXNzYWdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgb25NZXNzYWdlRGVsZXRlZCA9IGplc3QuZm4oKTtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+XG4gICAgICAgIHVzZU1lc3NhZ2VBY3Rpb25zKHsgbWF0Y2hJZCwgb25NZXNzYWdlRGVsZXRlZCB9KSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHJlc3VsdC5jdXJyZW50LmRlbGV0ZU1lc3NhZ2UoJ21zZy0xJyk7XG5cbiAgICAgIGV4cGVjdChtb2NrTWF0Y2hlc0FQSS5kZWxldGVNZXNzYWdlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgbWF0Y2hJZCxcbiAgICAgICAgJ21zZy0xJyxcbiAgICAgICk7XG4gICAgICBleHBlY3Qob25NZXNzYWdlRGVsZXRlZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ21zZy0xJyk7XG4gICAgICBleHBlY3QobW9ja0xvZ2dlci5pbmZvKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnTWVzc2FnZSBkZWxldGVkJywge1xuICAgICAgICBtZXNzYWdlSWQ6ICdtc2ctMScsXG4gICAgICAgIG1hdGNoSWQsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRlbGV0ZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignTmV0d29yayBlcnJvcicpO1xuICAgICAgbW9ja01hdGNoZXNBUEkuZGVsZXRlTWVzc2FnZS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+XG4gICAgICAgIHVzZU1lc3NhZ2VBY3Rpb25zKHsgbWF0Y2hJZCB9KSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChyZXN1bHQuY3VycmVudC5kZWxldGVNZXNzYWdlKCdtc2ctMScpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIGVycm9yLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnRmFpbGVkIHRvIGRlbGV0ZSBtZXNzYWdlJyxcbiAgICAgICAge1xuICAgICAgICAgIGVycm9yLFxuICAgICAgICAgIG1lc3NhZ2VJZDogJ21zZy0xJyxcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHdvcmsgd2l0aG91dCBjYWxsYmFjaycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+XG4gICAgICAgIHVzZU1lc3NhZ2VBY3Rpb25zKHsgbWF0Y2hJZCB9KSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHJlc3VsdC5jdXJyZW50LmRlbGV0ZU1lc3NhZ2UoJ21zZy0yJyk7XG5cbiAgICAgIGV4cGVjdChtb2NrTWF0Y2hlc0FQSS5kZWxldGVNZXNzYWdlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgbWF0Y2hJZCxcbiAgICAgICAgJ21zZy0yJyxcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHJ5IHRoZW4gZGVsZXRlIG1lc3NhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PlxuICAgICAgICB1c2VNZXNzYWdlQWN0aW9ucyh7IG1hdGNoSWQgfSksXG4gICAgICApO1xuXG4gICAgICBhd2FpdCByZXN1bHQuY3VycmVudC5yZXRyeU1lc3NhZ2UoJ21zZy0xJywgbW9ja01lc3NhZ2VzKTtcblxuICAgICAgYXdhaXQgcmVzdWx0LmN1cnJlbnQuZGVsZXRlTWVzc2FnZSgnbXNnLTEnKTtcblxuICAgICAgZXhwZWN0KG1vY2tNYXRjaGVzQVBJLnNlbmRNZXNzYWdlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgbWF0Y2hJZCxcbiAgICAgICAgJ0hlbGxvJyxcbiAgICAgICk7XG4gICAgICBleHBlY3QobW9ja01hdGNoZXNBUEkuZGVsZXRlTWVzc2FnZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIG1hdGNoSWQsXG4gICAgICAgICdtc2ctMScsXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG4iXSwibWFwcGluZ3MiOiI7O0FBYUFBLFdBQUEsR0FBS0MsSUFBSSx3QkFBd0IsQ0FBQztBQUNsQ0QsV0FBQSxHQUFLQyxJQUFJLENBQUMsb0JBQW9CLEVBQUU7RUFBQSxPQUFPO0lBQ3JDQyxNQUFNLEVBQUU7TUFDTkMsSUFBSSxFQUFFQyxhQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDO01BQ2ZDLEtBQUssRUFBRUYsYUFBSSxDQUFDQyxFQUFFLENBQUM7SUFDakI7RUFDRixDQUFDO0FBQUEsQ0FBQyxDQUFDO0FBQUMsSUFBQUUsc0JBQUEsR0FBQUMsT0FBQTtBQUFBLElBQUFDLGtCQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFkSixJQUFBRSxRQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxZQUFBLEdBQUFILE9BQUE7QUFDQSxJQUFBSSxrQkFBQSxHQUFBSixPQUFBO0FBQ0EsSUFBQUssSUFBQSxHQUFBTCxPQUFBO0FBQ0EsSUFBQU0sS0FBQSxHQUFBTixPQUFBO0FBQTRDLFNBQUFSLFlBQUE7RUFBQSxJQUFBZSxRQUFBLEdBQUFQLE9BQUE7SUFBQUosSUFBQSxHQUFBVyxRQUFBLENBQUFYLElBQUE7RUFBQUosV0FBQSxZQUFBQSxZQUFBO0lBQUEsT0FBQUksSUFBQTtFQUFBO0VBQUEsT0FBQUEsSUFBQTtBQUFBO0FBWTVDLElBQU1ZLGNBQWMsR0FBR0MsZUFBNEM7QUFDbkUsSUFBTUMsVUFBVSxHQUFHaEIsWUFBb0M7QUFFdkQsSUFBQWlCLGlC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