7ed7901de269c0a25effe0f990dd8191
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var Blob = function () {
  function Blob() {
    var parts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
    var options = arguments.length > 1 ? arguments[1] : undefined;
    (0, _classCallCheck2.default)(this, Blob);
    var BlobManager = require("./BlobManager");
    this.data = BlobManager.createFromParts(parts, options).data;
  }
  return (0, _createClass2.default)(Blob, [{
    key: "data",
    get: function get() {
      if (!this._data) {
        throw new Error('Blob has been closed and is no longer available');
      }
      return this._data;
    },
    set: function set(data) {
      this._data = data;
    }
  }, {
    key: "slice",
    value: function slice(start, end) {
      var BlobManager = require("./BlobManager");
      var _this$data = this.data,
        offset = _this$data.offset,
        size = _this$data.size;
      if (typeof start === 'number') {
        if (start > size) {
          start = size;
        }
        offset += start;
        size -= start;
        if (typeof end === 'number') {
          if (end < 0) {
            end = this.size + end;
          }
          if (end > this.size) {
            end = this.size;
          }
          size = end - start;
        }
      }
      return BlobManager.createFromOptions({
        blobId: this.data.blobId,
        offset: offset,
        size: size,
        __collector: this.data.__collector
      });
    }
  }, {
    key: "close",
    value: function close() {
      var BlobManager = require("./BlobManager");
      BlobManager.release(this.data.blobId);
      this.data = null;
    }
  }, {
    key: "size",
    get: function get() {
      return this.data.size;
    }
  }, {
    key: "type",
    get: function get() {
      return this.data.type || '';
    }
  }]);
}();
module.exports = Blob;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9jbGFzc0NhbGxDaGVjazIiLCJfY3JlYXRlQ2xhc3MyIiwiQmxvYiIsInBhcnRzIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwib3B0aW9ucyIsImRlZmF1bHQiLCJCbG9iTWFuYWdlciIsImRhdGEiLCJjcmVhdGVGcm9tUGFydHMiLCJrZXkiLCJnZXQiLCJfZGF0YSIsIkVycm9yIiwic2V0IiwidmFsdWUiLCJzbGljZSIsInN0YXJ0IiwiZW5kIiwiX3RoaXMkZGF0YSIsIm9mZnNldCIsInNpemUiLCJjcmVhdGVGcm9tT3B0aW9ucyIsImJsb2JJZCIsIl9fY29sbGVjdG9yIiwiY2xvc2UiLCJyZWxlYXNlIiwidHlwZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJCbG9iLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBNZXRhIFBsYXRmb3JtcywgSW5jLiBhbmQgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvdyBzdHJpY3QtbG9jYWxcbiAqIEBmb3JtYXRcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCB0eXBlIHtCbG9iRGF0YSwgQmxvYk9wdGlvbnN9IGZyb20gJy4vQmxvYlR5cGVzJztcblxuLyoqXG4gKiBPcGFxdWUgSlMgcmVwcmVzZW50YXRpb24gb2Ygc29tZSBiaW5hcnkgZGF0YSBpbiBuYXRpdmUuXG4gKlxuICogVGhlIEFQSSBpcyBtb2RlbGVkIGFmdGVyIHRoZSBXM0MgQmxvYiBBUEksIHdpdGggb25lIGNhdmVhdFxuICogcmVnYXJkaW5nIGV4cGxpY2l0IGRlYWxsb2NhdGlvbi4gUmVmZXIgdG8gdGhlIGBjbG9zZSgpYFxuICogbWV0aG9kIGZvciBmdXJ0aGVyIGRldGFpbHMuXG4gKlxuICogRXhhbXBsZSB1c2FnZSBpbiBhIFJlYWN0IGNvbXBvbmVudDpcbiAqXG4gKiAgIGNsYXNzIFdlYlNvY2tldEltYWdlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAqICAgICAgc3RhdGUgPSB7YmxvYjogbnVsbH07XG4gKiAgICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICogICAgICAgIGxldCB3cyA9IHRoaXMud3MgPSBuZXcgV2ViU29ja2V0KC4uLik7XG4gKiAgICAgICAgd3MuYmluYXJ5VHlwZSA9ICdibG9iJztcbiAqICAgICAgICB3cy5vbm1lc3NhZ2UgPSAoZXZlbnQpID0+IHtcbiAqICAgICAgICAgIGlmICh0aGlzLnN0YXRlLmJsb2IpIHtcbiAqICAgICAgICAgICAgdGhpcy5zdGF0ZS5ibG9iLmNsb3NlKCk7XG4gKiAgICAgICAgICB9XG4gKiAgICAgICAgICB0aGlzLnNldFN0YXRlKHtibG9iOiBldmVudC5kYXRhfSk7XG4gKiAgICAgICAgfTtcbiAqICAgICAgfVxuICogICAgICBjb21wb25lbnRVbm1vdW50KCkge1xuICogICAgICAgIGlmICh0aGlzLnN0YXRlLmJsb2IpIHtcbiAqICAgICAgICAgIHRoaXMuc3RhdGUuYmxvYi5jbG9zZSgpO1xuICogICAgICAgIH1cbiAqICAgICAgICB0aGlzLndzLmNsb3NlKCk7XG4gKiAgICAgIH1cbiAqICAgICAgcmVuZGVyKCkge1xuICogICAgICAgIGlmICghdGhpcy5zdGF0ZS5ibG9iKSB7XG4gKiAgICAgICAgICByZXR1cm4gPFZpZXcgLz47XG4gKiAgICAgICAgfVxuICogICAgICAgIHJldHVybiA8SW1hZ2Ugc291cmNlPXt7dXJpOiBVUkwuY3JlYXRlT2JqZWN0VVJMKHRoaXMuc3RhdGUuYmxvYil9fSAvPjtcbiAqICAgICAgfVxuICogICB9XG4gKlxuICogUmVmZXJlbmNlOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQmxvYlxuICovXG5jbGFzcyBCbG9iIHtcbiAgX2RhdGE6ID9CbG9iRGF0YTtcblxuICAvKipcbiAgICogQ29uc3RydWN0b3IgZm9yIEpTIGNvbnN1bWVycy5cbiAgICogQ3VycmVudGx5IHdlIG9ubHkgc3VwcG9ydCBjcmVhdGluZyBCbG9icyBmcm9tIG90aGVyIEJsb2JzLlxuICAgKiBSZWZlcmVuY2U6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9CbG9iL0Jsb2JcbiAgICovXG4gIGNvbnN0cnVjdG9yKHBhcnRzOiBBcnJheTxCbG9iIHwgc3RyaW5nPiA9IFtdLCBvcHRpb25zPzogQmxvYk9wdGlvbnMpIHtcbiAgICBjb25zdCBCbG9iTWFuYWdlciA9IHJlcXVpcmUoJy4vQmxvYk1hbmFnZXInKTtcbiAgICB0aGlzLmRhdGEgPSBCbG9iTWFuYWdlci5jcmVhdGVGcm9tUGFydHMocGFydHMsIG9wdGlvbnMpLmRhdGE7XG4gIH1cblxuICAvKlxuICAgKiBUaGlzIG1ldGhvZCBpcyB1c2VkIHRvIGNyZWF0ZSBhIG5ldyBCbG9iIG9iamVjdCBjb250YWluaW5nXG4gICAqIHRoZSBkYXRhIGluIHRoZSBzcGVjaWZpZWQgcmFuZ2Ugb2YgYnl0ZXMgb2YgdGhlIHNvdXJjZSBCbG9iLlxuICAgKiBSZWZlcmVuY2U6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9CbG9iL3NsaWNlXG4gICAqL1xuICAvLyAkRmxvd0ZpeE1lW3Vuc2FmZS1nZXR0ZXJzLXNldHRlcnNdXG4gIHNldCBkYXRhKGRhdGE6ID9CbG9iRGF0YSkge1xuICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xuICB9XG5cbiAgLy8gJEZsb3dGaXhNZVt1bnNhZmUtZ2V0dGVycy1zZXR0ZXJzXVxuICBnZXQgZGF0YSgpOiBCbG9iRGF0YSB7XG4gICAgaWYgKCF0aGlzLl9kYXRhKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Jsb2IgaGFzIGJlZW4gY2xvc2VkIGFuZCBpcyBubyBsb25nZXIgYXZhaWxhYmxlJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX2RhdGE7XG4gIH1cblxuICBzbGljZShzdGFydD86IG51bWJlciwgZW5kPzogbnVtYmVyKTogQmxvYiB7XG4gICAgY29uc3QgQmxvYk1hbmFnZXIgPSByZXF1aXJlKCcuL0Jsb2JNYW5hZ2VyJyk7XG4gICAgbGV0IHtvZmZzZXQsIHNpemV9ID0gdGhpcy5kYXRhO1xuXG4gICAgaWYgKHR5cGVvZiBzdGFydCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGlmIChzdGFydCA+IHNpemUpIHtcbiAgICAgICAgLy8gJEZsb3dGaXhNZVtyZWFzc2lnbi1jb25zdF1cbiAgICAgICAgc3RhcnQgPSBzaXplO1xuICAgICAgfVxuICAgICAgb2Zmc2V0ICs9IHN0YXJ0O1xuICAgICAgc2l6ZSAtPSBzdGFydDtcblxuICAgICAgaWYgKHR5cGVvZiBlbmQgPT09ICdudW1iZXInKSB7XG4gICAgICAgIGlmIChlbmQgPCAwKSB7XG4gICAgICAgICAgLy8gJEZsb3dGaXhNZVtyZWFzc2lnbi1jb25zdF1cbiAgICAgICAgICBlbmQgPSB0aGlzLnNpemUgKyBlbmQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVuZCA+IHRoaXMuc2l6ZSkge1xuICAgICAgICAgIC8vICRGbG93Rml4TWVbcmVhc3NpZ24tY29uc3RdXG4gICAgICAgICAgZW5kID0gdGhpcy5zaXplO1xuICAgICAgICB9XG4gICAgICAgIHNpemUgPSBlbmQgLSBzdGFydDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIEJsb2JNYW5hZ2VyLmNyZWF0ZUZyb21PcHRpb25zKHtcbiAgICAgIGJsb2JJZDogdGhpcy5kYXRhLmJsb2JJZCxcbiAgICAgIG9mZnNldCxcbiAgICAgIHNpemUsXG4gICAgICAvKiBTaW5jZSBgYmxvYi5zbGljZSgpYCBjcmVhdGVzIGEgbmV3IHZpZXcgb250byB0aGUgc2FtZSBiaW5hcnlcbiAgICAgICAqIGRhdGEgYXMgdGhlIG9yaWdpbmFsIGJsb2IsIHdlIHNob3VsZCByZS11c2UgdGhlIHNhbWUgY29sbGVjdG9yXG4gICAgICAgKiBvYmplY3Qgc28gdGhhdCB0aGUgdW5kZXJseWluZyByZXNvdXJjZSBnZXRzIGRlYWxsb2NhdGVkIHdoZW5cbiAgICAgICAqIHRoZSBsYXN0IHZpZXcgaW50byB0aGUgZGF0YSBpcyByZWxlYXNlZCwgbm90IHRoZSBmaXJzdC5cbiAgICAgICAqL1xuICAgICAgX19jb2xsZWN0b3I6IHRoaXMuZGF0YS5fX2NvbGxlY3RvcixcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIG1ldGhvZCBpcyBpbiB0aGUgc3RhbmRhcmQsIGJ1dCBub3QgYWN0dWFsbHkgaW1wbGVtZW50ZWQgYnlcbiAgICogYW55IGJyb3dzZXJzIGF0IHRoaXMgcG9pbnQuIEl0J3MgaW1wb3J0YW50IGZvciBob3cgQmxvYnMgd29yayBpblxuICAgKiBSZWFjdCBOYXRpdmUsIGhvd2V2ZXIsIHNpbmNlIHdlIGNhbm5vdCBkZS1hbGxvY2F0ZSByZXNvdXJjZXMgYXV0b21hdGljYWxseSxcbiAgICogc28gY29uc3VtZXJzIG5lZWQgdG8gZXhwbGljaXRseSBkZS1hbGxvY2F0ZSB0aGVtLlxuICAgKlxuICAgKiBOb3RlIHRoYXQgdGhlIHNlbWFudGljcyBhcm91bmQgQmxvYnMgY3JlYXRlZCB2aWEgYGJsb2Iuc2xpY2UoKWBcbiAgICogYW5kIGBuZXcgQmxvYihbYmxvYl0pYCBhcmUgZGlmZmVyZW50LiBgYmxvYi5zbGljZSgpYCBjcmVhdGVzIGFcbiAgICogbmV3ICp2aWV3KiBvbnRvIHRoZSBzYW1lIGJpbmFyeSBkYXRhLCBzbyBjYWxsaW5nIGBjbG9zZSgpYCBvbiBhbnlcbiAgICogb2YgdGhvc2Ugdmlld3MgaXMgZW5vdWdoIHRvIGRlYWxsb2NhdGUgdGhlIGRhdGEsIHdoZXJlYXNcbiAgICogYG5ldyBCbG9iKFtibG9iLCAuLi5dKWAgYWN0dWFsbHkgY29waWVzIHRoZSBkYXRhIGluIG1lbW9yeS5cbiAgICovXG4gIGNsb3NlKCkge1xuICAgIGNvbnN0IEJsb2JNYW5hZ2VyID0gcmVxdWlyZSgnLi9CbG9iTWFuYWdlcicpO1xuICAgIEJsb2JNYW5hZ2VyLnJlbGVhc2UodGhpcy5kYXRhLmJsb2JJZCk7XG4gICAgdGhpcy5kYXRhID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBTaXplIG9mIHRoZSBkYXRhIGNvbnRhaW5lZCBpbiB0aGUgQmxvYiBvYmplY3QsIGluIGJ5dGVzLlxuICAgKi9cbiAgLy8gJEZsb3dGaXhNZVt1bnNhZmUtZ2V0dGVycy1zZXR0ZXJzXVxuICBnZXQgc2l6ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmRhdGEuc2l6ZTtcbiAgfVxuXG4gIC8qXG4gICAqIFN0cmluZyBpbmRpY2F0aW5nIHRoZSBNSU1FIHR5cGUgb2YgdGhlIGRhdGEgY29udGFpbmVkIGluIHRoZSBCbG9iLlxuICAgKiBJZiB0aGUgdHlwZSBpcyB1bmtub3duLCB0aGlzIHN0cmluZyBpcyBlbXB0eS5cbiAgICovXG4gIC8vICRGbG93Rml4TWVbdW5zYWZlLWdldHRlcnMtc2V0dGVyc11cbiAgZ2V0IHR5cGUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhLnR5cGUgfHwgJyc7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBCbG9iO1xuIl0sIm1hcHBpbmdzIjoiQUFVQSxZQUFZOztBQUFDLElBQUFBLHNCQUFBLEdBQUFDLE9BQUE7QUFBQSxJQUFBQyxnQkFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQUEsSUFBQUUsYUFBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQUEsSUF5Q1BHLElBQUk7RUFRUixTQUFBQSxLQUFBLEVBQXFFO0lBQUEsSUFBekRDLEtBQTJCLEdBQUFDLFNBQUEsQ0FBQUMsTUFBQSxRQUFBRCxTQUFBLFFBQUFFLFNBQUEsR0FBQUYsU0FBQSxNQUFHLEVBQUU7SUFBQSxJQUFFRyxPQUFxQixHQUFBSCxTQUFBLENBQUFDLE1BQUEs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