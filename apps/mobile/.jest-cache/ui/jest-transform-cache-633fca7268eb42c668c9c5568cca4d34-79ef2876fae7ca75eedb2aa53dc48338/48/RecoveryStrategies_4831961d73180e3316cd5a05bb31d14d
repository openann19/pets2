f39efe705ecf7e803fba3bb735e7d281
"use strict";
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.RecoveryStrategies = void 0;
var logger_1 = require("../utils/logger");
var RecoveryStrategies = function () {
  function RecoveryStrategies() {
    (0, _classCallCheck2.default)(this, RecoveryStrategies);
  }
  return (0, _createClass2.default)(RecoveryStrategies, [{
    key: "autoRetry",
    value: (function () {
      var _autoRetry = (0, _asyncToGenerator2.default)(function* (fn) {
        var _options$maxRetries, _options$retryDelay;
        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        var maxRetries = (_options$maxRetries = options.maxRetries) != null ? _options$maxRetries : 3;
        var retryDelay = (_options$retryDelay = options.retryDelay) != null ? _options$retryDelay : 1000;
        var lastError;
        for (var attempt = 0; attempt <= maxRetries; attempt++) {
          try {
            if (attempt > 0 && options.onRetry) {
              options.onRetry(attempt);
            }
            var result = yield fn();
            return {
              success: true,
              data: result,
              retriesPerformed: attempt
            };
          } catch (error) {
            lastError = error;
            if (attempt < maxRetries) {
              var delay = retryDelay * Math.pow(2, attempt);
              logger_1.logger.debug('Retrying after delay', {
                attempt: attempt,
                delay: delay
              });
              yield this.sleep(delay);
            }
          }
        }
        if (options.onFailure) {
          options.onFailure(lastError);
        }
        return {
          success: false,
          error: lastError,
          retriesPerformed: maxRetries
        };
      });
      function autoRetry(_x) {
        return _autoRetry.apply(this, arguments);
      }
      return autoRetry;
    }())
  }, {
    key: "retryWithTokenRefresh",
    value: (function () {
      var _retryWithTokenRefresh = (0, _asyncToGenerator2.default)(function* (fn, refreshTokenFn) {
        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        try {
          var result = yield fn();
          return {
            success: true,
            data: result
          };
        } catch (error) {
          if (this.isAuthenticationError(error)) {
            logger_1.logger.info('Authentication error, refreshing token');
            try {
              yield refreshTokenFn();
              logger_1.logger.info('Token refreshed, retrying request');
              var retryResult = yield this.autoRetry(fn, options);
              return retryResult;
            } catch (refreshError) {
              logger_1.logger.error('Token refresh failed', {
                error: refreshError
              });
              return {
                success: false,
                error: refreshError
              };
            }
          }
          return {
            success: false,
            error: error
          };
        }
      });
      function retryWithTokenRefresh(_x2, _x3) {
        return _retryWithTokenRefresh.apply(this, arguments);
      }
      return retryWithTokenRefresh;
    }())
  }, {
    key: "fallbackToCache",
    value: (function () {
      var _fallbackToCache = (0, _asyncToGenerator2.default)(function* (fn, getCacheFn) {
        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        try {
          var result = yield fn();
          return {
            success: true,
            data: result
          };
        } catch (error) {
          logger_1.logger.warn('Request failed, attempting cache fallback', {
            error: error
          });
          try {
            var cachedData = yield getCacheFn();
            if (cachedData !== null) {
              logger_1.logger.info('Using cached data as fallback');
              return {
                success: true,
                data: cachedData
              };
            }
          } catch (cacheError) {
            logger_1.logger.error('Cache retrieval failed', {
              error: cacheError
            });
          }
          return {
            success: false,
            error: error
          };
        }
      });
      function fallbackToCache(_x4, _x5) {
        return _fallbackToCache.apply(this, arguments);
      }
      return fallbackToCache;
    }())
  }, {
    key: "queueForOffline",
    value: (function () {
      var _queueForOffline = (0, _asyncToGenerator2.default)(function* (fn, queueFn) {
        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        try {
          var result = yield fn();
          return {
            success: true,
            data: result
          };
        } catch (error) {
          if (this.isNetworkError(error)) {
            logger_1.logger.info('Network error, queueing for offline processing', {
              error: error
            });
            try {
              yield queueFn(options.fallbackData);
              return {
                success: true,
                data: options.fallbackData
              };
            } catch (queueError) {
              logger_1.logger.error('Failed to queue request', {
                error: queueError
              });
            }
          }
          return {
            success: false,
            error: error
          };
        }
      });
      function queueForOffline(_x6, _x7) {
        return _queueForOffline.apply(this, arguments);
      }
      return queueForOffline;
    }())
  }, {
    key: "promptUserIntervention",
    value: (function () {
      var _promptUserIntervention = (0, _asyncToGenerator2.default)(function* (fn, promptFn) {
        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        try {
          var result = yield fn();
          return {
            success: true,
            data: result
          };
        } catch (error) {
          var userWantsRetry = yield promptFn(error);
          if (userWantsRetry) {
            logger_1.logger.info('User requested retry');
            return yield this.autoRetry(fn, options);
          }
          return {
            success: false,
            error: error
          };
        }
      });
      function promptUserIntervention(_x8, _x9) {
        return _promptUserIntervention.apply(this, arguments);
      }
      return promptUserIntervention;
    }())
  }, {
    key: "combinedRecovery",
    value: (function () {
      var _combinedRecovery = (0, _asyncToGenerator2.default)(function* (fn, strategies) {
        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        try {
          var result = yield fn();
          return {
            success: true,
            data: result
          };
        } catch (error) {
          if (strategies.refreshToken && this.isAuthenticationError(error)) {
            logger_1.logger.info('Attempting token refresh recovery');
            var _result = yield this.retryWithTokenRefresh(fn, strategies.refreshToken, options);
            if (_result.success) {
              return _result;
            }
          }
          if (strategies.useCache) {
            logger_1.logger.info('Attempting cache fallback');
            var _result2 = yield this.fallbackToCache(fn, strategies.useCache, options);
            if (_result2.success) {
              return _result2;
            }
          }
          if (strategies.queue && this.isNetworkError(error)) {
            logger_1.logger.info('Attempting offline queue');
            var _result3 = yield this.queueForOffline(fn, strategies.queue, options);
            if (_result3.success) {
              return _result3;
            }
          }
          if (strategies.retry) {
            logger_1.logger.info('Attempting auto-retry');
            var _result4 = yield this.autoRetry(fn, options);
            if (_result4.success) {
              return _result4;
            }
          }
          if (strategies.promptUser) {
            logger_1.logger.info('Prompting user for intervention');
            return yield this.promptUserIntervention(fn, strategies.promptUser, options);
          }
          return {
            success: false,
            error: error
          };
        }
      });
      function combinedRecovery(_x0, _x1) {
        return _combinedRecovery.apply(this, arguments);
      }
      return combinedRecovery;
    }())
  }, {
    key: "isAuthenticationError",
    value: function isAuthenticationError(error) {
      if (error && typeof error === 'object') {
        if ('status' in error && error.status === 401) {
          return true;
        }
        if ('statusCode' in error && error.statusCode === 401) {
          return true;
        }
      }
      if (error instanceof Error) {
        var message = error.message.toLowerCase();
        return message.includes('unauthorized') || message.includes('authentication') || message.includes('token');
      }
      return false;
    }
  }, {
    key: "isNetworkError",
    value: function isNetworkError(error) {
      if (error instanceof Error) {
        var message = error.message.toLowerCase();
        return message.includes('network') || message.includes('connection') || message.includes('timeout') || message.includes('econnrefused');
      }
      return false;
    }
  }, {
    key: "sleep",
    value: function sleep(ms) {
      return new Promise(function (resolve) {
        return setTimeout(resolve, ms);
      });
    }
  }]);
}();
exports.RecoveryStrategies = RecoveryStrategies;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9hc3luY1RvR2VuZXJhdG9yMiIsIl9jbGFzc0NhbGxDaGVjazIiLCJfY3JlYXRlQ2xhc3MyIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJSZWNvdmVyeVN0cmF0ZWdpZXMiLCJsb2dnZXJfMSIsImRlZmF1bHQiLCJrZXkiLCJfYXV0b1JldHJ5IiwiZm4iLCJfb3B0aW9ucyRtYXhSZXRyaWVzIiwiX29wdGlvbnMkcmV0cnlEZWxheSIsIm9wdGlvbnMiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJtYXhSZXRyaWVzIiwicmV0cnlEZWxheSIsImxhc3RFcnJvciIsImF0dGVtcHQiLCJvblJldHJ5IiwicmVzdWx0Iiwic3VjY2VzcyIsImRhdGEiLCJyZXRyaWVzUGVyZm9ybWVkIiwiZXJyb3IiLCJkZWxheSIsIk1hdGgiLCJwb3ciLCJsb2dnZXIiLCJkZWJ1ZyIsInNsZWVwIiwib25GYWlsdXJlIiwiYXV0b1JldHJ5IiwiX3giLCJhcHBseSIsIl9yZXRyeVdpdGhUb2tlblJlZnJlc2giLCJyZWZyZXNoVG9rZW5GbiIsImlzQXV0aGVudGljYXRpb25FcnJvciIsImluZm8iLCJyZXRyeVJlc3VsdCIsInJlZnJlc2hFcnJvciIsInJldHJ5V2l0aFRva2VuUmVmcmVzaCIsIl94MiIsIl94MyIsIl9mYWxsYmFja1RvQ2FjaGUiLCJnZXRDYWNoZUZuIiwid2FybiIsImNhY2hlZERhdGEiLCJjYWNoZUVycm9yIiwiZmFsbGJhY2tUb0NhY2hlIiwiX3g0IiwiX3g1IiwiX3F1ZXVlRm9yT2ZmbGluZSIsInF1ZXVlRm4iLCJpc05ldHdvcmtFcnJvciIsImZhbGxiYWNrRGF0YSIsInF1ZXVlRXJyb3IiLCJxdWV1ZUZvck9mZmxpbmUiLCJfeDYiLCJfeDciLCJfcHJvbXB0VXNlckludGVydmVudGlvbiIsInByb21wdEZuIiwidXNlcldhbnRzUmV0cnkiLCJwcm9tcHRVc2VySW50ZXJ2ZW50aW9uIiwiX3g4IiwiX3g5IiwiX2NvbWJpbmVkUmVjb3ZlcnkiLCJzdHJhdGVnaWVzIiwicmVmcmVzaFRva2VuIiwidXNlQ2FjaGUiLCJxdWV1ZSIsInJldHJ5IiwicHJvbXB0VXNlciIsImNvbWJpbmVkUmVjb3ZlcnkiLCJfeDAiLCJfeDEiLCJzdGF0dXMiLCJzdGF0dXNDb2RlIiwiRXJyb3IiLCJtZXNzYWdlIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsIm1zIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0Il0sInNvdXJjZXMiOlsiUmVjb3ZlcnlTdHJhdGVnaWVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBSZWNvdmVyeSBTdHJhdGVnaWVzXG4gKiBQcm92aWRlcyBkaWZmZXJlbnQgcmVjb3Zlcnkgc3RyYXRlZ2llcyBmb3IgQVBJIGVycm9yc1xuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLlJlY292ZXJ5U3RyYXRlZ2llcyA9IHZvaWQgMDtcbmNvbnN0IGxvZ2dlcl8xID0gcmVxdWlyZShcIi4uL3V0aWxzL2xvZ2dlclwiKTtcbmNsYXNzIFJlY292ZXJ5U3RyYXRlZ2llcyB7XG4gICAgLyoqXG4gICAgICogQXV0by1yZXRyeSB3aXRoIGV4cG9uZW50aWFsIGJhY2tvZmZcbiAgICAgKi9cbiAgICBhc3luYyBhdXRvUmV0cnkoZm4sIG9wdGlvbnMgPSB7fSkge1xuICAgICAgICBjb25zdCBtYXhSZXRyaWVzID0gb3B0aW9ucy5tYXhSZXRyaWVzID8/IDM7XG4gICAgICAgIGNvbnN0IHJldHJ5RGVsYXkgPSBvcHRpb25zLnJldHJ5RGVsYXkgPz8gMTAwMDtcbiAgICAgICAgbGV0IGxhc3RFcnJvcjtcbiAgICAgICAgZm9yIChsZXQgYXR0ZW1wdCA9IDA7IGF0dGVtcHQgPD0gbWF4UmV0cmllczsgYXR0ZW1wdCsrKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmIChhdHRlbXB0ID4gMCAmJiBvcHRpb25zLm9uUmV0cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5vblJldHJ5KGF0dGVtcHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmbigpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHJlc3VsdCxcbiAgICAgICAgICAgICAgICAgICAgcmV0cmllc1BlcmZvcm1lZDogYXR0ZW1wdCxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgbGFzdEVycm9yID0gZXJyb3I7XG4gICAgICAgICAgICAgICAgaWYgKGF0dGVtcHQgPCBtYXhSZXRyaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlbGF5ID0gcmV0cnlEZWxheSAqIE1hdGgucG93KDIsIGF0dGVtcHQpO1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXJfMS5sb2dnZXIuZGVidWcoJ1JldHJ5aW5nIGFmdGVyIGRlbGF5JywgeyBhdHRlbXB0LCBkZWxheSB9KTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zbGVlcChkZWxheSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLm9uRmFpbHVyZSkge1xuICAgICAgICAgICAgb3B0aW9ucy5vbkZhaWx1cmUobGFzdEVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBlcnJvcjogbGFzdEVycm9yLFxuICAgICAgICAgICAgcmV0cmllc1BlcmZvcm1lZDogbWF4UmV0cmllcyxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cnkgd2l0aCB0b2tlbiByZWZyZXNoXG4gICAgICovXG4gICAgYXN5bmMgcmV0cnlXaXRoVG9rZW5SZWZyZXNoKGZuLCByZWZyZXNoVG9rZW5Gbiwgb3B0aW9ucyA9IHt9KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmbigpO1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBDaGVjayBpZiBlcnJvciBpcyBhdXRoZW50aWNhdGlvbiBlcnJvclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNBdXRoZW50aWNhdGlvbkVycm9yKGVycm9yKSkge1xuICAgICAgICAgICAgICAgIGxvZ2dlcl8xLmxvZ2dlci5pbmZvKCdBdXRoZW50aWNhdGlvbiBlcnJvciwgcmVmcmVzaGluZyB0b2tlbicpO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHJlZnJlc2hUb2tlbkZuKCk7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlcl8xLmxvZ2dlci5pbmZvKCdUb2tlbiByZWZyZXNoZWQsIHJldHJ5aW5nIHJlcXVlc3QnKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmV0cnkgb3JpZ2luYWwgcmVxdWVzdFxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXRyeVJlc3VsdCA9IGF3YWl0IHRoaXMuYXV0b1JldHJ5KGZuLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldHJ5UmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAocmVmcmVzaEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlcl8xLmxvZ2dlci5lcnJvcignVG9rZW4gcmVmcmVzaCBmYWlsZWQnLCB7IGVycm9yOiByZWZyZXNoRXJyb3IgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiByZWZyZXNoRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRmFsbGJhY2sgdG8gY2FjaGVkIGRhdGFcbiAgICAgKi9cbiAgICBhc3luYyBmYWxsYmFja1RvQ2FjaGUoZm4sIGdldENhY2hlRm4sIG9wdGlvbnMgPSB7fSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZm4oKTtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbG9nZ2VyXzEubG9nZ2VyLndhcm4oJ1JlcXVlc3QgZmFpbGVkLCBhdHRlbXB0aW5nIGNhY2hlIGZhbGxiYWNrJywgeyBlcnJvciB9KTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2FjaGVkRGF0YSA9IGF3YWl0IGdldENhY2hlRm4oKTtcbiAgICAgICAgICAgICAgICBpZiAoY2FjaGVkRGF0YSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXJfMS5sb2dnZXIuaW5mbygnVXNpbmcgY2FjaGVkIGRhdGEgYXMgZmFsbGJhY2snKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBjYWNoZWREYXRhLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChjYWNoZUVycm9yKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyXzEubG9nZ2VyLmVycm9yKCdDYWNoZSByZXRyaWV2YWwgZmFpbGVkJywgeyBlcnJvcjogY2FjaGVFcnJvciB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3IsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFF1ZXVlIGZvciBvZmZsaW5lIHByb2Nlc3NpbmdcbiAgICAgKi9cbiAgICBhc3luYyBxdWV1ZUZvck9mZmxpbmUoZm4sIHF1ZXVlRm4sIG9wdGlvbnMgPSB7fSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZm4oKTtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgZXJyb3IgaXMgbmV0d29yayBlcnJvclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNOZXR3b3JrRXJyb3IoZXJyb3IpKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyXzEubG9nZ2VyLmluZm8oJ05ldHdvcmsgZXJyb3IsIHF1ZXVlaW5nIGZvciBvZmZsaW5lIHByb2Nlc3NpbmcnLCB7IGVycm9yIH0pO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHF1ZXVlRm4ob3B0aW9ucy5mYWxsYmFja0RhdGEpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IG9wdGlvbnMuZmFsbGJhY2tEYXRhLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAocXVldWVFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXJfMS5sb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBxdWV1ZSByZXF1ZXN0JywgeyBlcnJvcjogcXVldWVFcnJvciB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm9tcHQgdXNlciBmb3IgaW50ZXJ2ZW50aW9uXG4gICAgICovXG4gICAgYXN5bmMgcHJvbXB0VXNlckludGVydmVudGlvbihmbiwgcHJvbXB0Rm4sIG9wdGlvbnMgPSB7fSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZm4oKTtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc3QgdXNlcldhbnRzUmV0cnkgPSBhd2FpdCBwcm9tcHRGbihlcnJvcik7XG4gICAgICAgICAgICBpZiAodXNlcldhbnRzUmV0cnkpIHtcbiAgICAgICAgICAgICAgICBsb2dnZXJfMS5sb2dnZXIuaW5mbygnVXNlciByZXF1ZXN0ZWQgcmV0cnknKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5hdXRvUmV0cnkoZm4sIG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tYmluZWQgcmVjb3Zlcnkgc3RyYXRlZ3lcbiAgICAgKi9cbiAgICBhc3luYyBjb21iaW5lZFJlY292ZXJ5KGZuLCBzdHJhdGVnaWVzLCBvcHRpb25zID0ge30pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGZuKCk7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIFRyeSB0b2tlbiByZWZyZXNoIGZpcnN0XG4gICAgICAgICAgICBpZiAoc3RyYXRlZ2llcy5yZWZyZXNoVG9rZW4gJiYgdGhpcy5pc0F1dGhlbnRpY2F0aW9uRXJyb3IoZXJyb3IpKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyXzEubG9nZ2VyLmluZm8oJ0F0dGVtcHRpbmcgdG9rZW4gcmVmcmVzaCByZWNvdmVyeScpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucmV0cnlXaXRoVG9rZW5SZWZyZXNoKGZuLCBzdHJhdGVnaWVzLnJlZnJlc2hUb2tlbiwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gVHJ5IGNhY2hlIGZhbGxiYWNrXG4gICAgICAgICAgICBpZiAoc3RyYXRlZ2llcy51c2VDYWNoZSkge1xuICAgICAgICAgICAgICAgIGxvZ2dlcl8xLmxvZ2dlci5pbmZvKCdBdHRlbXB0aW5nIGNhY2hlIGZhbGxiYWNrJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5mYWxsYmFja1RvQ2FjaGUoZm4sIHN0cmF0ZWdpZXMudXNlQ2FjaGUsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFRyeSBvZmZsaW5lIHF1ZXVlXG4gICAgICAgICAgICBpZiAoc3RyYXRlZ2llcy5xdWV1ZSAmJiB0aGlzLmlzTmV0d29ya0Vycm9yKGVycm9yKSkge1xuICAgICAgICAgICAgICAgIGxvZ2dlcl8xLmxvZ2dlci5pbmZvKCdBdHRlbXB0aW5nIG9mZmxpbmUgcXVldWUnKTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXVlRm9yT2ZmbGluZShmbiwgc3RyYXRlZ2llcy5xdWV1ZSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gVHJ5IGF1dG8tcmV0cnlcbiAgICAgICAgICAgIGlmIChzdHJhdGVnaWVzLnJldHJ5KSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyXzEubG9nZ2VyLmluZm8oJ0F0dGVtcHRpbmcgYXV0by1yZXRyeScpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXV0b1JldHJ5KGZuLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBGaW5hbGx5LCBwcm9tcHQgdXNlclxuICAgICAgICAgICAgaWYgKHN0cmF0ZWdpZXMucHJvbXB0VXNlcikge1xuICAgICAgICAgICAgICAgIGxvZ2dlcl8xLmxvZ2dlci5pbmZvKCdQcm9tcHRpbmcgdXNlciBmb3IgaW50ZXJ2ZW50aW9uJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucHJvbXB0VXNlckludGVydmVudGlvbihmbiwgc3RyYXRlZ2llcy5wcm9tcHRVc2VyLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3IsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGVycm9yIGlzIGF1dGhlbnRpY2F0aW9uIGVycm9yXG4gICAgICovXG4gICAgaXNBdXRoZW50aWNhdGlvbkVycm9yKGVycm9yKSB7XG4gICAgICAgIGlmIChlcnJvciAmJiB0eXBlb2YgZXJyb3IgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBpZiAoJ3N0YXR1cycgaW4gZXJyb3IgJiYgZXJyb3Iuc3RhdHVzID09PSA0MDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgnc3RhdHVzQ29kZScgaW4gZXJyb3IgJiYgZXJyb3Iuc3RhdHVzQ29kZSA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5pbmNsdWRlcygndW5hdXRob3JpemVkJykgfHxcbiAgICAgICAgICAgICAgICBtZXNzYWdlLmluY2x1ZGVzKCdhdXRoZW50aWNhdGlvbicpIHx8XG4gICAgICAgICAgICAgICAgbWVzc2FnZS5pbmNsdWRlcygndG9rZW4nKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGVycm9yIGlzIG5ldHdvcmsgZXJyb3JcbiAgICAgKi9cbiAgICBpc05ldHdvcmtFcnJvcihlcnJvcikge1xuICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGVycm9yLm1lc3NhZ2UudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmluY2x1ZGVzKCduZXR3b3JrJykgfHxcbiAgICAgICAgICAgICAgICBtZXNzYWdlLmluY2x1ZGVzKCdjb25uZWN0aW9uJykgfHxcbiAgICAgICAgICAgICAgICBtZXNzYWdlLmluY2x1ZGVzKCd0aW1lb3V0JykgfHxcbiAgICAgICAgICAgICAgICBtZXNzYWdlLmluY2x1ZGVzKCdlY29ubnJlZnVzZWQnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNsZWVwIGZvciBzcGVjaWZpZWQgbWlsbGlzZWNvbmRzXG4gICAgICovXG4gICAgc2xlZXAobXMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xuICAgIH1cbn1cbmV4cG9ydHMuUmVjb3ZlcnlTdHJhdGVnaWVzID0gUmVjb3ZlcnlTdHJhdGVnaWVzO1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZO0FB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