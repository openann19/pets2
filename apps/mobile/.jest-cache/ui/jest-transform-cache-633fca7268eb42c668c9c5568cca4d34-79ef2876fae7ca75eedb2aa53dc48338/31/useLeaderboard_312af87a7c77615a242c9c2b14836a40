200209235d9170fd64441b20685ee095
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useLeaderboard = void 0;
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _react = require("react");
var _core = require("@pawfectmatch/core");
var _LeaderboardService = _interopRequireDefault(require("../../../services/LeaderboardService"));
var useLeaderboard = exports.useLeaderboard = function useLeaderboard() {
  var _useState = (0, _react.useState)([]),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    entries = _useState2[0],
    setEntries = _useState2[1];
  var _useState3 = (0, _react.useState)([]),
    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),
    categories = _useState4[0],
    setCategories = _useState4[1];
  var _useState5 = (0, _react.useState)("all"),
    _useState6 = (0, _slicedToArray2.default)(_useState5, 2),
    selectedCategory = _useState6[0],
    setSelectedCategory = _useState6[1];
  var _useState7 = (0, _react.useState)("weekly"),
    _useState8 = (0, _slicedToArray2.default)(_useState7, 2),
    selectedPeriod = _useState8[0],
    setSelectedPeriod = _useState8[1];
  var _useState9 = (0, _react.useState)(null),
    _useState0 = (0, _slicedToArray2.default)(_useState9, 2),
    userRank = _useState0[0],
    setUserRank = _useState0[1];
  var _useState1 = (0, _react.useState)(null),
    _useState10 = (0, _slicedToArray2.default)(_useState1, 2),
    userEntry = _useState10[0],
    setUserEntry = _useState10[1];
  var _useState11 = (0, _react.useState)(true),
    _useState12 = (0, _slicedToArray2.default)(_useState11, 2),
    loading = _useState12[0],
    setLoading = _useState12[1];
  var _useState13 = (0, _react.useState)(false),
    _useState14 = (0, _slicedToArray2.default)(_useState13, 2),
    refreshing = _useState14[0],
    setRefreshing = _useState14[1];
  var _useState15 = (0, _react.useState)(1),
    _useState16 = (0, _slicedToArray2.default)(_useState15, 2),
    page = _useState16[0],
    setPage = _useState16[1];
  var _useState17 = (0, _react.useState)(true),
    _useState18 = (0, _slicedToArray2.default)(_useState17, 2),
    hasMore = _useState18[0],
    setHasMore = _useState18[1];
  var _useState19 = (0, _react.useState)(false),
    _useState20 = (0, _slicedToArray2.default)(_useState19, 2),
    showFilters = _useState20[0],
    setShowFilters = _useState20[1];
  var loadCategories = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    try {
      var categoriesData = yield _LeaderboardService.default.getCategories();
      setCategories(categoriesData);
    } catch (error) {
      _core.logger.error("Failed to load categories:", {
        error: error
      });
      throw error;
    }
  }), []);
  var loadLeaderboard = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    var pageNum = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
    try {
      var filter = selectedCategory === "all" ? {
        period: selectedPeriod
      } : {
        category: selectedCategory,
        period: selectedPeriod
      };
      var response = yield _LeaderboardService.default.getLeaderboard(filter, pageNum, 20);
      if (pageNum === 1) {
        setEntries(response.entries);
      } else {
        setEntries(function (prev) {
          return [].concat((0, _toConsumableArray2.default)(prev), (0, _toConsumableArray2.default)(response.entries));
        });
      }
      setHasMore(response.hasMore);
      setPage(pageNum);
    } catch (error) {
      _core.logger.error("Failed to load leaderboard:", {
        error: error
      });
      throw error;
    }
  }), [selectedCategory, selectedPeriod]);
  var loadUserRank = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    try {
      var rankData = yield _LeaderboardService.default.getUserRank(selectedCategory === "all" ? undefined : selectedCategory);
      setUserRank(rankData.rank);
      setUserEntry(rankData.entry);
    } catch (error) {
      _core.logger.error("Failed to load user rank:", {
        error: error
      });
      throw error;
    }
  }), [selectedCategory]);
  var loadInitialData = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    try {
      setLoading(true);
      yield Promise.all([loadCategories(), loadLeaderboard(), loadUserRank()]);
    } catch (error) {
      _core.logger.error("Failed to load initial data:", {
        error: error
      });
      throw error;
    } finally {
      setLoading(false);
    }
  }), [loadCategories, loadLeaderboard, loadUserRank]);
  var refreshData = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    try {
      setRefreshing(true);
      yield Promise.all([loadLeaderboard(1), loadUserRank()]);
    } catch (error) {
      _core.logger.error("Failed to refresh data:", {
        error: error
      });
      throw error;
    } finally {
      setRefreshing(false);
    }
  }), [loadLeaderboard, loadUserRank]);
  var loadMore = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    if (!hasMore || loading) return;
    try {
      yield loadLeaderboard(page + 1);
    } catch (error) {
      _core.logger.error("Failed to load more entries:", {
        error: error
      });
      throw error;
    }
  }), [hasMore, loading, loadLeaderboard, page]);
  (0, _react.useEffect)(function () {
    void loadInitialData();
  }, []);
  (0, _react.useEffect)(function () {
    if (categories.length > 0) {
      void loadLeaderboard();
      void loadUserRank();
    }
  }, [selectedCategory, selectedPeriod]);
  return {
    entries: entries,
    categories: categories,
    userRank: userRank,
    userEntry: userEntry,
    loading: loading,
    refreshing: refreshing,
    page: page,
    hasMore: hasMore,
    showFilters: showFilters,
    selectedCategory: selectedCategory,
    selectedPeriod: selectedPeriod,
    setSelectedCategory: setSelectedCategory,
    setSelectedPeriod: setSelectedPeriod,
    setShowFilters: setShowFilters,
    refreshData: refreshData,
    loadMore: loadMore,
    loadInitialData: loadInitialData
  };
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX2NvcmUiLCJfTGVhZGVyYm9hcmRTZXJ2aWNlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInVzZUxlYWRlcmJvYXJkIiwiZXhwb3J0cyIsIl91c2VTdGF0ZSIsInVzZVN0YXRlIiwiX3VzZVN0YXRlMiIsIl9zbGljZWRUb0FycmF5MiIsImRlZmF1bHQiLCJlbnRyaWVzIiwic2V0RW50cmllcyIsIl91c2VTdGF0ZTMiLCJfdXNlU3RhdGU0IiwiY2F0ZWdvcmllcyIsInNldENhdGVnb3JpZXMiLCJfdXNlU3RhdGU1IiwiX3VzZVN0YXRlNiIsInNlbGVjdGVkQ2F0ZWdvcnkiLCJzZXRTZWxlY3RlZENhdGVnb3J5IiwiX3VzZVN0YXRlNyIsIl91c2VTdGF0ZTgiLCJzZWxlY3RlZFBlcmlvZCIsInNldFNlbGVjdGVkUGVyaW9kIiwiX3VzZVN0YXRlOSIsIl91c2VTdGF0ZTAiLCJ1c2VyUmFuayIsInNldFVzZXJSYW5rIiwiX3VzZVN0YXRlMSIsIl91c2VTdGF0ZTEwIiwidXNlckVudHJ5Iiwic2V0VXNlckVudHJ5IiwiX3VzZVN0YXRlMTEiLCJfdXNlU3RhdGUxMiIsImxvYWRpbmciLCJzZXRMb2FkaW5nIiwiX3VzZVN0YXRlMTMiLCJfdXNlU3RhdGUxNCIsInJlZnJlc2hpbmciLCJzZXRSZWZyZXNoaW5nIiwiX3VzZVN0YXRlMTUiLCJfdXNlU3RhdGUxNiIsInBhZ2UiLCJzZXRQYWdlIiwiX3VzZVN0YXRlMTciLCJfdXNlU3RhdGUxOCIsImhhc01vcmUiLCJzZXRIYXNNb3JlIiwiX3VzZVN0YXRlMTkiLCJfdXNlU3RhdGUyMCIsInNob3dGaWx0ZXJzIiwic2V0U2hvd0ZpbHRlcnMiLCJsb2FkQ2F0ZWdvcmllcyIsInVzZUNhbGxiYWNrIiwiX2FzeW5jVG9HZW5lcmF0b3IyIiwiY2F0ZWdvcmllc0RhdGEiLCJMZWFkZXJib2FyZFNlcnZpY2UiLCJnZXRDYXRlZ29yaWVzIiwiZXJyb3IiLCJsb2dnZXIiLCJsb2FkTGVhZGVyYm9hcmQiLCJwYWdlTnVtIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiZmlsdGVyIiwicGVyaW9kIiwiY2F0ZWdvcnkiLCJyZXNwb25zZSIsImdldExlYWRlcmJvYXJkIiwicHJldiIsImNvbmNhdCIsIl90b0NvbnN1bWFibGVBcnJheTIiLCJsb2FkVXNlclJhbmsiLCJyYW5rRGF0YSIsImdldFVzZXJSYW5rIiwicmFuayIsImVudHJ5IiwibG9hZEluaXRpYWxEYXRhIiwiUHJvbWlzZSIsImFsbCIsInJlZnJlc2hEYXRhIiwibG9hZE1vcmUiLCJ1c2VFZmZlY3QiXSwic291cmNlcyI6WyJ1c2VMZWFkZXJib2FyZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIHVzZUxlYWRlcmJvYXJkIEhvb2tcbiAqIE1hbmFnZXMgbGVhZGVyYm9hcmQgZGF0YSwgZmlsdGVyaW5nLCBwYWdpbmF0aW9uLCBhbmQgdXNlciByYW5raW5nXG4gKi9cbmltcG9ydCB7IHVzZUNhbGxiYWNrLCB1c2VFZmZlY3QsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tIFwiQHBhd2ZlY3RtYXRjaC9jb3JlXCI7XG5pbXBvcnQgdHlwZSB7XG4gIExlYWRlcmJvYXJkQ2F0ZWdvcnksXG4gIExlYWRlcmJvYXJkRW50cnksXG4gIExlYWRlcmJvYXJkRmlsdGVyLFxufSBmcm9tIFwiLi4vLi4vLi4vc2VydmljZXMvTGVhZGVyYm9hcmRTZXJ2aWNlXCI7XG5pbXBvcnQgTGVhZGVyYm9hcmRTZXJ2aWNlIGZyb20gXCIuLi8uLi8uLi9zZXJ2aWNlcy9MZWFkZXJib2FyZFNlcnZpY2VcIjtcblxuaW50ZXJmYWNlIFVzZUxlYWRlcmJvYXJkUmV0dXJuIHtcbiAgLy8gRGF0YVxuICBlbnRyaWVzOiBMZWFkZXJib2FyZEVudHJ5W107XG4gIGNhdGVnb3JpZXM6IExlYWRlcmJvYXJkQ2F0ZWdvcnlbXTtcbiAgdXNlclJhbms6IG51bWJlciB8IG51bGw7XG4gIHVzZXJFbnRyeTogTGVhZGVyYm9hcmRFbnRyeSB8IG51bGw7XG5cbiAgLy8gU3RhdGVcbiAgbG9hZGluZzogYm9vbGVhbjtcbiAgcmVmcmVzaGluZzogYm9vbGVhbjtcbiAgcGFnZTogbnVtYmVyO1xuICBoYXNNb3JlOiBib29sZWFuO1xuICBzaG93RmlsdGVyczogYm9vbGVhbjtcblxuICAvLyBGaWx0ZXJzXG4gIHNlbGVjdGVkQ2F0ZWdvcnk6IHN0cmluZztcbiAgc2VsZWN0ZWRQZXJpb2Q6IFwiZGFpbHlcIiB8IFwid2Vla2x5XCIgfCBcIm1vbnRobHlcIiB8IFwiYWxsX3RpbWVcIjtcblxuICAvLyBBY3Rpb25zXG4gIHNldFNlbGVjdGVkQ2F0ZWdvcnk6IChjYXRlZ29yeTogc3RyaW5nKSA9PiB2b2lkO1xuICBzZXRTZWxlY3RlZFBlcmlvZDogKFxuICAgIHBlcmlvZDogXCJkYWlseVwiIHwgXCJ3ZWVrbHlcIiB8IFwibW9udGhseVwiIHwgXCJhbGxfdGltZVwiLFxuICApID0+IHZvaWQ7XG4gIHNldFNob3dGaWx0ZXJzOiAoc2hvdzogYm9vbGVhbikgPT4gdm9pZDtcbiAgcmVmcmVzaERhdGE6ICgpID0+IFByb21pc2U8dm9pZD47XG4gIGxvYWRNb3JlOiAoKSA9PiBQcm9taXNlPHZvaWQ+O1xuICBsb2FkSW5pdGlhbERhdGE6ICgpID0+IFByb21pc2U8dm9pZD47XG59XG5cbmV4cG9ydCBjb25zdCB1c2VMZWFkZXJib2FyZCA9ICgpOiBVc2VMZWFkZXJib2FyZFJldHVybiA9PiB7XG4gIGNvbnN0IFtlbnRyaWVzLCBzZXRFbnRyaWVzXSA9IHVzZVN0YXRlPExlYWRlcmJvYXJkRW50cnlbXT4oW10pO1xuICBjb25zdCBbY2F0ZWdvcmllcywgc2V0Q2F0ZWdvcmllc10gPSB1c2VTdGF0ZTxMZWFkZXJib2FyZENhdGVnb3J5W10+KFtdKTtcbiAgY29uc3QgW3NlbGVjdGVkQ2F0ZWdvcnksIHNldFNlbGVjdGVkQ2F0ZWdvcnldID0gdXNlU3RhdGU8c3RyaW5nPihcImFsbFwiKTtcbiAgY29uc3QgW3NlbGVjdGVkUGVyaW9kLCBzZXRTZWxlY3RlZFBlcmlvZF0gPSB1c2VTdGF0ZTxcbiAgICBcImRhaWx5XCIgfCBcIndlZWtseVwiIHwgXCJtb250aGx5XCIgfCBcImFsbF90aW1lXCJcbiAgPihcIndlZWtseVwiKTtcbiAgY29uc3QgW3VzZXJSYW5rLCBzZXRVc2VyUmFua10gPSB1c2VTdGF0ZTxudW1iZXIgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW3VzZXJFbnRyeSwgc2V0VXNlckVudHJ5XSA9IHVzZVN0YXRlPExlYWRlcmJvYXJkRW50cnkgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUodHJ1ZSk7XG4gIGNvbnN0IFtyZWZyZXNoaW5nLCBzZXRSZWZyZXNoaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW3BhZ2UsIHNldFBhZ2VdID0gdXNlU3RhdGUoMSk7XG4gIGNvbnN0IFtoYXNNb3JlLCBzZXRIYXNNb3JlXSA9IHVzZVN0YXRlKHRydWUpO1xuICBjb25zdCBbc2hvd0ZpbHRlcnMsIHNldFNob3dGaWx0ZXJzXSA9IHVzZVN0YXRlKGZhbHNlKTtcblxuICBjb25zdCBsb2FkQ2F0ZWdvcmllcyA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY2F0ZWdvcmllc0RhdGEgPSBhd2FpdCBMZWFkZXJib2FyZFNlcnZpY2UuZ2V0Q2F0ZWdvcmllcygpO1xuICAgICAgc2V0Q2F0ZWdvcmllcyhjYXRlZ29yaWVzRGF0YSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBsb2FkIGNhdGVnb3JpZXM6XCIsIHsgZXJyb3IgfSk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0sIFtdKTtcblxuICBjb25zdCBsb2FkTGVhZGVyYm9hcmQgPSB1c2VDYWxsYmFjayhcbiAgICBhc3luYyAocGFnZU51bSA9IDEpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGZpbHRlcjogTGVhZGVyYm9hcmRGaWx0ZXIgPVxuICAgICAgICAgIHNlbGVjdGVkQ2F0ZWdvcnkgPT09IFwiYWxsXCJcbiAgICAgICAgICAgID8geyBwZXJpb2Q6IHNlbGVjdGVkUGVyaW9kIH1cbiAgICAgICAgICAgIDogeyBjYXRlZ29yeTogc2VsZWN0ZWRDYXRlZ29yeSwgcGVyaW9kOiBzZWxlY3RlZFBlcmlvZCB9O1xuXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgTGVhZGVyYm9hcmRTZXJ2aWNlLmdldExlYWRlcmJvYXJkKFxuICAgICAgICAgIGZpbHRlcixcbiAgICAgICAgICBwYWdlTnVtLFxuICAgICAgICAgIDIwLFxuICAgICAgICApO1xuXG4gICAgICAgIGlmIChwYWdlTnVtID09PSAxKSB7XG4gICAgICAgICAgc2V0RW50cmllcyhyZXNwb25zZS5lbnRyaWVzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzZXRFbnRyaWVzKChwcmV2KSA9PiBbLi4ucHJldiwgLi4ucmVzcG9uc2UuZW50cmllc10pO1xuICAgICAgICB9XG5cbiAgICAgICAgc2V0SGFzTW9yZShyZXNwb25zZS5oYXNNb3JlKTtcbiAgICAgICAgc2V0UGFnZShwYWdlTnVtKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBsb2FkIGxlYWRlcmJvYXJkOlwiLCB7IGVycm9yIH0pO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cbiAgICB9LFxuICAgIFtzZWxlY3RlZENhdGVnb3J5LCBzZWxlY3RlZFBlcmlvZF0sXG4gICk7XG5cbiAgY29uc3QgbG9hZFVzZXJSYW5rID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByYW5rRGF0YSA9IGF3YWl0IExlYWRlcmJvYXJkU2VydmljZS5nZXRVc2VyUmFuayhcbiAgICAgICAgc2VsZWN0ZWRDYXRlZ29yeSA9PT0gXCJhbGxcIiA/IHVuZGVmaW5lZCA6IHNlbGVjdGVkQ2F0ZWdvcnksXG4gICAgICApO1xuICAgICAgc2V0VXNlclJhbmsocmFua0RhdGEucmFuayk7XG4gICAgICBzZXRVc2VyRW50cnkocmFua0RhdGEuZW50cnkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gbG9hZCB1c2VyIHJhbms6XCIsIHsgZXJyb3IgfSk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0sIFtzZWxlY3RlZENhdGVnb3J5XSk7XG5cbiAgY29uc3QgbG9hZEluaXRpYWxEYXRhID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBzZXRMb2FkaW5nKHRydWUpO1xuICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoW2xvYWRDYXRlZ29yaWVzKCksIGxvYWRMZWFkZXJib2FyZCgpLCBsb2FkVXNlclJhbmsoKV0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBpbml0aWFsIGRhdGE6XCIsIHsgZXJyb3IgfSk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgfVxuICB9LCBbbG9hZENhdGVnb3JpZXMsIGxvYWRMZWFkZXJib2FyZCwgbG9hZFVzZXJSYW5rXSk7XG5cbiAgY29uc3QgcmVmcmVzaERhdGEgPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIHNldFJlZnJlc2hpbmcodHJ1ZSk7XG4gICAgICBhd2FpdCBQcm9taXNlLmFsbChbbG9hZExlYWRlcmJvYXJkKDEpLCBsb2FkVXNlclJhbmsoKV0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gcmVmcmVzaCBkYXRhOlwiLCB7IGVycm9yIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldFJlZnJlc2hpbmcoZmFsc2UpO1xuICAgIH1cbiAgfSwgW2xvYWRMZWFkZXJib2FyZCwgbG9hZFVzZXJSYW5rXSk7XG5cbiAgY29uc3QgbG9hZE1vcmUgPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7XG4gICAgaWYgKCFoYXNNb3JlIHx8IGxvYWRpbmcpIHJldHVybjtcblxuICAgIHRyeSB7XG4gICAgICBhd2FpdCBsb2FkTGVhZGVyYm9hcmQocGFnZSArIDEpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBtb3JlIGVudHJpZXM6XCIsIHsgZXJyb3IgfSk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0sIFtoYXNNb3JlLCBsb2FkaW5nLCBsb2FkTGVhZGVyYm9hcmQsIHBhZ2VdKTtcblxuICAvLyBMb2FkIGluaXRpYWwgZGF0YVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHZvaWQgbG9hZEluaXRpYWxEYXRhKCk7XG4gIH0sIFtdKTtcblxuICAvLyBSZWxvYWQgd2hlbiBjYXRlZ29yeSBvciBwZXJpb2QgY2hhbmdlc1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChjYXRlZ29yaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHZvaWQgbG9hZExlYWRlcmJvYXJkKCk7XG4gICAgICB2b2lkIGxvYWRVc2VyUmFuaygpO1xuICAgIH1cbiAgfSwgW3NlbGVjdGVkQ2F0ZWdvcnksIHNlbGVjdGVkUGVyaW9kXSk7XG5cbiAgcmV0dXJuIHtcbiAgICAvLyBEYXRhXG4gICAgZW50cmllcyxcbiAgICBjYXRlZ29yaWVzLFxuICAgIHVzZXJSYW5rLFxuICAgIHVzZXJFbnRyeSxcblxuICAgIC8vIFN0YXRlXG4gICAgbG9hZGluZyxcbiAgICByZWZyZXNoaW5nLFxuICAgIHBhZ2UsXG4gICAgaGFzTW9yZSxcbiAgICBzaG93RmlsdGVycyxcblxuICAgIC8vIEZpbHRlcnNcbiAgICBzZWxlY3RlZENhdGVnb3J5LFxuICAgIHNlbGVjdGVkUGVyaW9kLFxuXG4gICAgLy8gQWN0aW9uc1xuICAgIHNldFNlbGVjdGVkQ2F0ZWdvcnksXG4gICAgc2V0U2VsZWN0ZWRQZXJpb2QsXG4gICAgc2V0U2hvd0ZpbHRlcnMsXG4gICAgcmVmcmVzaERhdGEsXG4gICAgbG9hZE1vcmUsXG4gICAgbG9hZEluaXRpYWxEYXRhLFxuICB9O1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUlBLElBQUFBLE1BQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUQsT0FBQTtBQU1BLElBQUFFLG1CQUFBLEdBQUFDLHNCQUFBLENBQUFILE9BQUE7QUErQk8sSUFBTUksY0FBYyxHQUFBQyxPQUFBLENBQUFELGNBQUEsR0FBRyxTQUFqQkEsY0FBY0EsQ0FBQSxFQUErQjtFQUN4RCxJQUFBRSxTQUFBLEdBQThCLElBQUFDLGVBQVEsRUFBcUIsRUFBRSxDQUFDO0lBQUFDLFVBQUEsT0FBQUMsZUFBQSxDQUFBQyxPQUFBLEVBQUFKLFNBQUE7SUFBdkRLLE9BQU8sR0FBQUgsVUFBQTtJQUFFSSxVQUFVLEdBQUFKLFVBQUE7RUFDMUIsSUFBQUssVUFBQSxHQUFvQyxJQUFBTixlQUFRLEVBQXdCLEVBQUUsQ0FBQztJQUFBTyxVQUFBLE9BQUFMLGVBQUEsQ0FBQUMsT0FBQSxFQUFBRyxVQUFBO0lBQWhFRSxVQUFVLEdBQUFELFVBQUE7SUFBRUUsYUFBYSxHQUFBRixVQUFBO0VBQ2hDLElBQUFHLFVBQUEsR0FBZ0QsSUFBQVYsZUFBUSxFQUFTLEtBQUssQ0FBQztJQUFBVyxVQUFBLE9BQUFULGVBQUEsQ0FBQUMsT0FBQSxFQUFBTyxVQUFBO0lBQWhFRSxnQkFBZ0IsR0FBQUQsVUFBQTtJQUFFRSxtQkFBbUIsR0FBQUYsVUFBQTtFQUM1QyxJQUFBRyxVQUFBLEdBQTRDLElBQUFkLGVBQVEsRUFFbEQsUUFBUSxDQUFDO0lBQUFlLFVBQUEsT0FBQWIsZUFBQSxDQUFBQyxPQUFBLEVBQUFXLFVBQUE7SUFGSkUsY0FBYyxH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