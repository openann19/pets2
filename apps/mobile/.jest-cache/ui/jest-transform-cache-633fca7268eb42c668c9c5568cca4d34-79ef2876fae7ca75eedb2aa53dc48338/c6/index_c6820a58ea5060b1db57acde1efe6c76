06d15b966b1067debfb2b0bed2fea974
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports._updatePropsJS = void 0;
Object.defineProperty(exports, "createJSReanimatedModule", {
  enumerable: true,
  get: function get() {
    return _JSReanimated.createJSReanimatedModule;
  }
});
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _errors = require("../../errors");
var _logger = require("../../logger");
var _propsAllowlists = require("../../propsAllowlists");
var _webUtils = require("./webUtils");
var _JSReanimated = require("./JSReanimated");
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
global._makeShareableClone = function () {
  throw new _errors.ReanimatedError('`_makeShareableClone` should never be called from React runtime.');
};
global._scheduleHostFunctionOnJS = function () {
  throw new _errors.ReanimatedError('`_scheduleOnJS` should never be called from React runtime.');
};
global._scheduleOnRuntime = function () {
  throw new _errors.ReanimatedError('`_scheduleOnRuntime` should never be called from React runtime.');
};
var _updatePropsJS = exports._updatePropsJS = function _updatePropsJS(updates, viewRef, isAnimatedProps) {
  if (viewRef) {
    var component = viewRef.getAnimatableRef ? viewRef.getAnimatableRef() : viewRef;
    var _Object$keys$reduce = Object.keys(updates).reduce(function (acc, key) {
        var value = updates[key];
        var index = typeof value === 'function' ? 1 : 0;
        acc[index][key] = value;
        return acc;
      }, [{}, {}]),
      _Object$keys$reduce2 = (0, _slicedToArray2.default)(_Object$keys$reduce, 1),
      rawStyles = _Object$keys$reduce2[0];
    if (typeof component.setNativeProps === 'function') {
      setNativeProps(component, rawStyles, isAnimatedProps);
    } else if (_webUtils.createReactDOMStyle !== undefined && component.style !== undefined) {
      updatePropsDOM(component, rawStyles, isAnimatedProps);
    } else if (Object.keys(component.props).length > 0) {
      Object.keys(component.props).forEach(function (key) {
        if (!rawStyles[key]) {
          return;
        }
        var dashedKey = key.replace(/[A-Z]/g, function (m) {
          return '-' + m.toLowerCase();
        });
        component._touchableNode.setAttribute(dashedKey, rawStyles[key]);
      });
    } else {
      var componentName = 'className' in component ? component == null ? void 0 : component.className : '';
      _logger.logger.warn(`It's not possible to manipulate the component ${componentName}`);
    }
  }
};
var setNativeProps = function setNativeProps(component, newProps, isAnimatedProps) {
  if (isAnimatedProps) {
    var uiProps = {};
    for (var key in newProps) {
      if (isNativeProp(key)) {
        uiProps[key] = newProps[key];
      }
    }
    component.setNativeProps == null ? void 0 : component.setNativeProps(uiProps);
  }
  var previousStyle = component.previousStyle ? component.previousStyle : {};
  var currentStyle = _objectSpread(_objectSpread({}, previousStyle), newProps);
  component.previousStyle = currentStyle;
  component.setNativeProps == null ? void 0 : component.setNativeProps({
    style: currentStyle
  });
};
var updatePropsDOM = function updatePropsDOM(component, style, isAnimatedProps) {
  var previousStyle = component.previousStyle ? component.previousStyle : {};
  var currentStyle = _objectSpread(_objectSpread({}, previousStyle), style);
  component.previousStyle = currentStyle;
  var domStyle = (0, _webUtils.createReactDOMStyle)(currentStyle);
  if (Array.isArray(domStyle.transform) && _webUtils.createTransformValue !== undefined) {
    domStyle.transform = (0, _webUtils.createTransformValue)(domStyle.transform);
  }
  if (_webUtils.createTextShadowValue !== undefined && (domStyle.textShadowColor || domStyle.textShadowRadius || domStyle.textShadowOffset)) {
    domStyle.textShadow = (0, _webUtils.createTextShadowValue)({
      textShadowColor: domStyle.textShadowColor,
      textShadowOffset: domStyle.textShadowOffset,
      textShadowRadius: domStyle.textShadowRadius
    });
  }
  for (var key in domStyle) {
    if (isAnimatedProps) {
      if (component.nodeName === 'INPUT' && key === 'text') {
        component.value = domStyle[key];
      } else {
        component.setAttribute(key, domStyle[key]);
      }
    } else {
      component.style[key] = domStyle[key];
    }
  }
};
function isNativeProp(propName) {
  return !!_propsAllowlists.PropsAllowlists.NATIVE_THREAD_PROPS_WHITELIST[propName];
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiX3VwZGF0ZVByb3BzSlMiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiX0pTUmVhbmltYXRlZCIsImNyZWF0ZUpTUmVhbmltYXRlZE1vZHVsZSIsIl9kZWZpbmVQcm9wZXJ0eTIiLCJfc2xpY2VkVG9BcnJheTIiLCJfZXJyb3JzIiwiX2xvZ2dlciIsIl9wcm9wc0FsbG93bGlzdHMiLCJfd2ViVXRpbHMiLCJvd25LZXlzIiwiZSIsInIiLCJ0Iiwia2V5cyIsImdldE93blByb3BlcnR5U3ltYm9scyIsIm8iLCJmaWx0ZXIiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJwdXNoIiwiYXBwbHkiLCJfb2JqZWN0U3ByZWFkIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiZm9yRWFjaCIsImRlZmF1bHQiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZGVmaW5lUHJvcGVydGllcyIsImdsb2JhbCIsIl9tYWtlU2hhcmVhYmxlQ2xvbmUiLCJSZWFuaW1hdGVkRXJyb3IiLCJfc2NoZWR1bGVIb3N0RnVuY3Rpb25PbkpTIiwiX3NjaGVkdWxlT25SdW50aW1lIiwidXBkYXRlcyIsInZpZXdSZWYiLCJpc0FuaW1hdGVkUHJvcHMiLCJjb21wb25lbnQiLCJnZXRBbmltYXRhYmxlUmVmIiwiX09iamVjdCRrZXlzJHJlZHVjZSIsInJlZHVjZSIsImFjYyIsImtleSIsImluZGV4IiwiX09iamVjdCRrZXlzJHJlZHVjZTIiLCJyYXdTdHlsZXMiLCJzZXROYXRpdmVQcm9wcyIsImNyZWF0ZVJlYWN0RE9NU3R5bGUiLCJ1bmRlZmluZWQiLCJzdHlsZSIsInVwZGF0ZVByb3BzRE9NIiwicHJvcHMiLCJkYXNoZWRLZXkiLCJyZXBsYWNlIiwibSIsInRvTG93ZXJDYXNlIiwiX3RvdWNoYWJsZU5vZGUiLCJzZXRBdHRyaWJ1dGUiLCJjb21wb25lbnROYW1lIiwiY2xhc3NOYW1lIiwibG9nZ2VyIiwid2FybiIsIm5ld1Byb3BzIiwidWlQcm9wcyIsImlzTmF0aXZlUHJvcCIsInByZXZpb3VzU3R5bGUiLCJjdXJyZW50U3R5bGUiLCJkb21TdHlsZSIsIkFycmF5IiwiaXNBcnJheSIsInRyYW5zZm9ybSIsImNyZWF0ZVRyYW5zZm9ybVZhbHVlIiwiY3JlYXRlVGV4dFNoYWRvd1ZhbHVlIiwidGV4dFNoYWRvd0NvbG9yIiwidGV4dFNoYWRvd1JhZGl1cyIsInRleHRTaGFkb3dPZmZzZXQiLCJ0ZXh0U2hhZG93Iiwibm9kZU5hbWUiLCJwcm9wTmFtZSIsIlByb3BzQWxsb3dsaXN0cyIsIk5BVElWRV9USFJFQURfUFJPUFNfV0hJVEVMSVNUIl0sInNvdXJjZXMiOlsiaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuaW1wb3J0IHR5cGUgeyBBbmltYXRlZFN0eWxlLCBTdHlsZVByb3BzIH0gZnJvbSAnLi4vLi4vY29tbW9uVHlwZXMnO1xuaW1wb3J0IHsgUmVhbmltYXRlZEVycm9yIH0gZnJvbSAnLi4vLi4vZXJyb3JzJztcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJy4uLy4uL2xvZ2dlcic7XG5pbXBvcnQgeyBQcm9wc0FsbG93bGlzdHMgfSBmcm9tICcuLi8uLi9wcm9wc0FsbG93bGlzdHMnO1xuaW1wb3J0IHtcbiAgY3JlYXRlUmVhY3RET01TdHlsZSxcbiAgY3JlYXRlVGV4dFNoYWRvd1ZhbHVlLFxuICBjcmVhdGVUcmFuc2Zvcm1WYWx1ZSxcbn0gZnJvbSAnLi93ZWJVdGlscyc7XG5cbmV4cG9ydCB7IGNyZWF0ZUpTUmVhbmltYXRlZE1vZHVsZSB9IGZyb20gJy4vSlNSZWFuaW1hdGVkJztcblxuLy8gVE9ETzogSW5zdGFsbCB0aGVzZSBnbG9iYWwgZnVuY3Rpb25zIGluIGEgbW9yZSBzdWl0YWJsZSBsb2NhdGlvbi5cbmdsb2JhbC5fbWFrZVNoYXJlYWJsZUNsb25lID0gKCkgPT4ge1xuICB0aHJvdyBuZXcgUmVhbmltYXRlZEVycm9yKFxuICAgICdgX21ha2VTaGFyZWFibGVDbG9uZWAgc2hvdWxkIG5ldmVyIGJlIGNhbGxlZCBmcm9tIFJlYWN0IHJ1bnRpbWUuJ1xuICApO1xufTtcblxuZ2xvYmFsLl9zY2hlZHVsZUhvc3RGdW5jdGlvbk9uSlMgPSAoKSA9PiB7XG4gIHRocm93IG5ldyBSZWFuaW1hdGVkRXJyb3IoXG4gICAgJ2Bfc2NoZWR1bGVPbkpTYCBzaG91bGQgbmV2ZXIgYmUgY2FsbGVkIGZyb20gUmVhY3QgcnVudGltZS4nXG4gICk7XG59O1xuXG5nbG9iYWwuX3NjaGVkdWxlT25SdW50aW1lID0gKCkgPT4ge1xuICB0aHJvdyBuZXcgUmVhbmltYXRlZEVycm9yKFxuICAgICdgX3NjaGVkdWxlT25SdW50aW1lYCBzaG91bGQgbmV2ZXIgYmUgY2FsbGVkIGZyb20gUmVhY3QgcnVudGltZS4nXG4gICk7XG59O1xuXG5pbnRlcmZhY2UgSlNSZWFuaW1hdGVkQ29tcG9uZW50IHtcbiAgcHJldmlvdXNTdHlsZTogU3R5bGVQcm9wcztcbiAgc2V0TmF0aXZlUHJvcHM/OiAoc3R5bGU6IFN0eWxlUHJvcHMpID0+IHZvaWQ7XG4gIHN0eWxlPzogU3R5bGVQcm9wcztcbiAgcHJvcHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IG51bWJlcj47XG4gIF90b3VjaGFibGVOb2RlOiB7XG4gICAgc2V0QXR0cmlidXRlOiAoa2V5OiBzdHJpbmcsIHByb3BzOiB1bmtub3duKSA9PiB2b2lkO1xuICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlYW5pbWF0ZWRIVE1MRWxlbWVudCBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgcHJldmlvdXNTdHlsZTogU3R5bGVQcm9wcztcbiAgc2V0TmF0aXZlUHJvcHM/OiAoc3R5bGU6IFN0eWxlUHJvcHMpID0+IHZvaWQ7XG4gIHByb3BzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBudW1iZXI+O1xuICBfdG91Y2hhYmxlTm9kZToge1xuICAgIHNldEF0dHJpYnV0ZTogKGtleTogc3RyaW5nLCBwcm9wczogdW5rbm93bikgPT4gdm9pZDtcbiAgfTtcbiAgcmVhbmltYXRlZER1bW15PzogYm9vbGVhbjtcbiAgcmVtb3ZlZEFmdGVyQW5pbWF0aW9uPzogYm9vbGVhbjtcbn1cblxuLy8gVE9ETzogTW92ZSB0aGVzZSBmdW5jdGlvbnMgb3V0c2lkZSBvZiBpbmRleCBmaWxlLlxuZXhwb3J0IGNvbnN0IF91cGRhdGVQcm9wc0pTID0gKFxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXJlZHVuZGFudC10eXBlLWNvbnN0aXR1ZW50c1xuICB1cGRhdGVzOiBTdHlsZVByb3BzIHwgQW5pbWF0ZWRTdHlsZTxhbnk+LFxuICB2aWV3UmVmOiAoSlNSZWFuaW1hdGVkQ29tcG9uZW50IHwgUmVhbmltYXRlZEhUTUxFbGVtZW50KSAmIHtcbiAgICBnZXRBbmltYXRhYmxlUmVmPzogKCkgPT4gSlNSZWFuaW1hdGVkQ29tcG9uZW50IHwgUmVhbmltYXRlZEhUTUxFbGVtZW50O1xuICB9LFxuICBpc0FuaW1hdGVkUHJvcHM/OiBib29sZWFuXG4pOiB2b2lkID0+IHtcbiAgaWYgKHZpZXdSZWYpIHtcbiAgICBjb25zdCBjb21wb25lbnQgPSB2aWV3UmVmLmdldEFuaW1hdGFibGVSZWZcbiAgICAgID8gdmlld1JlZi5nZXRBbmltYXRhYmxlUmVmKClcbiAgICAgIDogdmlld1JlZjtcbiAgICBjb25zdCBbcmF3U3R5bGVzXSA9IE9iamVjdC5rZXlzKHVwZGF0ZXMpLnJlZHVjZShcbiAgICAgIChhY2M6IFtTdHlsZVByb3BzLCBBbmltYXRlZFN0eWxlPGFueT5dLCBrZXkpID0+IHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB1cGRhdGVzW2tleV07XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nID8gMSA6IDA7XG4gICAgICAgIGFjY1tpbmRleF1ba2V5XSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfSxcbiAgICAgIFt7fSwge31dXG4gICAgKTtcblxuICAgIGlmICh0eXBlb2YgY29tcG9uZW50LnNldE5hdGl2ZVByb3BzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAvLyBUaGlzIGlzIHRoZSBsZWdhY3kgd2F5IHRvIHVwZGF0ZSBwcm9wcyBvbiBSZWFjdCBOYXRpdmUgV2ViIDw9IDAuMTguXG4gICAgICAvLyBBbHNvLCBzb21lIGNvbXBvbmVudHMgKGUuZy4gZnJvbSByZWFjdC1uYXRpdmUtc3ZnKSBkb24ndCBoYXZlIHN0eWxlc1xuICAgICAgLy8gYW5kIGFsd2F5cyBwcm92aWRlIHNldE5hdGl2ZVByb3BzIGZ1bmN0aW9uIGluc3RlYWQgKGV2ZW4gb24gUmVhY3QgTmF0aXZlIFdlYiAwLjE5KykuXG4gICAgICBzZXROYXRpdmVQcm9wcyhjb21wb25lbnQsIHJhd1N0eWxlcywgaXNBbmltYXRlZFByb3BzKTtcbiAgICB9IGVsc2UgaWYgKFxuICAgICAgY3JlYXRlUmVhY3RET01TdHlsZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICBjb21wb25lbnQuc3R5bGUgIT09IHVuZGVmaW5lZFxuICAgICkge1xuICAgICAgLy8gUmVhY3QgTmF0aXZlIFdlYiAwLjE5KyBubyBsb25nZXIgcHJvdmlkZXMgc2V0TmF0aXZlUHJvcHMgZnVuY3Rpb24sXG4gICAgICAvLyBzbyB3ZSBuZWVkIHRvIHVwZGF0ZSBET00gbm9kZXMgZGlyZWN0bHkuXG4gICAgICB1cGRhdGVQcm9wc0RPTShjb21wb25lbnQsIHJhd1N0eWxlcywgaXNBbmltYXRlZFByb3BzKTtcbiAgICB9IGVsc2UgaWYgKE9iamVjdC5rZXlzKGNvbXBvbmVudC5wcm9wcykubGVuZ3RoID4gMCkge1xuICAgICAgT2JqZWN0LmtleXMoY29tcG9uZW50LnByb3BzKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgaWYgKCFyYXdTdHlsZXNba2V5XSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkYXNoZWRLZXkgPSBrZXkucmVwbGFjZSgvW0EtWl0vZywgKG0pID0+ICctJyArIG0udG9Mb3dlckNhc2UoKSk7XG4gICAgICAgIGNvbXBvbmVudC5fdG91Y2hhYmxlTm9kZS5zZXRBdHRyaWJ1dGUoZGFzaGVkS2V5LCByYXdTdHlsZXNba2V5XSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgY29tcG9uZW50TmFtZSA9XG4gICAgICAgICdjbGFzc05hbWUnIGluIGNvbXBvbmVudCA/IGNvbXBvbmVudD8uY2xhc3NOYW1lIDogJyc7XG4gICAgICBsb2dnZXIud2FybihcbiAgICAgICAgYEl0J3Mgbm90IHBvc3NpYmxlIHRvIG1hbmlwdWxhdGUgdGhlIGNvbXBvbmVudCAke2NvbXBvbmVudE5hbWV9YFxuICAgICAgKTtcbiAgICB9XG4gIH1cbn07XG5cbmNvbnN0IHNldE5hdGl2ZVByb3BzID0gKFxuICBjb21wb25lbnQ6IEpTUmVhbmltYXRlZENvbXBvbmVudCB8IFJlYW5pbWF0ZWRIVE1MRWxlbWVudCxcbiAgbmV3UHJvcHM6IFN0eWxlUHJvcHMsXG4gIGlzQW5pbWF0ZWRQcm9wcz86IGJvb2xlYW5cbik6IHZvaWQgPT4ge1xuICBpZiAoaXNBbmltYXRlZFByb3BzKSB7XG4gICAgY29uc3QgdWlQcm9wczogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBuZXdQcm9wcykge1xuICAgICAgaWYgKGlzTmF0aXZlUHJvcChrZXkpKSB7XG4gICAgICAgIHVpUHJvcHNba2V5XSA9IG5ld1Byb3BzW2tleV07XG4gICAgICB9XG4gICAgfVxuICAgIC8vIE9ubHkgdXBkYXRlIFVJIHByb3BzIGRpcmVjdGx5IG9uIHRoZSBjb21wb25lbnQsXG4gICAgLy8gb3RoZXIgcHJvcHMgY2FuIGJlIHVwZGF0ZWQgYXMgc3RhbmRhcmQgc3R5bGUgcHJvcHMuXG4gICAgY29tcG9uZW50LnNldE5hdGl2ZVByb3BzPy4odWlQcm9wcyk7XG4gIH1cblxuICBjb25zdCBwcmV2aW91c1N0eWxlID0gY29tcG9uZW50LnByZXZpb3VzU3R5bGUgPyBjb21wb25lbnQucHJldmlvdXNTdHlsZSA6IHt9O1xuICBjb25zdCBjdXJyZW50U3R5bGUgPSB7IC4uLnByZXZpb3VzU3R5bGUsIC4uLm5ld1Byb3BzIH07XG4gIGNvbXBvbmVudC5wcmV2aW91c1N0eWxlID0gY3VycmVudFN0eWxlO1xuXG4gIGNvbXBvbmVudC5zZXROYXRpdmVQcm9wcz8uKHsgc3R5bGU6IGN1cnJlbnRTdHlsZSB9KTtcbn07XG5cbmNvbnN0IHVwZGF0ZVByb3BzRE9NID0gKFxuICBjb21wb25lbnQ6IEpTUmVhbmltYXRlZENvbXBvbmVudCB8IEhUTUxFbGVtZW50LFxuICBzdHlsZTogU3R5bGVQcm9wcyxcbiAgaXNBbmltYXRlZFByb3BzPzogYm9vbGVhblxuKTogdm9pZCA9PiB7XG4gIGNvbnN0IHByZXZpb3VzU3R5bGUgPSAoY29tcG9uZW50IGFzIEpTUmVhbmltYXRlZENvbXBvbmVudCkucHJldmlvdXNTdHlsZVxuICAgID8gKGNvbXBvbmVudCBhcyBKU1JlYW5pbWF0ZWRDb21wb25lbnQpLnByZXZpb3VzU3R5bGVcbiAgICA6IHt9O1xuICBjb25zdCBjdXJyZW50U3R5bGUgPSB7IC4uLnByZXZpb3VzU3R5bGUsIC4uLnN0eWxlIH07XG4gIChjb21wb25lbnQgYXMgSlNSZWFuaW1hdGVkQ29tcG9uZW50KS5wcmV2aW91c1N0eWxlID0gY3VycmVudFN0eWxlO1xuXG4gIGNvbnN0IGRvbVN0eWxlID0gY3JlYXRlUmVhY3RET01TdHlsZShjdXJyZW50U3R5bGUpO1xuICBpZiAoQXJyYXkuaXNBcnJheShkb21TdHlsZS50cmFuc2Zvcm0pICYmIGNyZWF0ZVRyYW5zZm9ybVZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICBkb21TdHlsZS50cmFuc2Zvcm0gPSBjcmVhdGVUcmFuc2Zvcm1WYWx1ZShkb21TdHlsZS50cmFuc2Zvcm0pO1xuICB9XG5cbiAgaWYgKFxuICAgIGNyZWF0ZVRleHRTaGFkb3dWYWx1ZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgKGRvbVN0eWxlLnRleHRTaGFkb3dDb2xvciB8fFxuICAgICAgZG9tU3R5bGUudGV4dFNoYWRvd1JhZGl1cyB8fFxuICAgICAgZG9tU3R5bGUudGV4dFNoYWRvd09mZnNldClcbiAgKSB7XG4gICAgZG9tU3R5bGUudGV4dFNoYWRvdyA9IGNyZWF0ZVRleHRTaGFkb3dWYWx1ZSh7XG4gICAgICB0ZXh0U2hhZG93Q29sb3I6IGRvbVN0eWxlLnRleHRTaGFkb3dDb2xvcixcbiAgICAgIHRleHRTaGFkb3dPZmZzZXQ6IGRvbVN0eWxlLnRleHRTaGFkb3dPZmZzZXQsXG4gICAgICB0ZXh0U2hhZG93UmFkaXVzOiBkb21TdHlsZS50ZXh0U2hhZG93UmFkaXVzLFxuICAgIH0pO1xuICB9XG5cbiAgZm9yIChjb25zdCBrZXkgaW4gZG9tU3R5bGUpIHtcbiAgICBpZiAoaXNBbmltYXRlZFByb3BzKSB7XG4gICAgICAvLyBXZSBuZWVkIHRvIGV4cGxpY2l0bHkgc2V0IHRoZSAndGV4dCcgcHJvcGVydHkgb24gaW5wdXQgY29tcG9uZW50IGJlY2F1c2UgUmVhY3QgTmF0aXZlJ3NcbiAgICAgIC8vIGludGVybmFsIF92YWx1ZVRyYWNrZXIgKGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC9ibG9iL21haW4vcGFja2FnZXMvcmVhY3QtZG9tLWJpbmRpbmdzL3NyYy9jbGllbnQvaW5wdXRWYWx1ZVRyYWNraW5nLmpzKVxuICAgICAgLy8gcHJldmVudHMgdXBkYXRlcyB3aGVuIG9ubHkgbW9kaWZ5aW5nIGF0dHJpYnV0ZXMuXG4gICAgICBpZiAoKGNvbXBvbmVudCBhcyBIVE1MRWxlbWVudCkubm9kZU5hbWUgPT09ICdJTlBVVCcgJiYga2V5ID09PSAndGV4dCcpIHtcbiAgICAgICAgKGNvbXBvbmVudCBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZSA9IGRvbVN0eWxlW2tleV0gYXMgc3RyaW5nO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgKGNvbXBvbmVudCBhcyBIVE1MRWxlbWVudCkuc2V0QXR0cmlidXRlKGtleSwgZG9tU3R5bGVba2V5XSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIChjb21wb25lbnQuc3R5bGUgYXMgU3R5bGVQcm9wcylba2V5XSA9IGRvbVN0eWxlW2tleV07XG4gICAgfVxuICB9XG59O1xuXG5mdW5jdGlvbiBpc05hdGl2ZVByb3AocHJvcE5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICByZXR1cm4gISFQcm9wc0FsbG93bGlzdHMuTkFUSVZFX1RIUkVBRF9QUk9QU19XSElURUxJU1RbcHJvcE5hbWVdO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUFDLElBQUFBLHNCQUFBLEdBQUFDLE9BQUE7QUFBQUMsTUFBQSxDQUFBQyxjQUFBLENBQUFDLE9BQUE7RUFBQUMsS0FBQTtBQUFBO0FBQUFELE9BQUEsQ0FBQUUsY0FBQTtBQUFBSixNQUFBLENBQUFDLGNBQUEsQ0FBQUMsT0FBQTtFQUFBRyxVQUFBO0VBQUFDLEdBQUEsV0FBQUEsSUFBQTtJQUFBLE9BQUFDLGFBQUEsQ0FBQUMsd0JBQUE7RUFBQTtBQUFBO0FBQUEsSUFBQUMsZ0JBQUEsR0FBQVgsc0JBQUEsQ0FBQUMsT0FBQTtBQUFBLElBQUFXLGVBQUEsR0FBQVosc0JBQUEsQ0FBQUMsT0FBQTtBQUViLElBQUFZLE9BQUEsR0FBQVosT0FBQTtBQUNBLElBQUFhLE9BQUEsR0FBQWIsT0FBQTtBQUNBLElBQUFjLGdCQUFBLEdBQUFkLE9BQUE7QUFDQSxJQUFBZSxTQUFBLEdBQUFmLE9BQUE7QUFNQSxJQUFBUSxhQUFBLEdBQUFSLE9BQUE7QUFBMEQsU0FBQWdCLFFBQUFDLENBQUEsRUFBQUMsQ0FBQSxRQUFBQyxDQUFBLEdBQUFsQixNQUFBLENBQUFtQixJQUFBLENBQUFILENBQUEsT0FBQWhCLE1BQUEsQ0FBQW9CLHFCQUFBLFFBQUFDLENBQUEsR0FBQXJCLE1BQUEsQ0FBQW9CLHFCQUFBLENBQUFKLENBQUEsR0FBQUMsQ0FBQSxLQUFBSSxDQUFBLEdBQUFBLENBQUEs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