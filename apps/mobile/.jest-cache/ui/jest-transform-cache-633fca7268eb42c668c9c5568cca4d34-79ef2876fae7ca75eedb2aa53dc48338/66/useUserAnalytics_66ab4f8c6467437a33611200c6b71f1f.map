{"version":3,"names":["_interopRequireDefault","require","_asyncToGenerator2","_slicedToArray2","Object","defineProperty","exports","value","useUserAnalytics","react_1","logger_1","env_1","options","arguments","length","undefined","userId","_options$autoRefresh","autoRefresh","_options$refreshInter","refreshInterval","_ref","useState","_ref2","default","analytics","setAnalytics","_ref3","_ref4","isLoading","setIsLoading","_ref5","_ref6","error","setError","fetchAnalytics","useCallback","_ref8","response","fetch","headers","getLocalStorageItem","ok","Error","statusText","data","json","success","message","err","errorMessage","logger","useEffect","interval","setInterval","clearInterval","refresh"],"sources":["useUserAnalytics.js"],"sourcesContent":["\"use strict\";\n/**\n * User Analytics Hook\n * Tracks user behavior and provides analytics data\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useUserAnalytics = useUserAnalytics;\nconst react_1 = require(\"react\");\nconst logger_1 = require(\"../utils/logger\");\nconst env_1 = require(\"../utils/env\");\n/**\n * Hook to fetch and track user analytics\n */\nfunction useUserAnalytics(options = {}) {\n    const { userId, autoRefresh = false, refreshInterval = 60000 } = options;\n    const [analytics, setAnalytics] = (0, react_1.useState)(null);\n    const [isLoading, setIsLoading] = (0, react_1.useState)(true);\n    const [error, setError] = (0, react_1.useState)(null);\n    const fetchAnalytics = (0, react_1.useCallback)(async () => {\n        if (!userId) {\n            setIsLoading(false);\n            return;\n        }\n        try {\n            setIsLoading(true);\n            setError(null);\n            const response = await fetch(`/api/analytics/user/${userId}`, {\n                headers: {\n                    'Authorization': `Bearer ${(0, env_1.getLocalStorageItem)('accessToken') ?? ''}`,\n                },\n            });\n            if (!response.ok) {\n                throw new Error(`Failed to fetch analytics: ${response.statusText}`);\n            }\n            const data = await response.json();\n            if (data.success) {\n                setAnalytics(data.data);\n            }\n            else {\n                throw new Error(data.message || 'Failed to fetch analytics');\n            }\n        }\n        catch (err) {\n            const errorMessage = err instanceof Error ? err.message : 'Unknown error';\n            setError(errorMessage);\n            logger_1.logger.error('Failed to fetch user analytics', { error: errorMessage, userId });\n        }\n        finally {\n            setIsLoading(false);\n        }\n    }, [userId]);\n    // Initial fetch\n    (0, react_1.useEffect)(() => {\n        void fetchAnalytics();\n    }, [fetchAnalytics]);\n    // Auto-refresh\n    (0, react_1.useEffect)(() => {\n        if (!autoRefresh || !userId)\n            return;\n        const interval = setInterval(() => {\n            void fetchAnalytics();\n        }, refreshInterval);\n        return () => clearInterval(interval);\n    }, [autoRefresh, refreshInterval, userId, fetchAnalytics]);\n    return {\n        analytics,\n        isLoading,\n        error,\n        refresh: fetchAnalytics,\n    };\n}\n"],"mappings":"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","ignoreList":[]}