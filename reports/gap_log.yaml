version: 1.0.0
generated: 2025-01-30T00:00:00Z
app: PawfectMatch Premium Mobile
status: active

gaps:
  - id: gdpr-delete-account
    owner: api
    severity: critical
    area: backend+mobile
    status: needs-implementation
    context: |
      GDPR requires user data deletion capability with grace period.
      Current state: API endpoint exists but lacks proper grace period handling.
      Missing: 30-day grace period, cancellation window, user data export.
    acceptance:
      - DELETE /users/delete-account endpoint with 30-day grace period
      - POST /users/confirm-deletion confirmation endpoint
      - GET /users/export-data export endpoint
      - Client service methods in mobile app
      - Detox E2E test covering full flow
    states:
      - loading
      - confirm
      - grace-period
      - error
    telemetry:
      - event: GDPR_DELETE_REQUESTED
        props: [reason, userId]
      - event: GDPR_DELETE_CONFIRMED
        props: [userId, deletionDate]
      - event: GDPR_DATA_EXPORTED
        props: [userId, format]
    contracts:
      request:
        delete: { password: string, reason?: string, feedback?: string }
        confirm: { token: string }
        export: {}
      response:
        delete: { success: boolean, message: string, gracePeriodEndsAt: string, requestId: string }
        confirm: { success: boolean }
        export: { url: string, expiresAt: string }
      errors:
        - INVALID_PASSWORD
        - GRACE_PERIOD_EXPIRED
        - TOKEN_INVALID
        - EXPORT_FAILED
    assets:
      mocks: [mocks/fixtures/gdpr/delete.success.json, mocks/fixtures/gdpr/export.success.json]
      tests: [apps/mobile/src/screens/__tests__/DeactivateAccount.int.test.tsx]
    risks:
      - Accidental deletion without proper confirmation
      - Grace period not enforced on backend
      - Data export may contain incomplete data
    rollback:
      - Disable UI entry points via feature flag
      - Revert service changes
    links:
      - PR: #TODO
      - docs: reports/gdpr_checklist.md

  - id: chat-reactions-attachments
    owner: api
    severity: high
    area: mobile+backend
    status: needs-implementation
    context: |
      Modern chat requires reactions, attachments, and voice notes.
      Current state: Basic text messaging exists.
      Missing: Message reactions, file attachments, voice notes, link previews.
    acceptance:
      - sendReaction, sendAttachment, voiceNote service methods
      - UI: long-press reaction bar, attachment picker, waveform for voice
      - Backend endpoints for media upload
      - Tests: unit for reducers, integration for ChatScreen, Detox E2E
    states:
      - loading
      - success
      - error
    telemetry:
      - event: CHAT_REACTION_SENT
        props: [messageId, reactionType]
      - event: CHAT_ATTACHMENT_SENT
        props: [messageId, attachmentType, fileSize]
      - event: CHAT_VOICE_SENT
        props: [messageId, duration]
    contracts:
      request:
        reaction: { messageId: string, reactionType: string }
        attachment: { conversationId: string, file: File, type: string }
        voice: { conversationId: string, audioUri: string, duration: number }
      response:
        reaction: { success: boolean, updatedMessage: Message }
        attachment: { success: boolean, messageId: string, url: string }
        voice: { success: boolean, messageId: string, url: string }
    assets:
      mocks: [mocks/fixtures/chat/reactions.json, mocks/fixtures/chat/attachments.json]
      tests: [apps/mobile/src/components/chat/__tests__/, e2e/chat-reactions.e2e.ts]
    risks:
      - Large file uploads may fail
      - Voice note quality issues
      - Storage costs
    rollback:
      - Feature flag to disable new features
      - Revert to text-only messaging

  - id: swipe-undo-implementation
    owner: ux
    severity: medium
    area: mobile
    status: partially-implemented
    context: |
      Premium feature to undo last swipe action.
      Current: UndoPill exists but needs state management fixes.
      Missing: Proper state restoration, conflict handling.
    acceptance:
      - Undo button visible for 5 seconds after swipe
      - Restores card position and stack state
      - Handles multiple undo attempts gracefully
      - Premium-only feature gate
    states:
      - idple
      - available
      - restoring
      - expired
    assets:
      tests: [apps/mobile/src/hooks/useSwipeUndo.test.ts]
    risks:
      - State corruption on rapid undo
      - Multiple undo enabling cheating

  - id: ai-bio-quality-improvements
    owner: ai
    severity: medium
    area: ai-service+mobile
    status: needs-optimization
    context: |
      AI bio generation needs better context awareness and quality control.
      Current: Basic bio generation exists.
      Missing: Better prompts, personality matching, quality scoring.
    acceptance:
      - Generate more contextual bios
      - Personality-based bio generation
      - Quality scoring for generated bios
      - A/B test different AI prompts
    states:
      - analyzing
      - generating
      - scoring
      - complete
    telemetry:
      - event: AI_BIO_GENERATED
        props: [petId, qualityScore, length]
      - event: AI_BIO_EDITED
        props: [petId, edits]

  - id: premium-subscription-management
    owner: api
    severity: high
    area: backend+mobile
    status: needs-enhancement
    context: |
      Premium subscription flow needs better error handling and state management.
      Current: Basic RevenueCat integration.
      Missing: Grace period handling, trial management, webhook handling.
    acceptance:
      - Proper trial period handling
      - Grace period for expired subscriptions
      - Webhook endpoint for payment events
      - Subscription status caching
    states:
      - free
      - trial
      - active
      - grace-period
      - expired
      - cancelled
    telemetry:
      - event: PREMIUM_SUBSCRIBED
        props: [tier, price, trialDays]
      - event: PREMIUM_EXPIRED
        props: [tier, expiredAt]
      - event: PREMIUM_CANCELLED
        props: [tier, reason]
    assets:
      tests: [apps/mobile/src/screens/premium/__tests__/]
    risks:
      - Payment processing failures
      - Subscription state inconsistencies
      - RevenueCat webhook delays

  - id: accessibility-compliance
    owner: a11y
    severity: high
    area: mobile
    status: needs-improvement
    context: |
      App needs comprehensive accessibility compliance.
      Current: Basic screen reader support exists.
      Missing: Proper ARIA labels, contrast checks, reduce motion support, keyboard navigation.
    acceptance:
      - All interactive elements have proper accessibility labels
      - WCAG AA contrast ratios met
      - Reduce motion preferences respected
      - Keyboard navigation support
      - Screen reader testing complete
    states:
      - audit-required
      - fixing
      - compliant
      - non-compliant
    assets:
      tests: [apps/mobile/src/__tests__/a11y/]
    risks:
      - Legal compliance issues
      - App store rejection
      - User accessibility lawsuits

  - id: performance-optimization
    owner: pp
    severity: medium
    area: mobile
    status: ongoing
    context: |
      App performance needs optimization for 60fps interactions.
      Current: Basic performance monitoring.
      Missing: Bundle size reduction, image optimization, lazy loading improvements.
    acceptance:
      - 60fps swipe interactions
      - Bundle size < 50MB
      - Image lazy loading implemented
      - Code splitting for large screens
    states:
      - measuring
      - optimizing
      - validated
    metrics:
      - fps: 60
      - bundleSize: "< 50MB"
      - loadTime: "< 3s"
    assets:
      reports: [reports/perf_budget.json]

  - id: e2e-test-coverage
    owner: e2e
    severity: high
    area: mobile
    status: needs-implementation
    context: |
      Comprehensive E2E test suite for golden paths.
      Current: Some basic tests exist.
      Missing: Auth, Swipe→Match, Chat, Settings/GDPR, Premium flows.
    acceptance:
      - Auth flow (Login, Register, Password Reset)
      - Swipe → Match flow
      - Chat flow with real-time updates
      - Settings and GDPR flows
      - Premium subscription flow
    states:
      - not-tested
      - in-development
      - passing
      - failing
    assets:
      e2e-tests:
        - e2e/auth.e2e.ts
        - e2e/swipe-match.e2e.ts
        - e2e/chat.e2e.ts
        - e2e/settings-gdpr.e2e.ts
        - e2e/premium.e2e.ts
    risks:
      - Test flakiness
      - CI timeouts
      - Device compatibility issues

  - id: security-vulnerabilities
    owner: sp
    severity: critical
    area: backend+mobile
    status: needs-audit
    context: |
      Regular security scanning needed for vulnerabilities.
      Current: Basic security measures in place.
      Missing: Automated vulnerability scanning, dependency updates, SSL pinning.
    acceptance:
      - No high/critical vulnerabilities
      - Dependencies updated monthly
      - SSL pinning implemented
      - Secrets not hardcoded
      - API rate limiting enforced
    states:
      - audit-required
      - scanning
      - vulnerable
      - secure
    assets:
      reports: [reports/security_scan.md]
    risks:
      - Data breaches
      - Unauthorized access
      - Compliance violations

  - id: i18n-completeness
    owner: i18n
    severity: medium
    area: mobile
    status: needs-verification
    context: |
      Internationalization needs verification for all locales.
      Current: Multiple locales exist.
      Missing: String extraction verification, missing key detection, RTL support validation.
    acceptance:
      - All hardcoded strings extracted to locales
      - 20+ languages fully translated
      - RTL support for Arabic, Hebrew
      - No missing translation keys
    states:
      - incomplete
      - translating
      - verified
    assets:
      reports: [reports/i18n_diff.json]
    risks:
      - Poor UX for international users
      - Missing translations breaking app

severity_distribution:
  critical: 3
  high: 5
  medium: 3
  low: 0

next_actions:
  - priority: critical
    gap_ids: [gdpr-delete-account, security-vulnerabilities]
    assignee: api+sp
    deadline: 2025-02-15
  - priority: high
    gap_ids: [chat-reactions-attachments, premium-subscription-management, e2e-test-coverage, accessibility-compliance]
    assignee: api+te+a11y
    deadline: 2025-03-01
  - priority: medium
    gap_ids: [swipe-undo-implementation, ai-bio-quality-improvements, performance-optimization, i18n-completeness]
    assignee: ux+ai+pp+i18n
    deadline: 2025-03-15